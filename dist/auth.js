parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Wugr":[function(require,module,exports) {
var r=require("buffer"),e=r.Buffer;function o(r,e){for(var o in r)e[o]=r[o]}function n(r,o,n){return e(r,o,n)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?module.exports=r:(o(r,exports),exports.Buffer=n),n.prototype=Object.create(e.prototype),o(e,n),n.from=function(r,o,n){if("number"==typeof r)throw new TypeError("Argument must not be a number");return e(r,o,n)},n.alloc=function(r,o,n){if("number"!=typeof r)throw new TypeError("Argument must be a number");var t=e(r);return void 0!==o?"string"==typeof n?t.fill(o,n):t.fill(o):t.fill(0),t},n.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return e(r)},n.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)};
},{}],"VO8B":[function(require,module,exports) {
var t=require("safe-buffer").Buffer,e=require("stream"),i=require("util");function r(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=t.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=t.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}i.inherits(r,e),r.prototype.write=function(e){this.buffer=t.concat([this.buffer,t.from(e)]),this.emit("data",e)},r.prototype.end=function(t){t&&this.write(t),this.emit("end",t),this.emit("close"),this.writable=!1,this.readable=!1},module.exports=r;
},{"safe-buffer":"Wugr"}],"nhWN":[function(require,module,exports) {
"use strict";var e=require("buffer").Buffer,r=require("buffer").SlowBuffer;function t(r,t){if(!e.isBuffer(r)||!e.isBuffer(t))return!1;if(r.length!==t.length)return!1;for(var u=0,o=0;o<r.length;o++)u|=r[o]^t[o];return 0===u}module.exports=t,t.install=function(){e.prototype.equal=r.prototype.equal=function(e){return t(this,e)}};var u=e.prototype.equal,o=r.prototype.equal;t.restore=function(){e.prototype.equal=u,r.prototype.equal=o};
},{}],"JZSy":[function(require,module,exports) {
"use strict";function r(r){return(r/8|0)+(r%8==0?0:1)}var n={ES256:r(256),ES384:r(384),ES512:r(521)};function t(r){var t=n[r];if(t)return t;throw new Error('Unknown algorithm "'+r+'"')}module.exports=t;
},{}],"qrjx":[function(require,module,exports) {
"use strict";var r=require("safe-buffer").Buffer,e=require("./param-bytes-for-alg"),o=128,t=0,n=32,f=16,i=2,a=f|n|t<<6,s=i|t<<6;function c(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function u(e){if(r.isBuffer(e))return e;if("string"==typeof e)return r.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function l(t,n){t=u(t);var f=e(n),i=f+1,l=t.length,p=0;if(t[p++]!==a)throw new Error('Could not find expected "seq"');var w=t[p++];if(w===(1|o)&&(w=t[p++]),l-p<w)throw new Error('"seq" specified length of "'+w+'", only "'+(l-p)+'" remaining');if(t[p++]!==s)throw new Error('Could not find expected "int" for "r"');var h=t[p++];if(l-p-2<h)throw new Error('"r" specified length of "'+h+'", only "'+(l-p-2)+'" available');if(i<h)throw new Error('"r" specified length of "'+h+'", max of "'+i+'" is acceptable');var d=p;if(p+=h,t[p++]!==s)throw new Error('Could not find expected "int" for "s"');var g=t[p++];if(l-p!==g)throw new Error('"s" specified length of "'+g+'", expected "'+(l-p)+'"');if(i<g)throw new Error('"s" specified length of "'+g+'", max of "'+i+'" is acceptable');var y=p;if((p+=g)!==l)throw new Error('Expected to consume entire buffer, but "'+(l-p)+'" bytes remain');var b=f-h,v=f-g,E=r.allocUnsafe(b+h+v+g);for(p=0;p<b;++p)E[p]=0;t.copy(E,p,d+Math.max(-b,0),d+h);for(var m=p=f;p<m+v;++p)E[p]=0;return t.copy(E,p,y+Math.max(-v,0),y+g),E=c(E=E.toString("base64"))}function p(r,e,t){for(var n=0;e+n<t&&0===r[e+n];)++n;return r[e+n]>=o&&--n,n}function w(t,n){t=u(t);var f=e(n),i=t.length;if(i!==2*f)throw new TypeError('"'+n+'" signatures must be "'+2*f+'" bytes, saw "'+i+'"');var c=p(t,0,f),l=p(t,f,t.length),w=f-c,h=f-l,d=2+w+1+1+h,g=d<o,y=r.allocUnsafe((g?2:3)+d),b=0;return y[b++]=a,g?y[b++]=d:(y[b++]=1|o,y[b++]=255&d),y[b++]=s,y[b++]=w,c<0?(y[b++]=0,b+=t.copy(y,b,0,f)):b+=t.copy(y,b,c,f),y[b++]=s,y[b++]=h,l<0?(y[b++]=0,t.copy(y,b,f)):t.copy(y,b,f+l),y}module.exports={derToJose:l,joseToDer:w};
},{"safe-buffer":"Wugr","./param-bytes-for-alg":"JZSy"}],"rsbN":[function(require,module,exports) {
var r=require("buffer-equal-constant-time"),e=require("safe-buffer").Buffer,t=require("crypto"),n=require("ecdsa-sig-formatter"),o=require("util"),i='"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',f="secret must be a string or buffer",u="key must be a string or a buffer",a="key must be a string, a buffer or an object",c="function"==typeof t.createPublicKey;function s(r){if(!e.isBuffer(r)&&"string"!=typeof r){if(!c)throw l(u);if("object"!=typeof r)throw l(u);if("string"!=typeof r.type)throw l(u);if("string"!=typeof r.asymmetricKeyType)throw l(u);if("function"!=typeof r.export)throw l(u)}}function S(r){if(!e.isBuffer(r)&&"string"!=typeof r&&"object"!=typeof r)throw l(a)}function p(r){if(!e.isBuffer(r)){if("string"==typeof r)return r;if(!c)throw l(f);if("object"!=typeof r)throw l(f);if("secret"!==r.type)throw l(f);if("function"!=typeof r.export)throw l(f)}}function y(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function g(r){var e=4-(r=r.toString()).length%4;if(4!==e)for(var t=0;t<e;++t)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function l(r){var e=[].slice.call(arguments,1),t=o.format.bind(o,r).apply(null,e);return new TypeError(t)}function b(r){return e.isBuffer(r)||"string"==typeof r}function h(r){return b(r)||(r=JSON.stringify(r)),r}function v(r){return function(e,n){p(n),e=h(e);var o=t.createHmac("sha"+r,n);return y((o.update(e),o.digest("base64")))}}function d(t){return function(n,o,i){var f=v(t)(n,i);return r(e.from(o),e.from(f))}}function A(r){return function(e,n){S(n),e=h(e);var o=t.createSign("RSA-SHA"+r);return y((o.update(e),o.sign(n,"base64")))}}function m(r){return function(e,n,o){s(o),e=h(e),n=g(n);var i=t.createVerify("RSA-SHA"+r);return i.update(e),i.verify(o,n,"base64")}}function _(r){return function(e,n){S(n),e=h(e);var o=t.createSign("RSA-SHA"+r);return y((o.update(e),o.sign({key:n,padding:t.constants.RSA_PKCS1_PSS_PADDING,saltLength:t.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function w(r){return function(e,n,o){s(o),e=h(e),n=g(n);var i=t.createVerify("RSA-SHA"+r);return i.update(e),i.verify({key:o,padding:t.constants.RSA_PKCS1_PSS_PADDING,saltLength:t.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function P(r){var e=A(r);return function(){var t=e.apply(null,arguments);return t=n.derToJose(t,"ES"+r)}}function R(r){var e=m(r);return function(t,o,i){return o=n.joseToDer(o,"ES"+r).toString("base64"),e(t,o,i)}}function E(){return function(){return""}}function H(){return function(r,e){return""===e}}c&&(u+=" or a KeyObject",f+="or a KeyObject"),module.exports=function(r){var e={hs:v,rs:A,ps:_,es:P,none:E},t={hs:d,rs:m,ps:w,es:R,none:H},n=r.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw l(i,r);var o=(n[1]||n[3]).toLowerCase(),f=n[2];return{sign:e[o](f),verify:t[o](f)}};
},{"buffer-equal-constant-time":"nhWN","safe-buffer":"Wugr","ecdsa-sig-formatter":"qrjx"}],"CSk2":[function(require,module,exports) {
var r=require("buffer").Buffer;module.exports=function(e){return"string"==typeof e?e:"number"==typeof e||r.isBuffer(e)?e.toString():JSON.stringify(e)};
},{}],"CWEE":[function(require,module,exports) {
var e=require("safe-buffer").Buffer,t=require("./data-stream"),i=require("jwa"),r=require("stream"),a=require("./tostring"),s=require("util");function n(t,i){return e.from(t,i).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function h(e,t,i){i=i||"utf8";var r=n(a(e),"binary"),h=n(a(t),i);return s.format("%s.%s",r,h)}function o(e){var t=e.header,r=e.payload,a=e.secret||e.privateKey,n=e.encoding,o=i(t.alg),c=h(t,r,n),d=o.sign(c,a);return s.format("%s.%s",c,d)}function c(e){var i=e.secret||e.privateKey||e.key,r=new t(i);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new t(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}s.inherits(c,r),c.prototype.sign=function(){try{var e=o({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}},c.sign=o,module.exports=c;
},{"safe-buffer":"Wugr","./data-stream":"VO8B","jwa":"rsbN","./tostring":"CSk2"}],"euQ6":[function(require,module,exports) {
var t=require("safe-buffer").Buffer,e=require("./data-stream"),r=require("jwa"),i=require("stream"),n=require("./tostring"),s=require("util"),a=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function u(t){return"[object Object]"===Object.prototype.toString.call(t)}function o(t){if(u(t))return t;try{return JSON.parse(t)}catch(e){return}}function c(e){var r=e.split(".",1)[0];return o(t.from(r,"base64").toString("binary"))}function f(t){return t.split(".",2).join(".")}function h(t){return t.split(".")[2]}function l(e,r){r=r||"utf8";var i=e.split(".")[1];return t.from(i,"base64").toString(r)}function d(t){return a.test(t)&&!!c(t)}function b(t,e,i){if(!e){var s=new Error("Missing algorithm parameter for jws.verify");throw s.code="MISSING_ALGORITHM",s}var a=h(t=n(t)),u=f(t);return r(e).verify(u,a,i)}function g(t,e){if(e=e||{},!d(t=n(t)))return null;var r=c(t);if(!r)return null;var i=l(t);return("JWT"===r.typ||e.json)&&(i=JSON.parse(i,e.encoding)),{header:r,payload:i,signature:h(t)}}function y(t){var r=(t=t||{}).secret||t.publicKey||t.key,i=new e(r);this.readable=!0,this.algorithm=t.algorithm,this.encoding=t.encoding,this.secret=this.publicKey=this.key=i,this.signature=new e(t.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}s.inherits(y,i),y.prototype.verify=function(){try{var t=b(this.signature.buffer,this.algorithm,this.key.buffer),e=g(this.signature.buffer,this.encoding);return this.emit("done",t,e),this.emit("data",t),this.emit("end"),this.readable=!1,t}catch(r){this.readable=!1,this.emit("error",r),this.emit("close")}},y.decode=g,y.isValid=d,y.verify=b,module.exports=y;
},{"safe-buffer":"Wugr","./data-stream":"VO8B","jwa":"rsbN","./tostring":"CSk2"}],"kAAO":[function(require,module,exports) {
var e=require("./lib/sign-stream"),r=require("./lib/verify-stream"),i=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];exports.ALGORITHMS=i,exports.sign=e.sign,exports.verify=r.verify,exports.decode=r.decode,exports.isValid=r.isValid,exports.createSign=function(r){return new e(r)},exports.createVerify=function(e){return new r(e)};
},{"./lib/sign-stream":"CWEE","./lib/verify-stream":"euQ6"}],"smfd":[function(require,module,exports) {
var e=require("jws");module.exports=function(r,a){a=a||{};var t=e.decode(r,a);if(!t)return null;var o=t.payload;if("string"==typeof o)try{var n=JSON.parse(o);null!==n&&"object"==typeof n&&(o=n)}catch(u){}return!0===a.complete?{header:t.header,payload:o,signature:t.signature}:o};
},{"jws":"kAAO"}],"Sgmk":[function(require,module,exports) {
var r=function(r,t){Error.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=r,t&&(this.inner=t)};r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,module.exports=r;
},{}],"INvn":[function(require,module,exports) {
var o=require("./JsonWebTokenError"),r=function(r,t){o.call(this,r),this.name="NotBeforeError",this.date=t};r.prototype=Object.create(o.prototype),r.prototype.constructor=r,module.exports=r;
},{"./JsonWebTokenError":"Sgmk"}],"lLu7":[function(require,module,exports) {
var r=require("./JsonWebTokenError"),e=function(e,o){r.call(this,e),this.name="TokenExpiredError",this.expiredAt=o};e.prototype=Object.create(r.prototype),e.prototype.constructor=e,module.exports=e;
},{"./JsonWebTokenError":"Sgmk"}],"IAgR":[function(require,module,exports) {
var s=1e3,e=60*s,r=60*e,a=24*r,n=7*a,c=365.25*a;function t(t){if(!((t=String(t)).length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(u){var i=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*c;case"weeks":case"week":case"w":return i*n;case"days":case"day":case"d":return i*a;case"hours":case"hour":case"hrs":case"hr":case"h":return i*r;case"minutes":case"minute":case"mins":case"min":case"m":return i*e;case"seconds":case"second":case"secs":case"sec":case"s":return i*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function u(n){var c=Math.abs(n);return c>=a?Math.round(n/a)+"d":c>=r?Math.round(n/r)+"h":c>=e?Math.round(n/e)+"m":c>=s?Math.round(n/s)+"s":n+"ms"}function i(n){var c=Math.abs(n);return c>=a?o(n,c,a,"day"):c>=r?o(n,c,r,"hour"):c>=e?o(n,c,e,"minute"):c>=s?o(n,c,s,"second"):n+" ms"}function o(s,e,r,a){var n=e>=1.5*r;return Math.round(s/r)+" "+a+(n?"s":"")}module.exports=function(s,e){e=e||{};var r=typeof s;if("string"===r&&s.length>0)return t(s);if("number"===r&&isFinite(s))return e.long?i(s):u(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};
},{}],"BVtP":[function(require,module,exports) {
var r=require("ms");module.exports=function(e,o){var t=o||Math.floor(Date.now()/1e3);if("string"==typeof e){var n=r(e);if(void 0===n)return;return Math.floor(t+n/1e3)}return"number"==typeof e?t+e:void 0};
},{"ms":"IAgR"}],"y4rL":[function(require,module,exports) {
var e;exports=module.exports=Q,e="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},exports.SEMVER_SPEC_VERSION="2.0.0";var r=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,n=16,o=exports.re=[],s=exports.src=[],i=0,a=i++;s[a]="0|[1-9]\\d*";var p=i++;s[p]="[0-9]+";var u=i++;s[u]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var c=i++;s[c]="("+s[a]+")\\.("+s[a]+")\\.("+s[a]+")";var h=i++;s[h]="("+s[p]+")\\.("+s[p]+")\\.("+s[p]+")";var l=i++;s[l]="(?:"+s[a]+"|"+s[u]+")";var f=i++;s[f]="(?:"+s[p]+"|"+s[u]+")";var v=i++;s[v]="(?:-("+s[l]+"(?:\\."+s[l]+")*))";var m=i++;s[m]="(?:-?("+s[f]+"(?:\\."+s[f]+")*))";var w=i++;s[w]="[0-9A-Za-z-]+";var g=i++;s[g]="(?:\\+("+s[w]+"(?:\\."+s[w]+")*))";var y=i++,x="v?"+s[c]+s[v]+"?"+s[g]+"?";s[y]="^"+x+"$";var d="[v=\\s]*"+s[h]+s[m]+"?"+s[g]+"?",j=i++;s[j]="^"+d+"$";var E=i++;s[E]="((?:<|>)?=?)";var b=i++;s[b]=s[p]+"|x|X|\\*";var $=i++;s[$]=s[a]+"|x|X|\\*";var R=i++;s[R]="[v=\\s]*("+s[$]+")(?:\\.("+s[$]+")(?:\\.("+s[$]+")(?:"+s[v]+")?"+s[g]+"?)?)?";var S=i++;s[S]="[v=\\s]*("+s[b]+")(?:\\.("+s[b]+")(?:\\.("+s[b]+")(?:"+s[m]+")?"+s[g]+"?)?)?";var T=i++;s[T]="^"+s[E]+"\\s*"+s[R]+"$";var P=i++;s[P]="^"+s[E]+"\\s*"+s[S]+"$";var k=i++;s[k]="(?:^|[^\\d])(\\d{1,"+n+"})(?:\\.(\\d{1,"+n+"}))?(?:\\.(\\d{1,"+n+"}))?(?:$|[^\\d])";var I=i++;s[I]="(?:~>?)";var V=i++;s[V]="(\\s*)"+s[I]+"\\s+",o[V]=new RegExp(s[V],"g");var C="$1~",N=i++;s[N]="^"+s[I]+s[R]+"$";var A=i++;s[A]="^"+s[I]+s[S]+"$";var M=i++;s[M]="(?:\\^)";var _=i++;s[_]="(\\s*)"+s[M]+"\\s+",o[_]=new RegExp(s[_],"g");var q="$1^",D=i++;s[D]="^"+s[M]+s[R]+"$";var X=i++;s[X]="^"+s[M]+s[S]+"$";var z=i++;s[z]="^"+s[E]+"\\s*("+d+")$|^$";var G=i++;s[G]="^"+s[E]+"\\s*("+x+")$|^$";var O=i++;s[O]="(\\s*)"+s[E]+"\\s*("+d+"|"+s[R]+")",o[O]=new RegExp(s[O],"g");var U="$1$2$3",Z=i++;s[Z]="^\\s*("+s[R]+")\\s+-\\s+("+s[R]+")\\s*$";var B=i++;s[B]="^\\s*("+s[S]+")\\s+-\\s+("+s[S]+")\\s*$";var L=i++;s[L]="(<|>)?=?\\s*\\*";for(var F=0;F<i;F++)e(F,s[F]),o[F]||(o[F]=new RegExp(s[F]));function H(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof Q)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?o[j]:o[y]).test(e))return null;try{return new Q(e,t)}catch(n){return null}}function J(e,r){var t=H(e,r);return t?t.version:null}function K(e,r){var t=H(e.trim().replace(/^[=v]+/,""),r);return t?t.version:null}function Q(n,s){if(s&&"object"==typeof s||(s={loose:!!s,includePrerelease:!1}),n instanceof Q){if(n.loose===s.loose)return n;n=n.version}else if("string"!=typeof n)throw new TypeError("Invalid Version: "+n);if(n.length>r)throw new TypeError("version is longer than "+r+" characters");if(!(this instanceof Q))return new Q(n,s);e("SemVer",n,s),this.options=s,this.loose=!!s.loose;var i=n.trim().match(s.loose?o[j]:o[y]);if(!i)throw new TypeError("Invalid Version: "+n);if(this.raw=n,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var r=+e;if(r>=0&&r<t)return r}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}function W(e,r,t,n){"string"==typeof t&&(n=t,t=void 0);try{return new Q(e,t).inc(r,n).version}catch(o){return null}}function Y(e,r){if(fe(e,r))return null;var t=H(e),n=H(r),o="";if(t.prerelease.length||n.prerelease.length){o="pre";var s="prerelease"}for(var i in t)if(("major"===i||"minor"===i||"patch"===i)&&t[i]!==n[i])return o+i;return s}exports.parse=H,exports.valid=J,exports.clean=K,exports.SemVer=Q,Q.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Q.prototype.toString=function(){return this.version},Q.prototype.compare=function(r){return e("SemVer.compare",this.version,this.options,r),r instanceof Q||(r=new Q(r,this.options)),this.compareMain(r)||this.comparePre(r)},Q.prototype.compareMain=function(e){return e instanceof Q||(e=new Q(e,this.options)),re(this.major,e.major)||re(this.minor,e.minor)||re(this.patch,e.patch)},Q.prototype.comparePre=function(r){if(r instanceof Q||(r=new Q(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],o=r.prerelease[t];if(e("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return re(n,o)}while(++t)},Q.prototype.inc=function(e,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r),this.inc("pre",r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",r),this.inc("pre",r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}r&&(this.prerelease[0]===r?isNaN(this.prerelease[1])&&(this.prerelease=[r,0]):this.prerelease=[r,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},exports.inc=W,exports.diff=Y,exports.compareIdentifiers=re;var ee=/^[0-9]+$/;function re(e,r){var t=ee.test(e),n=ee.test(r);return t&&n&&(e=+e,r=+r),e===r?0:t&&!n?-1:n&&!t?1:e<r?-1:1}function te(e,r){return re(r,e)}function ne(e,r){return new Q(e,r).major}function oe(e,r){return new Q(e,r).minor}function se(e,r){return new Q(e,r).patch}function ie(e,r,t){return new Q(e,t).compare(new Q(r,t))}function ae(e,r){return ie(e,r,!0)}function pe(e,r,t){return ie(r,e,t)}function ue(e,r){return e.sort(function(e,t){return exports.compare(e,t,r)})}function ce(e,r){return e.sort(function(e,t){return exports.rcompare(e,t,r)})}function he(e,r,t){return ie(e,r,t)>0}function le(e,r,t){return ie(e,r,t)<0}function fe(e,r,t){return 0===ie(e,r,t)}function ve(e,r,t){return 0!==ie(e,r,t)}function me(e,r,t){return ie(e,r,t)>=0}function we(e,r,t){return ie(e,r,t)<=0}function ge(e,r,t,n){switch(r){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof t&&(t=t.version),e===t;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof t&&(t=t.version),e!==t;case"":case"=":case"==":return fe(e,t,n);case"!=":return ve(e,t,n);case">":return he(e,t,n);case">=":return me(e,t,n);case"<":return le(e,t,n);case"<=":return we(e,t,n);default:throw new TypeError("Invalid operator: "+r)}}function ye(r,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),r instanceof ye){if(r.loose===!!t.loose)return r;r=r.value}if(!(this instanceof ye))return new ye(r,t);e("comparator",r,t),this.options=t,this.loose=!!t.loose,this.parse(r),this.semver===xe?this.value="":this.value=this.operator+this.semver.version,e("comp",this)}exports.rcompareIdentifiers=te,exports.major=ne,exports.minor=oe,exports.patch=se,exports.compare=ie,exports.compareLoose=ae,exports.rcompare=pe,exports.sort=ue,exports.rsort=ce,exports.gt=he,exports.lt=le,exports.eq=fe,exports.neq=ve,exports.gte=me,exports.lte=we,exports.cmp=ge,exports.Comparator=ye;var xe={};function de(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof de)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new de(e.raw,r);if(e instanceof ye)return new de(e.value,r);if(!(this instanceof de))return new de(e,r);if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function je(e,r){return new de(e,r).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})}function Ee(r,t){return e("comp",r,t),r=Se(r,t),e("caret",r),r=$e(r,t),e("tildes",r),r=Pe(r,t),e("xrange",r),r=Ie(r,t),e("stars",r),r}function be(e){return!e||"x"===e.toLowerCase()||"*"===e}function $e(e,r){return e.trim().split(/\s+/).map(function(e){return Re(e,r)}).join(" ")}function Re(r,t){var n=t.loose?o[A]:o[N];return r.replace(n,function(t,n,o,s,i){var a;return e("tilde",r,t,n,o,s,i),be(n)?a="":be(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":be(s)?a=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":i?(e("replaceTilde pr",i),a=">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+(+o+1)+".0"):a=">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0",e("tilde return",a),a})}function Se(e,r){return e.trim().split(/\s+/).map(function(e){return Te(e,r)}).join(" ")}function Te(r,t){e("caret",r,t);var n=t.loose?o[X]:o[D];return r.replace(n,function(t,n,o,s,i){var a;return e("caret",r,t,n,o,s,i),be(n)?a="":be(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":be(s)?a="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":i?(e("replaceCaret pr",i),a="0"===n?"0"===o?">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+"-"+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+"-"+i+" <"+(+n+1)+".0.0"):(e("no pr"),a="0"===n?"0"===o?">="+n+"."+o+"."+s+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+" <"+(+n+1)+".0.0"),e("caret return",a),a})}function Pe(r,t){return e("replaceXRanges",r,t),r.split(/\s+/).map(function(e){return ke(e,t)}).join(" ")}function ke(r,t){r=r.trim();var n=t.loose?o[P]:o[T];return r.replace(n,function(t,n,o,s,i,a){e("xRange",r,t,n,o,s,i,a);var p=be(o),u=p||be(s),c=u||be(i);return"="===n&&c&&(n=""),p?t=">"===n||"<"===n?"<0.0.0":"*":n&&c?(u&&(s=0),i=0,">"===n?(n=">=",u?(o=+o+1,s=0,i=0):(s=+s+1,i=0)):"<="===n&&(n="<",u?o=+o+1:s=+s+1),t=n+o+"."+s+"."+i):u?t=">="+o+".0.0 <"+(+o+1)+".0.0":c&&(t=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),e("xRange return",t),t})}function Ie(r,t){return e("replaceStars",r,t),r.trim().replace(o[L],"")}function Ve(e,r,t,n,o,s,i,a,p,u,c,h,l){return((r=be(t)?"":be(n)?">="+t+".0.0":be(o)?">="+t+"."+n+".0":">="+r)+" "+(a=be(p)?"":be(u)?"<"+(+p+1)+".0.0":be(c)?"<"+p+"."+(+u+1)+".0":h?"<="+p+"."+u+"."+c+"-"+h:"<="+a)).trim()}function Ce(r,t,n){for(var o=0;o<r.length;o++)if(!r[o].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(o=0;o<r.length;o++)if(e(r[o].semver),r[o].semver!==xe&&r[o].semver.prerelease.length>0){var s=r[o].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}function Ne(e,r,t){try{r=new de(r,t)}catch(n){return!1}return r.test(e)}function Ae(e,r,t){var n=null,o=null;try{var s=new de(r,t)}catch(i){return null}return e.forEach(function(e){s.test(e)&&(n&&-1!==o.compare(e)||(o=new Q(n=e,t)))}),n}function Me(e,r,t){var n=null,o=null;try{var s=new de(r,t)}catch(i){return null}return e.forEach(function(e){s.test(e)&&(n&&1!==o.compare(e)||(o=new Q(n=e,t)))}),n}function _e(e,r){e=new de(e,r);var t=new Q("0.0.0");if(e.test(t))return t;if(t=new Q("0.0.0-0"),e.test(t))return t;t=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach(function(e){var r=new Q(e.semver.version);switch(e.operator){case">":0===r.prerelease.length?r.patch++:r.prerelease.push(0),r.raw=r.format();case"":case">=":t&&!he(t,r)||(t=r);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}return t&&e.test(t)?t:null}function qe(e,r){try{return new de(e,r).range||"*"}catch(t){return null}}function De(e,r,t){return ze(e,r,"<",t)}function Xe(e,r,t){return ze(e,r,">",t)}function ze(e,r,t,n){var o,s,i,a,p;switch(e=new Q(e,n),r=new de(r,n),t){case">":o=he,s=we,i=le,a=">",p=">=";break;case"<":o=le,s=me,i=he,a="<",p="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Ne(e,r,n))return!1;for(var u=0;u<r.set.length;++u){var c=r.set[u],h=null,l=null;if(c.forEach(function(e){e.semver===xe&&(e=new ye(">=0.0.0")),h=h||e,l=l||e,o(e.semver,h.semver,n)?h=e:i(e.semver,l.semver,n)&&(l=e)}),h.operator===a||h.operator===p)return!1;if((!l.operator||l.operator===a)&&s(e,l.semver))return!1;if(l.operator===p&&i(e,l.semver))return!1}return!0}function Ge(e,r){var t=H(e,r);return t&&t.prerelease.length?t.prerelease:null}function Oe(e,r,t){return e=new de(e,t),r=new de(r,t),e.intersects(r)}function Ue(e){if(e instanceof Q)return e;if("string"!=typeof e)return null;var r=e.match(o[k]);return null==r?null:H(r[1]+"."+(r[2]||"0")+"."+(r[3]||"0"))}ye.prototype.parse=function(e){var r=this.options.loose?o[z]:o[G],t=e.match(r);if(!t)throw new TypeError("Invalid comparator: "+e);this.operator=t[1],"="===this.operator&&(this.operator=""),t[2]?this.semver=new Q(t[2],this.options.loose):this.semver=xe},ye.prototype.toString=function(){return this.value},ye.prototype.test=function(r){return e("Comparator.test",r,this.options.loose),this.semver===xe||("string"==typeof r&&(r=new Q(r,this.options)),ge(r,this.operator,this.semver,this.options))},ye.prototype.intersects=function(e,r){if(!(e instanceof ye))throw new TypeError("a Comparator is required");var t;if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),""===this.operator)return t=new de(e.value,r),Ne(this.value,t,r);if(""===e.operator)return t=new de(this.value,r),Ne(e.semver,t,r);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=ge(this.semver,"<",e.semver,r)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),p=ge(this.semver,">",e.semver,r)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||o||s&&i||a||p},exports.Range=de,de.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},de.prototype.toString=function(){return this.range},de.prototype.parseRange=function(r){var t=this.options.loose;r=r.trim();var n=t?o[B]:o[Z];r=r.replace(n,Ve),e("hyphen replace",r),r=r.replace(o[O],U),e("comparator trim",r,o[O]),r=(r=(r=r.replace(o[V],C)).replace(o[_],q)).split(/\s+/).join(" ");var s=t?o[z]:o[G],i=r.split(" ").map(function(e){return Ee(e,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(e){return!!e.match(s)})),i=i.map(function(e){return new ye(e,this.options)},this)},de.prototype.intersects=function(e,r){if(!(e instanceof de))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(t){return e.set.some(function(e){return e.every(function(e){return t.intersects(e,r)})})})})},exports.toComparators=je,de.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new Q(e,this.options));for(var r=0;r<this.set.length;r++)if(Ce(this.set[r],e,this.options))return!0;return!1},exports.satisfies=Ne,exports.maxSatisfying=Ae,exports.minSatisfying=Me,exports.minVersion=_e,exports.validRange=qe,exports.ltr=De,exports.gtr=Xe,exports.outside=ze,exports.prerelease=Ge,exports.intersects=Oe,exports.coerce=Ue;
},{}],"GCxj":[function(require,module,exports) {
var e=require("semver");module.exports=e.satisfies(process.version,"^6.12.0 || >=8.0.0");
},{"semver":"y4rL"}],"nva4":[function(require,module,exports) {
var e=require("./lib/JsonWebTokenError"),r=require("./lib/NotBeforeError"),n=require("./lib/TokenExpiredError"),i=require("./decode"),t=require("./lib/timespan"),a=require("./lib/psSupported"),u=require("jws"),o=["RS256","RS384","RS512","ES256","ES384","ES512"],s=["RS256","RS384","RS512"],c=["HS256","HS384","HS512"];a&&(o.splice(3,0,"PS256","PS384","PS512"),s.splice(3,0,"PS256","PS384","PS512")),module.exports=function(a,f,d,l){var p;if("function"!=typeof d||l||(l=d,d={}),d||(d={}),d=Object.assign({},d),p=l||function(e,r){if(e)throw e;return r},d.clockTimestamp&&"number"!=typeof d.clockTimestamp)return p(new e("clockTimestamp must be a number"));if(void 0!==d.nonce&&("string"!=typeof d.nonce||""===d.nonce.trim()))return p(new e("nonce must be a non-empty string"));var w=d.clockTimestamp||Math.floor(Date.now()/1e3);if(!a)return p(new e("jwt must be provided"));if("string"!=typeof a)return p(new e("jwt must be a string"));var m,b=a.split(".");if(3!==b.length)return p(new e("jwt malformed"));try{m=i(a,{complete:!0})}catch(x){return p(x)}if(!m)return p(new e("invalid token"));var g,v=m.header;if("function"==typeof f){if(!l)return p(new e("verify must be called asynchronous if secret or public key is provided as a callback"));g=f}else g=function(e,r){return r(null,f)};return g(v,function(i,f){if(i)return p(new e("error in secret or public key callback: "+i.message));var l,g=""!==b[2].trim();if(!g&&f)return p(new e("jwt signature is required"));if(g&&!f)return p(new e("secret or public key must be provided"));if(g||d.algorithms||(d.algorithms=["none"]),d.algorithms||(d.algorithms=~f.toString().indexOf("BEGIN CERTIFICATE")||~f.toString().indexOf("BEGIN PUBLIC KEY")?o:~f.toString().indexOf("BEGIN RSA PUBLIC KEY")?s:c),!~d.algorithms.indexOf(m.header.alg))return p(new e("invalid algorithm"));try{l=u.verify(a,m.header.alg,f)}catch(h){return p(h)}if(!l)return p(new e("invalid signature"));var x=m.payload;if(void 0!==x.nbf&&!d.ignoreNotBefore){if("number"!=typeof x.nbf)return p(new e("invalid nbf value"));if(x.nbf>w+(d.clockTolerance||0))return p(new r("jwt not active",new Date(1e3*x.nbf)))}if(void 0!==x.exp&&!d.ignoreExpiration){if("number"!=typeof x.exp)return p(new e("invalid exp value"));if(w>=x.exp+(d.clockTolerance||0))return p(new n("jwt expired",new Date(1e3*x.exp)))}if(d.audience){var y=Array.isArray(d.audience)?d.audience:[d.audience];if(!(Array.isArray(x.aud)?x.aud:[x.aud]).some(function(e){return y.some(function(r){return r instanceof RegExp?r.test(e):r===e})}))return p(new e("jwt audience invalid. expected: "+y.join(" or ")))}if(d.issuer&&("string"==typeof d.issuer&&x.iss!==d.issuer||Array.isArray(d.issuer)&&-1===d.issuer.indexOf(x.iss)))return p(new e("jwt issuer invalid. expected: "+d.issuer));if(d.subject&&x.sub!==d.subject)return p(new e("jwt subject invalid. expected: "+d.subject));if(d.jwtid&&x.jti!==d.jwtid)return p(new e("jwt jwtid invalid. expected: "+d.jwtid));if(d.nonce&&x.nonce!==d.nonce)return p(new e("jwt nonce invalid. expected: "+d.nonce));if(d.maxAge){if("number"!=typeof x.iat)return p(new e("iat required when maxAge is specified"));var j=t(d.maxAge,x.iat);if(void 0===j)return p(new e('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(w>=j+(d.clockTolerance||0))return p(new n("maxAge exceeded",new Date(1e3*j)))}if(!0===d.complete){var S=m.signature;return p(null,{header:v,payload:x,signature:S})}return p(null,x)})};
},{"./lib/JsonWebTokenError":"Sgmk","./lib/NotBeforeError":"INvn","./lib/TokenExpiredError":"lLu7","./decode":"smfd","./lib/timespan":"BVtP","./lib/psSupported":"GCxj","jws":"kAAO"}],"R8Ln":[function(require,module,exports) {
var n=1/0,r=9007199254740991,t=1.7976931348623157e308,e=NaN,u="[object Arguments]",o="[object Function]",c="[object GeneratorFunction]",f="[object String]",i="[object Symbol]",a=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,s=/^0o[0-7]+$/i,y=/^(?:0|[1-9]\d*)$/,v=parseInt;function b(n,r){for(var t=-1,e=n?n.length:0,u=Array(e);++t<e;)u[t]=r(n[t],t,n);return u}function g(n,r,t,e){for(var u=n.length,o=t+(e?1:-1);e?o--:++o<u;)if(r(n[o],o,n))return o;return-1}function h(n,r,t){if(r!=r)return g(n,j,t);for(var e=t-1,u=n.length;++e<u;)if(n[e]===r)return e;return-1}function j(n){return n!=n}function m(n,r){for(var t=-1,e=Array(n);++t<n;)e[t]=r(t);return e}function O(n,r){return b(r,function(r){return n[r]})}function A(n,r){return function(t){return n(r(t))}}var $=Object.prototype,x=$.hasOwnProperty,S=$.toString,d=$.propertyIsEnumerable,F=A(Object.keys,Object),I=Math.max;function N(n,r){var t=P(n)||M(n)?m(n.length,String):[],e=t.length,u=!!e;for(var o in n)!r&&!x.call(n,o)||u&&("length"==o||w(o,e))||t.push(o);return t}function k(n){if(!E(n))return F(n);var r=[];for(var t in Object(n))x.call(n,t)&&"constructor"!=t&&r.push(t);return r}function w(n,t){return!!(t=null==t?r:t)&&("number"==typeof n||y.test(n))&&n>-1&&n%1==0&&n<t}function E(n){var r=n&&n.constructor;return n===("function"==typeof r&&r.prototype||$)}function G(n,r,t,e){n=q(n)?n:U(n),t=t&&!e?Q(t):0;var u=n.length;return t<0&&(t=I(u+t,0)),J(n)?t<=u&&n.indexOf(r,t)>-1:!!u&&h(n,r,t)>-1}function M(n){return z(n)&&x.call(n,"callee")&&(!d.call(n,"callee")||S.call(n)==u)}var P=Array.isArray;function q(n){return null!=n&&C(n.length)&&!B(n)}function z(n){return H(n)&&q(n)}function B(n){var r=D(n)?S.call(n):"";return r==o||r==c}function C(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=r}function D(n){var r=typeof n;return!!n&&("object"==r||"function"==r)}function H(n){return!!n&&"object"==typeof n}function J(n){return"string"==typeof n||!P(n)&&H(n)&&S.call(n)==f}function K(n){return"symbol"==typeof n||H(n)&&S.call(n)==i}function L(r){return r?(r=R(r))===n||r===-n?(r<0?-1:1)*t:r==r?r:0:0===r?r:0}function Q(n){var r=L(n),t=r%1;return r==r?t?r-t:r:0}function R(n){if("number"==typeof n)return n;if(K(n))return e;if(D(n)){var r="function"==typeof n.valueOf?n.valueOf():n;n=D(r)?r+"":r}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(a,"");var t=p.test(n);return t||s.test(n)?v(n.slice(2),t?2:8):l.test(n)?e:+n}function T(n){return q(n)?N(n):k(n)}function U(n){return n?O(n,T(n)):[]}module.exports=G;
},{}],"fb6B":[function(require,module,exports) {
var t="[object Boolean]",o=Object.prototype,e=o.toString;function n(o){return!0===o||!1===o||r(o)&&e.call(o)==t}function r(t){return!!t&&"object"==typeof t}module.exports=n;
},{}],"pN6T":[function(require,module,exports) {
var t=1/0,e=1.7976931348623157e308,n=NaN,r="[object Symbol]",o=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,i=/^0o[0-7]+$/i,c=parseInt,a=Object.prototype,p=a.toString;function s(t){return"number"==typeof t&&t==m(t)}function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function b(t){return!!t&&"object"==typeof t}function l(t){return"symbol"==typeof t||b(t)&&p.call(t)==r}function v(n){return n?(n=j(n))===t||n===-t?(n<0?-1:1)*e:n==n?n:0:0===n?n:0}function m(t){var e=v(t),n=e%1;return e==e?n?e-n:e:0}function j(t){if("number"==typeof t)return t;if(l(t))return n;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var r=f.test(t);return r||i.test(t)?c(t.slice(2),r?2:8):u.test(t)?n:+t}module.exports=s;
},{}],"IN1P":[function(require,module,exports) {
var t="[object Number]",e=Object.prototype,o=e.toString;function r(t){return!!t&&"object"==typeof t}function n(e){return"number"==typeof e||r(e)&&o.call(e)==t}module.exports=n;
},{}],"hT6N":[function(require,module,exports) {
var t="[object Object]";function n(t){var n=!1;if(null!=t&&"function"!=typeof t.toString)try{n=!!(t+"")}catch(r){}return n}function r(t,n){return function(r){return t(n(r))}}var o=Function.prototype,c=Object.prototype,e=o.toString,u=c.hasOwnProperty,f=e.call(Object),i=c.toString,l=r(Object.getPrototypeOf,Object);function a(t){return!!t&&"object"==typeof t}function p(r){if(!a(r)||i.call(r)!=t||n(r))return!1;var o=l(r);if(null===o)return!0;var c=u.call(o,"constructor")&&o.constructor;return"function"==typeof c&&c instanceof c&&e.call(c)==f}module.exports=p;
},{}],"eMen":[function(require,module,exports) {
var t="[object String]",r=Object.prototype,o=r.toString,e=Array.isArray;function n(t){return!!t&&"object"==typeof t}function c(r){return"string"==typeof r||!e(r)&&n(r)&&o.call(r)==t}module.exports=c;
},{}],"Lf7l":[function(require,module,exports) {
var t="Expected a function",n=1/0,e=1.7976931348623157e308,r=NaN,o="[object Symbol]",u=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,c=/^0o[0-7]+$/i,p=parseInt,a=Object.prototype,y=a.toString;function s(n,e){var r;if("function"!=typeof e)throw new TypeError(t);return n=$(n),function(){return--n>0&&(r=e.apply(this,arguments)),n<=1&&(e=void 0),r}}function l(t){return s(2,t)}function v(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function b(t){return!!t&&"object"==typeof t}function j(t){return"symbol"==typeof t||b(t)&&y.call(t)==o}function m(t){return t?(t=d(t))===n||t===-n?(t<0?-1:1)*e:t==t?t:0:0===t?t:0}function $(t){var n=m(t),e=n%1;return n==n?e?n-e:n:0}function d(t){if("number"==typeof t)return t;if(j(t))return r;if(v(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=v(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(u,"");var e=i.test(t);return e||c.test(t)?p(t.slice(2),e?2:8):f.test(t)?r:+t}module.exports=l;
},{}],"IQzl":[function(require,module,exports) {
var e=require("./lib/timespan"),r=require("./lib/psSupported"),i=require("jws"),n=require("lodash.includes"),o=require("lodash.isboolean"),a=require("lodash.isinteger"),s=require("lodash.isnumber"),t=require("lodash.isplainobject"),d=require("lodash.isstring"),u=require("lodash.once"),l=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];r&&l.splice(3,0,"PS256","PS384","PS512");var f={expiresIn:{isValid:function(e){return a(e)||d(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return a(e)||d(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return d(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:n.bind(null,l),message:'"algorithm" must be a valid string enum value'},header:{isValid:t,message:'"header" must be an object'},encoding:{isValid:d,message:'"encoding" must be a string'},issuer:{isValid:d,message:'"issuer" must be a string'},subject:{isValid:d,message:'"subject" must be a string'},jwtid:{isValid:d,message:'"jwtid" must be a string'},noTimestamp:{isValid:o,message:'"noTimestamp" must be a boolean'},keyid:{isValid:d,message:'"keyid" must be a string'},mutatePayload:{isValid:o,message:'"mutatePayload" must be a boolean'}},p={iat:{isValid:s,message:'"iat" should be a number of seconds'},exp:{isValid:s,message:'"exp" should be a number of seconds'},nbf:{isValid:s,message:'"nbf" should be a number of seconds'}};function c(e,r,i,n){if(!t(i))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(i).forEach(function(o){var a=e[o];if(a){if(!a.isValid(i[o]))throw new Error(a.message)}else if(!r)throw new Error('"'+o+'" is not allowed in "'+n+'"')})}function m(e){return c(f,!1,e,"options")}function b(e){return c(p,!0,e,"payload")}var g={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},h=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];module.exports=function(r,n,o,a){"function"==typeof o?(a=o,o={}):o=o||{};var s="object"==typeof r&&!Buffer.isBuffer(r),t=Object.assign({alg:o.algorithm||"HS256",typ:s?"JWT":void 0,kid:o.keyid},o.header);function d(e){if(a)return a(e);throw e}if(!n&&"none"!==o.algorithm)return d(new Error("secretOrPrivateKey must have a value"));if(void 0===r)return d(new Error("payload is required"));if(s){try{b(r)}catch(c){return d(c)}o.mutatePayload||(r=Object.assign({},r))}else{var l=h.filter(function(e){return void 0!==o[e]});if(l.length>0)return d(new Error("invalid "+l.join(",")+" option for "+typeof r+" payload"))}if(void 0!==r.exp&&void 0!==o.expiresIn)return d(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==r.nbf&&void 0!==o.notBefore)return d(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{m(o)}catch(c){return d(c)}var f=r.iat||Math.floor(Date.now()/1e3);if(o.noTimestamp?delete r.iat:s&&(r.iat=f),void 0!==o.notBefore){try{r.nbf=e(o.notBefore,f)}catch(y){return d(y)}if(void 0===r.nbf)return d(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==o.expiresIn&&"object"==typeof r){try{r.exp=e(o.expiresIn,f)}catch(y){return d(y)}if(void 0===r.exp)return d(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(g).forEach(function(e){var i=g[e];if(void 0!==o[e]){if(void 0!==r[i])return d(new Error('Bad "options.'+e+'" option. The payload already has an "'+i+'" property.'));r[i]=o[e]}});var p=o.encoding||"utf8";if("function"!=typeof a)return i.sign({header:t,payload:r,secret:n,encoding:p});a=a&&u(a),i.createSign({header:t,privateKey:n,payload:r,encoding:p}).once("error",a).once("done",function(e){a(null,e)})};
},{"./lib/timespan":"BVtP","./lib/psSupported":"GCxj","jws":"kAAO","lodash.includes":"R8Ln","lodash.isboolean":"fb6B","lodash.isinteger":"pN6T","lodash.isnumber":"IN1P","lodash.isplainobject":"hT6N","lodash.isstring":"eMen","lodash.once":"Lf7l"}],"JDSz":[function(require,module,exports) {
module.exports={decode:require("./decode"),verify:require("./verify"),sign:require("./sign"),JsonWebTokenError:require("./lib/JsonWebTokenError"),NotBeforeError:require("./lib/NotBeforeError"),TokenExpiredError:require("./lib/TokenExpiredError")};
},{"./decode":"smfd","./verify":"nva4","./sign":"IQzl","./lib/JsonWebTokenError":"Sgmk","./lib/NotBeforeError":"INvn","./lib/TokenExpiredError":"lLu7"}],"Kest":[function(require,module,exports) {
function e(e){function n(e){let r,s,o,a=null;function l(...e){if(!l.enabled)return;const t=l,s=Number(new Date),o=s-(r||s);t.diff=o,t.prev=r,t.curr=s,r=s,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,s)=>{if("%%"===r)return"%";a++;const o=n.formatters[s];if("function"==typeof o){const n=e[a];r=o.call(t,n),e.splice(a,1),a--}return r}),n.formatArgs.call(t,e),(t.log||n.log).apply(t,e)}return l.namespace=e,l.useColors=n.useColors(),l.color=n.selectColor(e),l.extend=t,l.destroy=n.destroy,Object.defineProperty(l,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(s!==n.namespaces&&(s=n.namespaces,o=n.enabled(e)),o),set:e=>{a=e}}),"function"==typeof n.init&&n.init(l),l}function t(e,t){const r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},n.disable=function(){const e=[...n.names.map(r),...n.skips.map(r).map(e=>"-"+e)].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.namespaces=e,n.names=[],n.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),s=r.length;for(t=0;t<s;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=require("ms"),n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(t=>{n[t]=e[t]}),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return n.colors[Math.abs(t)%n.colors.length]},n.enable(n.load()),n}module.exports=e;
},{"ms":"IAgR"}],"jcLW":[function(require,module,exports) {
function e(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;e.splice(1,0,o,"color: inherit");let t=0,C=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(t++,"%c"===e&&(C=t))}),e.splice(C,0,o)}function t(e){try{e?exports.storage.setItem("debug",e):exports.storage.removeItem("debug")}catch(o){}}function C(){let e;try{e=exports.storage.getItem("debug")}catch(o){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}function n(){try{return localStorage}catch(e){}}exports.formatArgs=o,exports.save=t,exports.load=C,exports.useColors=e,exports.storage=n(),exports.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],exports.log=console.debug||console.log||(()=>{}),module.exports=require("./common")(exports);const{formatters:r}=module.exports;r.j=function(e){try{return JSON.stringify(e)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}};
},{"./common":"Kest"}],"IvCc":[function(require,module,exports) {
"use strict";module.exports=((t,e)=>{e=e||process.argv;const s=t.startsWith("-")?"":1===t.length?"-":"--",r=e.indexOf(s+t),n=e.indexOf("--");return-1!==r&&(-1===n||r<n)});
},{}],"DYmO":[function(require,module,exports) {
"use strict";const r=require("os"),e=require("has-flag"),o=process.env;let s;function t(r){return 0!==r&&{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function n(t){if(!1===s)return 0;if(e("color=16m")||e("color=full")||e("color=truecolor"))return 3;if(e("color=256"))return 2;if(t&&!t.isTTY&&!0!==s)return 0;const n=s?1:0;if("win32"===process.platform){const e=r.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in o)||"codeship"===o.CI_NAME?1:n;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const r=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)?1:"COLORTERM"in o?1:(o.TERM,n)}function i(r){return t(n(r))}e("no-color")||e("no-colors")||e("color=false")?s=!1:(e("color")||e("colors")||e("color=true")||e("color=always"))&&(s=!0),"FORCE_COLOR"in o&&(s=0===o.FORCE_COLOR.length||0!==parseInt(o.FORCE_COLOR,10)),module.exports={supportsColor:i,stdout:i(process.stdout),stderr:i(process.stderr)};
},{"has-flag":"IvCc"}],"WM4h":[function(require,module,exports) {
const e=require("tty"),t=require("util");exports.init=c,exports.log=n,exports.formatArgs=o,exports.save=p,exports.load=i,exports.useColors=s,exports.destroy=t.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),exports.colors=[6,2,3,4,5,1];try{const e=require("supports-color");e&&(e.stderr||e).level>=2&&(exports.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(u){}function s(){return"colors"in exports.inspectOpts?Boolean(exports.inspectOpts.colors):e.isatty(process.stderr.fd)}function o(e){const{namespace:t,useColors:s}=this;if(s){const s=this.color,o="[3"+(s<8?s:"8;5;"+s),r=`  ${o};1m${t} [0m`;e[0]=r+e[0].split("\n").join("\n"+r),e.push(o+"m+"+module.exports.humanize(this.diff)+"[0m")}else e[0]=r()+t+" "+e[0]}function r(){return exports.inspectOpts.hideDate?"":(new Date).toISOString()+" "}function n(...e){return process.stderr.write(t.format(...e)+"\n")}function p(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function i(){return process.env.DEBUG}function c(e){e.inspectOpts={};const t=Object.keys(exports.inspectOpts);for(let s=0;s<t.length;s++)e.inspectOpts[t[s]]=exports.inspectOpts[t[s]]}exports.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{const s=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase());let o=process.env[t];return o=!!/^(yes|on|true|enabled)$/i.test(o)||!/^(no|off|false|disabled)$/i.test(o)&&("null"===o?null:Number(o)),e[s]=o,e},{}),module.exports=require("./common")(exports);const{formatters:l}=module.exports;l.o=function(e){return this.inspectOpts.colors=this.useColors,t.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},l.O=function(e){return this.inspectOpts.colors=this.useColors,t.inspect(e,this.inspectOpts)};
},{"supports-color":"DYmO","./common":"Kest"}],"NLT6":[function(require,module,exports) {
"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?module.exports=require("./browser.js"):module.exports=require("./node.js");
},{"./browser.js":"jcLW","./node.js":"WM4h"}],"xufk":[function(require,module,exports) {
module.exports.KEYOBJECT=Symbol("KEYOBJECT"),module.exports.PRIVATE_MEMBERS=Symbol("PRIVATE_MEMBERS"),module.exports.PUBLIC_MEMBERS=Symbol("PUBLIC_MEMBERS"),module.exports.THUMBPRINT_MATERIAL=Symbol("THUMBPRINT_MATERIAL"),module.exports.JWK_MEMBERS=Symbol("JWK_MEMBERS"),module.exports.KEY_MANAGEMENT_ENCRYPT=Symbol("KEY_MANAGEMENT_ENCRYPT"),module.exports.KEY_MANAGEMENT_DECRYPT=Symbol("KEY_MANAGEMENT_DECRYPT");const e={sig:new Set(["sign","verify"]),enc:new Set(["encrypt","decrypt","wrapKey","unwrapKey","deriveKey"])},E=new Set([...e.sig,...e.enc]),o=new Set(Object.keys(e));module.exports.USES_MAPPING=e,module.exports.OPS=E,module.exports.USES=o;
},{}],"I5NC":[function(require,module,exports) {
const{getCurves:e}=require("crypto"),d=new Set;e().includes("prime256v1")&&d.add("P-256"),e().includes("secp256k1")&&d.add("secp256k1"),e().includes("secp384r1")&&d.add("P-384"),e().includes("secp521r1")&&d.add("P-521"),module.exports=d;
},{}],"IQaJ":[function(require,module,exports) {
module.exports=new Map([["A128CBC-HS256",128],["A128GCM",96],["A128GCMKW",96],["A192CBC-HS384",128],["A192GCM",96],["A192GCMKW",96],["A256CBC-HS512",128],["A256GCM",96],["A256GCMKW",96]]);
},{}],"SM5v":[function(require,module,exports) {
module.exports={sign:new Map,verify:new Map,keyManagementEncrypt:new Map,keyManagementDecrypt:new Map,encrypt:new Map,decrypt:new Map};
},{}],"Xfs8":[function(require,module,exports) {
module.exports={oct:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},EC:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},RSA:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},OKP:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}}};
},{}],"sMZm":[function(require,module,exports) {
module.exports=new Map([["A128CBC-HS256",256],["A128GCM",128],["A192CBC-HS384",384],["A192GCM",192],["A256CBC-HS512",512],["A256GCM",256]]);
},{}],"xooC":[function(require,module,exports) {
const d=new Set(["Ed25519"]);"electron"in process.versions||(d.add("Ed448"),d.add("X25519"),d.add("X448")),module.exports=d;
},{}],"Ls01":[function(require,module,exports) {
module.exports=new Map;
},{}],"Hjk2":[function(require,module,exports) {
const e=require("./ec_curves"),r=require("./iv_lengths"),u=require("./jwa"),E=require("./jwk"),_=require("./key_lengths"),i=require("./okp_curves"),q=require("./ecdh_derive_lengths");module.exports={EC_CURVES:e,ECDH_DERIVE_LENGTHS:q,IVLENGTHS:r,JWA:u,JWK:E,KEYLENGTHS:_,OKP_CURVES:i};
},{"./ec_curves":"I5NC","./iv_lengths":"IQaJ","./jwa":"SM5v","./jwk":"Xfs8","./key_lengths":"sMZm","./okp_curves":"xooC","./ecdh_derive_lengths":"Ls01"}],"ZWaW":[function(require,module,exports) {
const{randomBytes:e}=require("crypto"),{IVLENGTHS:r}=require("../registry");module.exports=(t=>e(r.get(t)/8));
},{"../registry":"Hjk2"}],"xoPC":[function(require,module,exports) {
let e,r;if(Buffer.isEncoding("base64url"))e=((e,r="utf8")=>Buffer.from(e,r).toString("base64url")),r=(e=>e.toString("base64url"));else{const t=e=>e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");e=((e,r="utf8")=>t(Buffer.from(e,r).toString("base64"))),r=(e=>t(e.toString("base64")))}const t=e=>Buffer.from(e,"base64"),o=(e,r="utf8")=>t(e).toString(r),n={encode:r=>e(JSON.stringify(r)),decode:(e,r="utf8")=>JSON.parse(o(e,r))};n.decode.try=((e,r="utf8")=>{try{return n.decode(e,r)}catch(t){return o(e,r)}});const f=e=>{let r=BigInt(e).toString(16);r.length%2&&(r=`0${r}`);const t=r.length/2,o=new Uint8Array(t);let n=0,f=0;for(;n<t;)o[n]=parseInt(r.slice(f,f+2),16),n+=1,f+=2;return o},u=e=>r(Buffer.from(f(e)));module.exports.decode=o,module.exports.decodeToBuffer=t,module.exports.encode=e,module.exports.encodeBuffer=r,module.exports.JSON=n,module.exports.encodeBigInt=u;
},{}],"aYsl":[function(require,module,exports) {
const e={JOSEAlgNotWhitelisted:"ERR_JOSE_ALG_NOT_WHITELISTED",JOSECritNotUnderstood:"ERR_JOSE_CRIT_NOT_UNDERSTOOD",JOSEInvalidEncoding:"ERR_JOSE_INVALID_ENCODING",JOSEMultiError:"ERR_JOSE_MULTIPLE_ERRORS",JOSENotSupported:"ERR_JOSE_NOT_SUPPORTED",JWEDecryptionFailed:"ERR_JWE_DECRYPTION_FAILED",JWEInvalid:"ERR_JWE_INVALID",JWKImportFailed:"ERR_JWK_IMPORT_FAILED",JWKInvalid:"ERR_JWK_INVALID",JWKKeySupport:"ERR_JWK_KEY_SUPPORT",JWKSNoMatchingKey:"ERR_JWKS_NO_MATCHING_KEY",JWSInvalid:"ERR_JWS_INVALID",JWSVerificationFailed:"ERR_JWS_VERIFICATION_FAILED",JWTClaimInvalid:"ERR_JWT_CLAIM_INVALID",JWTExpired:"ERR_JWT_EXPIRED",JWTMalformed:"ERR_JWT_MALFORMED"},t={JWEDecryptionFailed:"decryption operation failed",JWEInvalid:"JWE invalid",JWKSNoMatchingKey:"no matching key found in the KeyStore",JWSInvalid:"JWS invalid",JWSVerificationFailed:"signature verification failed"};class s extends Error{constructor(s){super(s),void 0===s&&(this.message=t[this.constructor.name]),this.name=this.constructor.name,this.code=e[this.constructor.name],Error.captureStackTrace(this,this.constructor)}}const o=e=>e instanceof r;class r extends s{constructor(e){let t;for(super();(t=e.findIndex(o))&&-1!==t;)e.splice(t,1,...e[t]);Object.defineProperty(this,"errors",{value:e})}*[Symbol.iterator](){for(const e of this.errors)yield e}}module.exports.JOSEError=s,module.exports.JOSEAlgNotWhitelisted=class extends s{},module.exports.JOSECritNotUnderstood=class extends s{},module.exports.JOSEInvalidEncoding=class extends s{},module.exports.JOSEMultiError=r,module.exports.JOSENotSupported=class extends s{},module.exports.JWEDecryptionFailed=class extends s{},module.exports.JWEInvalid=class extends s{},module.exports.JWKImportFailed=class extends s{},module.exports.JWKInvalid=class extends s{},module.exports.JWKKeySupport=class extends s{},module.exports.JWKSNoMatchingKey=class extends s{},module.exports.JWSInvalid=class extends s{},module.exports.JWSVerificationFailed=class extends s{};class i extends s{constructor(e,t="unspecified",s="unspecified"){super(e),this.claim=t,this.reason=s}}module.exports.JWTClaimInvalid=i,module.exports.JWTExpired=class extends i{},module.exports.JWTMalformed=class extends s{};
},{}],"JzdI":[function(require,module,exports) {
const{diffieHellman:e,KeyObject:p,sign:r,verify:o}=require("crypto"),[s,t]=process.version.substr(1).split(".").map(e=>parseInt(e,10));module.exports={oaepHashSupported:s>12||12===s&&t>=9,keyObjectSupported:!!p&&s>=12,edDSASupported:!!r&&!!o,dsaEncodingSupported:s>13||13===s&&t>=2||12===s&&t>=16,improvedDH:!!e};
},{}],"KEHe":[function(require,module,exports) {
module.exports=(o=>!!o&&o.constructor===Object);
},{}],"RcFl":[function(require,module,exports) {
const{inherits:t}=require("util");function r(t){this._reporterState={obj:null,path:[],options:t||{},errors:[]}}function e(t,r){this.path=t,this.rethrow(r)}r.prototype.isError=function(t){return t instanceof e},r.prototype.save=function(){const t=this._reporterState;return{obj:t.obj,pathLen:t.path.length}},r.prototype.restore=function(t){const r=this._reporterState;r.obj=t.obj,r.path=r.path.slice(0,t.pathLen)},r.prototype.enterKey=function(t){return this._reporterState.path.push(t)},r.prototype.exitKey=function(t){const r=this._reporterState;r.path=r.path.slice(0,t-1)},r.prototype.leaveKey=function(t,r,e){const o=this._reporterState;this.exitKey(t),null!==o.obj&&(o.obj[r]=e)},r.prototype.path=function(){return this._reporterState.path.join("/")},r.prototype.enterObject=function(){const t=this._reporterState,r=t.obj;return t.obj={},r},r.prototype.leaveObject=function(t){const r=this._reporterState,e=r.obj;return r.obj=t,e},r.prototype.error=function(t){let r;const o=this._reporterState,n=t instanceof e;if(r=n?t:new e(o.path.map(function(t){return`[${JSON.stringify(t)}]`}).join(""),t.message||t,t.stack),!o.options.partial)throw r;return n||o.errors.push(r),r},r.prototype.wrapResult=function(t){const r=this._reporterState;return r.options.partial?{result:this.isError(t)?null:t,errors:r.errors}:t},t(e,Error),e.prototype.rethrow=function(t){if(this.message=`${t} at: ${this.path||"(shallow)"}`,Error.captureStackTrace&&Error.captureStackTrace(this,e),!this.stack)try{throw new Error(this.message)}catch(r){this.stack=r.stack}return this},exports.Reporter=r;
},{}],"j9fu":[function(require,module,exports) {
const{inherits:e}=require("util"),{Reporter:t}=require("../base/reporter");function r(e,r){t.call(this,r),Buffer.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function f(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return f.isEncoderBuffer(e)||(e=new f(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(e>=0&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=Buffer.byteLength(e);else{if(!Buffer.isBuffer(e))return t.error(`Unsupported type: ${typeof e}`);this.value=e,this.length=e.length}}e(r,t),r.isDecoderBuffer=function(e){if(e instanceof r)return!0;return"object"==typeof e&&Buffer.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"==typeof e.offset&&"number"==typeof e.length&&"function"==typeof e.save&&"function"==typeof e.restore&&"function"==typeof e.isEmpty&&"function"==typeof e.readUInt8&&"function"==typeof e.skip&&"function"==typeof e.raw},r.prototype.save=function(){return{offset:this.offset,reporter:t.prototype.save.call(this)}},r.prototype.restore=function(e){const f=new r(this.base);return f.offset=e.offset,f.length=this.offset,this.offset=e.offset,t.prototype.restore.call(this,e.reporter),f},r.prototype.isEmpty=function(){return this.offset===this.length},r.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},r.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");const f=new r(this.base);return f._reporterState=this._reporterState,f.offset=this.offset,f.length=this.offset+e,this.offset+=e,f},r.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},f.isEncoderBuffer=function(e){if(e instanceof f)return!0;return"object"==typeof e&&"EncoderBuffer"===e.constructor.name&&"number"==typeof e.length&&"function"==typeof e.join},f.prototype.join=function(e,t){return e||(e=Buffer.alloc(this.length)),t||(t=0),0===this.length?e:(Array.isArray(this.value)?this.value.forEach(function(r){r.join(e,t),t+=r.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):Buffer.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length),e)},module.exports={DecoderBuffer:r,EncoderBuffer:f};
},{"../base/reporter":"RcFl"}],"cNQd":[function(require,module,exports) {
const{strict:e}=require("assert"),{Reporter:t}=require("../base/reporter"),{DecoderBuffer:n,EncoderBuffer:o}=require("../base/buffer"),i=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],r=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(i),s=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function c(e,t,n){const o={};this._baseState=o,o.name=n,o.enc=e,o.parent=t||null,o.children=null,o.tag=null,o.args=null,o.reverseArgs=null,o.choice=null,o.optional=!1,o.any=!1,o.obj=!1,o.use=null,o.useDecoder=null,o.key=null,o.default=null,o.explicit=null,o.implicit=null,o.contains=null,o.parent||(o.children=[],this._wrap())}const l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];c.prototype.clone=function(){const e=this._baseState,t={};l.forEach(function(n){t[n]=e[n]});const n=new this.constructor(t.parent);return n._baseState=t,n},c.prototype._wrap=function(){const e=this._baseState;r.forEach(function(t){this[t]=function(){const n=new this.constructor(this);return e.children.push(n),n[t].apply(n,arguments)}},this)},c.prototype._init=function(t){const n=this._baseState;e(null===n.parent),t.call(this),n.children=n.children.filter(function(e){return e._baseState.parent===this},this),e.equal(n.children.length,1,"Root node can have only one child")},c.prototype._useArgs=function(t){const n=this._baseState,o=t.filter(function(e){return e instanceof this.constructor},this);t=t.filter(function(e){return!(e instanceof this.constructor)},this),0!==o.length&&(e(null===n.children),n.children=o,o.forEach(function(e){e._baseState.parent=this},this)),0!==t.length&&(e(null===n.args),n.args=t,n.reverseArgs=t.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;const t={};return Object.keys(e).forEach(function(n){n==(0|n)&&(n|=0);const o=e[n];t[o]=n}),t}))},s.forEach(function(e){c.prototype[e]=function(){const t=this._baseState;throw new Error(`${e} not implemented for encoding: ${t.enc}`)}}),i.forEach(function(t){c.prototype[t]=function(){const n=this._baseState,o=Array.prototype.slice.call(arguments);return e(null===n.tag),n.tag=t,this._useArgs(o),this}}),c.prototype.use=function(t){e(t);const n=this._baseState;return e(null===n.use),n.use=t,this},c.prototype.optional=function(){return this._baseState.optional=!0,this},c.prototype.def=function(t){const n=this._baseState;return e(null===n.default),n.default=t,n.optional=!0,this},c.prototype.explicit=function(t){const n=this._baseState;return e(null===n.explicit&&null===n.implicit),n.explicit=t,this},c.prototype.implicit=function(t){const n=this._baseState;return e(null===n.explicit&&null===n.implicit),n.implicit=t,this},c.prototype.obj=function(){const e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},c.prototype.key=function(t){const n=this._baseState;return e(null===n.key),n.key=t,this},c.prototype.any=function(){return this._baseState.any=!0,this},c.prototype.choice=function(t){const n=this._baseState;return e(null===n.choice),n.choice=t,this._useArgs(Object.keys(t).map(function(e){return t[e]})),this},c.prototype.contains=function(t){const n=this._baseState;return e(null===n.use),n.contains=t,this},c.prototype._decode=function(e,t){const o=this._baseState;if(null===o.parent)return e.wrapResult(o.children[0]._decode(e,t));let i,r=o.default,s=!0,c=null;if(null!==o.key&&(c=e.enterKey(o.key)),o.optional){let n=null;if(null!==o.explicit?n=o.explicit:null!==o.implicit?n=o.implicit:null!==o.tag&&(n=o.tag),null!==n||o.any){if(s=this._peekTag(e,n,o.any),e.isError(s))return s}else{const n=e.save();try{null===o.choice?this._decodeGeneric(o.tag,e,t):this._decodeChoice(e,t),s=!0}catch(l){s=!1}e.restore(n)}}if(o.obj&&s&&(i=e.enterObject()),s){if(null!==o.explicit){const t=this._decodeTag(e,o.explicit);if(e.isError(t))return t;e=t}const i=e.offset;if(null===o.use&&null===o.choice){let t;o.any&&(t=e.save());const n=this._decodeTag(e,null!==o.implicit?o.implicit:o.tag,o.any);if(e.isError(n))return n;o.any?r=e.raw(t):e=n}if(t&&t.track&&null!==o.tag&&t.track(e.path(),i,e.length,"tagged"),t&&t.track&&null!==o.tag&&t.track(e.path(),e.offset,e.length,"content"),o.any||(r=null===o.choice?this._decodeGeneric(o.tag,e,t):this._decodeChoice(e,t)),e.isError(r))return r;if(o.any||null!==o.choice||null===o.children||o.children.forEach(function(n){n._decode(e,t)}),o.contains&&("octstr"===o.tag||"bitstr"===o.tag)){const i=new n(r);r=this._getUse(o.contains,e._reporterState.obj)._decode(i,t)}}return o.obj&&s&&(r=e.leaveObject(i)),null===o.key||null===r&&!0!==s?null!==c&&e.exitKey(c):e.leaveKey(c,o.key,r),r},c.prototype._decodeGeneric=function(e,t,n){const o=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,o.args[0],n):/str$/.test(e)?this._decodeStr(t,e,n):"objid"===e&&o.args?this._decodeObjid(t,o.args[0],o.args[1],n):"objid"===e?this._decodeObjid(t,null,null,n):"gentime"===e||"utctime"===e?this._decodeTime(t,e,n):"null_"===e?this._decodeNull(t,n):"bool"===e?this._decodeBool(t,n):"objDesc"===e?this._decodeStr(t,e,n):"int"===e||"enum"===e?this._decodeInt(t,o.args&&o.args[0],n):null!==o.use?this._getUse(o.use,t._reporterState.obj)._decode(t,n):t.error(`unknown tag: ${e}`)},c.prototype._getUse=function(t,n){const o=this._baseState;return o.useDecoder=this._use(t,n),e(null===o.useDecoder._baseState.parent),o.useDecoder=o.useDecoder._baseState.children[0],o.implicit!==o.useDecoder._baseState.implicit&&(o.useDecoder=o.useDecoder.clone(),o.useDecoder._baseState.implicit=o.implicit),o.useDecoder},c.prototype._decodeChoice=function(e,t){const n=this._baseState;let o=null,i=!1;return Object.keys(n.choice).some(function(r){const s=e.save(),c=n.choice[r];try{const n=c._decode(e,t);if(e.isError(n))return!1;o={type:r,value:n},i=!0}catch(l){return e.restore(s),!1}return!0},this),i?o:e.error("Choice not matched")},c.prototype._createEncoderBuffer=function(e){return new o(e,this.reporter)},c.prototype._encode=function(e,t,n){const o=this._baseState;if(null!==o.default&&o.default===e)return;const i=this._encodeValue(e,t,n);return void 0===i||this._skipDefault(i,t,n)?void 0:i},c.prototype._encodeValue=function(e,n,o){const i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,n||new t);let r=null;if(this.reporter=n,i.optional&&void 0===e){if(null===i.default)return;e=i.default}let s=null,c=!1;if(i.any)r=this._createEncoderBuffer(e);else if(i.choice)r=this._encodeChoice(e,n);else if(i.contains)s=this._getUse(i.contains,o)._encode(e,n),c=!0;else if(i.children)s=i.children.map(function(t){if("null_"===t._baseState.tag)return t._encode(null,n,e);if(null===t._baseState.key)return n.error("Child should have a key");const o=n.enterKey(t._baseState.key);if("object"!=typeof e)return n.error("Child expected, but input is not object");const i=t._encode(e[t._baseState.key],n,e);return n.leaveKey(o),i},this).filter(function(e){return e}),s=this._createEncoderBuffer(s);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return n.error(`Too many args for: ${i.tag}`);if(!Array.isArray(e))return n.error("seqof/setof, but data is not Array");const t=this.clone();t._baseState.implicit=null,s=this._createEncoderBuffer(e.map(function(t){const o=this._baseState;return this._getUse(o.args[0],e)._encode(t,n)},t))}else null!==i.use?r=this._getUse(i.use,o)._encode(e,n):(s=this._encodePrimitive(i.tag,e),c=!0);if(!i.any&&null===i.choice){const e=null!==i.implicit?i.implicit:i.tag,t=null===i.implicit?"universal":"context";null===e?null===i.use&&n.error("Tag could be omitted only for .use()"):null===i.use&&(r=this._encodeComposite(e,c,t,s))}return null!==i.explicit&&(r=this._encodeComposite(i.explicit,!1,"context",r)),r},c.prototype._encodeChoice=function(t,n){const o=this._baseState,i=o.choice[t.type];return i||e(!1,`${t.type} not found in ${JSON.stringify(Object.keys(o.choice))}`),i._encode(t.value,n)},c.prototype._encodePrimitive=function(e,t){const n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,n.args&&n.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error(`Unsupported tag: ${e}`)},c.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},c.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)},module.exports=c;
},{"../base/reporter":"RcFl","../base/buffer":"j9fu"}],"XI5R":[function(require,module,exports) {
function t(t){const s={};return Object.keys(t).forEach(function(e){(0|e)==e&&(e|=0);const r=t[e];s[r]=e}),s}exports.tagClass={0:"universal",1:"application",2:"context",3:"private"},exports.tagClassByName=t(exports.tagClass),exports.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},exports.tagByName=t(exports.tag);
},{}],"nunF":[function(require,module,exports) {
const{inherits:e}=require("util"),t=require("../base/node"),r=require("../constants/der");function n(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new o,this.tree._init(e.body)}function o(e){t.call(this,"der",e)}function i(e){return e<10?`0${e}`:e}function s(e){var t=BigInt(e).toString(16);t.length%2&&(t="0"+t);for(var r=t.length/2,n=new Uint8Array(r),o=0,i=0;o<r;)n[o]=parseInt(t.slice(i,i+2),16),o+=1,i+=2;return n}function f(e,t,n,o){let i;if("seqof"===e?e="seq":"setof"===e&&(e="set"),Object.prototype.hasOwnProperty.call(r.tagByName,e))i=r.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return o.error(`Unknown tag: ${e}`);i=e}return i>=31?o.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=r.tagClassByName[n||"universal"]<<6)}n.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},e(o,t),o.prototype._encodeComposite=function(e,t,r,n){const o=f(e,t,r,this.reporter);if(n.length<128){const e=Buffer.alloc(2);return e[0]=o,e[1]=n.length,this._createEncoderBuffer([e,n])}let i=1;for(let f=n.length;f>=256;f>>=8)i++;const s=Buffer.alloc(2+i);s[0]=o,s[1]=128|i;for(let f=1+i,u=n.length;u>0;f--,u>>=8)s[f]=255&u;return this._createEncoderBuffer([s,n])},o.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){const t=Buffer.alloc(2*e.length);for(let r=0;r<e.length;r++)t.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)?this._createEncoderBuffer(e):"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error(`Encoding of string type: ${t} unsupported`)},o.prototype._encodeObjid=function(e,t,r){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!Object.prototype.hasOwnProperty.call(t,e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error(`objid() should be either array or string, got: ${JSON.stringify(e)}`);if(!r){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let n=0;for(let s=0;s<e.length;s++){let t=e[s];for(n++;t>=128;t>>=7)n++}const o=Buffer.alloc(n);let i=o.length-1;for(let s=e.length-1;s>=0;s--){let t=e[s];for(o[i--]=127&t;(t>>=7)>0;)o[i--]=128|127&t}return this._createEncoderBuffer(o)},o.prototype._encodeTime=function(e,t){let r;const n=new Date(e);return"gentime"===t?r=[i(n.getUTCFullYear()),i(n.getUTCMonth()+1),i(n.getUTCDate()),i(n.getUTCHours()),i(n.getUTCMinutes()),i(n.getUTCSeconds()),"Z"].join(""):"utctime"===t?r=[i(n.getUTCFullYear()%100),i(n.getUTCMonth()+1),i(n.getUTCDate()),i(n.getUTCHours()),i(n.getUTCMinutes()),i(n.getUTCSeconds()),"Z"].join(""):this.reporter.error(`Encoding ${t} time is not supported yet`),this._encodeStr(r,"octstr")},o.prototype._encodeNull=function(){return this._createEncoderBuffer("")},o.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!Object.prototype.hasOwnProperty.call(t,e))return this.reporter.error(`Values map doesn't contain: ${JSON.stringify(e)}`);e=t[e]}if("bigint"==typeof e){const t=[...s(e)];128&t[0]&&t.unshift(0),e=Buffer.from(t)}if(Buffer.isBuffer(e)){let t=e.length;0===e.length&&t++;const r=Buffer.alloc(t);return e.copy(r),0===e.length&&(r[0]=0),this._createEncoderBuffer(r)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let r=1;for(let o=e;o>=256;o>>=8)r++;const n=new Array(r);for(let o=n.length-1;o>=0;o--)n[o]=255&e,e>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(Buffer.from(n))},o.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},o.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},o.prototype._skipDefault=function(e,t,r){const n=this._baseState;let o;if(null===n.default)return!1;const i=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n.default,t,r).join()),i.length!==n.defaultBuffer.length)return!1;for(o=0;o<i.length;o++)if(i[o]!==n.defaultBuffer[o])return!1;return!0},module.exports=n;
},{"../base/node":"cNQd","../constants/der":"XI5R"}],"MUfU":[function(require,module,exports) {
const{inherits:e}=require("util"),t=require("./der");function n(e){t.call(this,e),this.enc="pem"}e(n,t),n.prototype.encode=function(e,n){const o=t.prototype.encode.call(this,e).toString("base64"),i=[`-----BEGIN ${n.label}-----`];for(let t=0;t<o.length;t+=64)i.push(o.slice(t,t+64));return i.push(`-----END ${n.label}-----`),i.join("\n")},module.exports=n;
},{"./der":"nunF"}],"uy9T":[function(require,module,exports) {
module.exports={der:require("./der"),pem:require("./pem")};
},{"./der":"nunF","./pem":"MUfU"}],"TtPa":[function(require,module,exports) {
const{inherits:t}=require("util"),{DecoderBuffer:r}=require("../base/buffer"),e=require("../base/node"),i=require("../constants/der");function o(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new n,this.tree._init(t.body)}function n(t){e.call(this,"der",t)}function s(t,r){let e=t.readUInt8(r);if(t.isError(e))return e;const o=i.tagClass[e>>6],n=0==(32&e);if(31==(31&e)){let i=e;for(e=0;128==(128&i);){if(i=t.readUInt8(r),t.isError(i))return i;e<<=7,e|=127&i}}else e&=31;return{cls:o,primitive:n,tag:e,tagStr:i.tag[e]}}function c(t,r,e){let i=t.readUInt8(e);if(t.isError(i))return i;if(!r&&128===i)return null;if(0==(128&i))return i;const o=127&i;if(o>4)return t.error("length octect is too long");i=0;for(let n=0;n<o;n++){i<<=8;const r=t.readUInt8(e);if(t.isError(r))return r;i|=r}return i}o.prototype.decode=function(t,e){return r.isDecoderBuffer(t)||(t=new r(t,e)),this.tree._decode(t,e)},t(n,e),n.prototype._peekTag=function(t,r,e){if(t.isEmpty())return!1;const i=t.save(),o=s(t,`Failed to peek tag: "${r}"`);return t.isError(o)?o:(t.restore(i),o.tag===r||o.tagStr===r||o.tagStr+"of"===r||e)},n.prototype._decodeTag=function(t,r,e){const i=s(t,`Failed to decode tag of "${r}"`);if(t.isError(i))return i;let o=c(t,i.primitive,`Failed to get length of "${r}"`);if(t.isError(o))return o;if(!e&&i.tag!==r&&i.tagStr!==r&&i.tagStr+"of"!==r)return t.error(`Failed to match tag: "${r}"`);if(i.primitive||null!==o)return t.skip(o,`Failed to match body of: "${r}"`);const n=t.save(),u=this._skipUntilEnd(t,`Failed to skip indefinite length body: "${this.tag}"`);return t.isError(u)?u:(o=t.offset-n.offset,t.restore(n),t.skip(o,`Failed to match body of: "${r}"`))},n.prototype._skipUntilEnd=function(t,r){for(;;){const e=s(t,r);if(t.isError(e))return e;const i=c(t,e.primitive,r);if(t.isError(i))return i;let o;if(o=e.primitive||null!==i?t.skip(i):this._skipUntilEnd(t,r),t.isError(o))return o;if("end"===e.tagStr)break}},n.prototype._decodeList=function(t,r,e,i){const o=[];for(;!t.isEmpty();){const r=this._peekTag(t,"end");if(t.isError(r))return r;const n=e.decode(t,"der",i);if(t.isError(n)&&r)break;o.push(n)}return o},n.prototype._decodeStr=function(t,r){if("bitstr"===r){const r=t.readUInt8();return t.isError(r)?r:{unused:r,data:t.raw()}}if("bmpstr"===r){const r=t.raw();if(r.length%2==1)return t.error("Decoding of string type: bmpstr length mismatch");let e="";for(let t=0;t<r.length/2;t++)e+=String.fromCharCode(r.readUInt16BE(2*t));return e}if("numstr"===r){const r=t.raw().toString("ascii");return this._isNumstr(r)?r:t.error("Decoding of string type: numstr unsupported characters")}if("octstr"===r)return t.raw();if("objDesc"===r)return t.raw();if("printstr"===r){const r=t.raw().toString("ascii");return this._isPrintstr(r)?r:t.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(r)?t.raw().toString():t.error(`Decoding of string type: ${r} unsupported`)},n.prototype._decodeObjid=function(t,r,e){let i;const o=[];let n=0,s=0;for(;!t.isEmpty();)n<<=7,n|=127&(s=t.readUInt8()),0==(128&s)&&(o.push(n),n=0);128&s&&o.push(n);const c=o[0]/40|0,u=o[0]%40;if(i=e?o:[c,u].concat(o.slice(1)),r){let t=r[i.join(" ")];void 0===t&&(t=r[i.join(".")]),void 0!==t&&(i=t)}return i},n.prototype._decodeTime=function(t,r){const e=t.raw().toString();let i,o,n,s,c,u;if("gentime"===r)i=0|e.slice(0,4),o=0|e.slice(4,6),n=0|e.slice(6,8),s=0|e.slice(8,10),c=0|e.slice(10,12),u=0|e.slice(12,14);else{if("utctime"!==r)return t.error(`Decoding ${r} time is not supported yet`);i=0|e.slice(0,2),o=0|e.slice(2,4),n=0|e.slice(4,6),s=0|e.slice(6,8),c=0|e.slice(8,10),u=0|e.slice(10,12),i=i<70?2e3+i:1900+i}return Date.UTC(i,o-1,n,s,c,u,0)},n.prototype._decodeNull=function(){return null},n.prototype._decodeBool=function(t){const r=t.readUInt8();return t.isError(r)?r:0!==r},n.prototype._decodeInt=function(t,r){const e=t.raw();let i=BigInt(`0x${e.toString("hex")}`);return r&&(i=r[i.toString(10)]||i),i},n.prototype._use=function(t,r){return"function"==typeof t&&(t=t(r)),t._getDecoder("der").tree},module.exports=o;
},{"../base/buffer":"j9fu","../base/node":"cNQd","../constants/der":"XI5R"}],"OgVD":[function(require,module,exports) {
const{inherits:e}=require("util"),t=require("./der");function o(e){t.call(this,e),this.enc="pem"}e(o,t),o.prototype.decode=function(e,o){const r=e.toString().split(/[\r\n]+/g),i=o.label.toUpperCase(),n=/^-----(BEGIN|END) ([^-]+)-----$/;let c=-1,l=-1;for(let t=0;t<r.length;t++){const e=r[t].match(n);if(null!==e&&e[2]===i){if(-1!==c){if("END"!==e[1])break;l=t;break}if("BEGIN"!==e[1])break;c=t}}if(-1===c||-1===l)throw new Error(`PEM section not found for: ${i}`);const s=r.slice(c+1,l).join("");s.replace(/[^a-z0-9+/=]+/gi,"");const f=Buffer.from(s,"base64");return t.prototype.decode.call(this,f,o)},module.exports=o;
},{"./der":"TtPa"}],"n3Ed":[function(require,module,exports) {
module.exports={der:require("./der"),pem:require("./pem")};
},{"./der":"TtPa","./pem":"OgVD"}],"mjDS":[function(require,module,exports) {
const{inherits:e}=require("util"),t=require("./encoders"),r=require("./decoders");function o(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}module.exports.define=function(e,t){return new o(e,t)},o.prototype._createNamed=function(t){const r=this.name;function o(e){this._initNamed(e,r)}return e(o,t),o.prototype._initNamed=function(e,r){t.call(this,e,r)},new o(this)},o.prototype._getDecoder=function(e){return e=e||"der",Object.prototype.hasOwnProperty.call(this.decoders,e)||(this.decoders[e]=this._createNamed(r[e])),this.decoders[e]},o.prototype.decode=function(e,t,r){return this._getDecoder(t).decode(e,r)},o.prototype._getEncoder=function(e){return e=e||"der",Object.prototype.hasOwnProperty.call(this.encoders,e)||(this.encoders[e]=this._createNamed(t[e])),this.encoders[e]},o.prototype.encode=function(e,t,r){return this._getEncoder(t).encode(e,r)};
},{"./encoders":"uy9T","./decoders":"n3Ed"}],"GyiK":[function(require,module,exports) {
const{Reporter:e}=require("./reporter"),{DecoderBuffer:r,EncoderBuffer:o}=require("./buffer"),f=require("./node");module.exports={DecoderBuffer:r,EncoderBuffer:o,Node:f,Reporter:e};
},{"./reporter":"RcFl","./buffer":"j9fu","./node":"cNQd"}],"aI3u":[function(require,module,exports) {
module.exports={der:require("./der")};
},{"./der":"XI5R"}],"bqoz":[function(require,module,exports) {
const{define:e}=require("./asn1/api"),s=require("./asn1/base"),r=require("./asn1/constants"),n=require("./asn1/decoders"),a=require("./asn1/encoders");module.exports={base:s,constants:r,decoders:n,define:e,encoders:a};
},{"./asn1/api":"mjDS","./asn1/base":"GyiK","./asn1/constants":"aI3u","./asn1/decoders":"n3Ed","./asn1/encoders":"uy9T"}],"E3kL":[function(require,module,exports) {
const c={"1 2 840 10045 3 1 7":"P-256","1 3 132 0 10":"secp256k1","1 3 132 0 34":"P-384","1 3 132 0 35":"P-521","1 2 840 10045 2 1":"ecPublicKey","1 2 840 113549 1 1 1":"rsaEncryption","1 3 101 110":"X25519","1 3 101 111":"X448","1 3 101 112":"Ed25519","1 3 101 113":"Ed448"};module.exports=c;
},{}],"Ua80":[function(require,module,exports) {
const i=require("./oids");module.exports=function(){this.seq().obj(this.key("algorithm").objid(i),this.key("parameters").optional().choice({namedCurve:this.objid(i),null:this.null_()}))};
},{"./oids":"E3kL"}],"AjX0":[function(require,module,exports) {
const i=require("./oids");module.exports=function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().choice({namedCurve:this.objid(i)}),this.key("publicKey").explicit(1).optional().bitstr())};
},{"./oids":"E3kL"}],"r5MF":[function(require,module,exports) {
module.exports=(t=>(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(t),this.key("privateKey").octstr())}));
},{}],"YFpQ":[function(require,module,exports) {
module.exports=(t=>(function(){this.seq().obj(this.key("algorithm").use(t),this.key("publicKey").bitstr())}));
},{}],"mJqs":[function(require,module,exports) {
module.exports=function(){this.octstr().contains().obj(this.key("privateKey").octstr())};
},{}],"hk17":[function(require,module,exports) {
module.exports=((e,i)=>(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(e),this.key("privateKey").use(i))}));
},{}],"PIm1":[function(require,module,exports) {
module.exports=function(){this.seq().obj(this.key("version").int({0:"two-prime",1:"multi"}),this.key("n").int(),this.key("e").int(),this.key("d").int(),this.key("p").int(),this.key("q").int(),this.key("dp").int(),this.key("dq").int(),this.key("qi").int())};
},{}],"HT4X":[function(require,module,exports) {
module.exports=function(){this.seq().obj(this.key("n").int(),this.key("e").int())};
},{}],"xF0l":[function(require,module,exports) {
const e=require("@panva/asn1.js"),i=new Map,r=e.define("AlgorithmIdentifier",require("./algorithm_identifier"));i.set("AlgorithmIdentifier",r);const t=e.define("ECPrivateKey",require("./ec_private_key"));i.set("ECPrivateKey",t);const n=e.define("PrivateKeyInfo",require("./private_key_info")(r));i.set("PrivateKeyInfo",n);const s=e.define("PublicKeyInfo",require("./public_key_info")(r));i.set("PublicKeyInfo",s);const y=e.define("PrivateKey",require("./private_key"));i.set("PrivateKey",y);const a=e.define("OneAsymmetricKey",require("./one_asymmetric_key")(r,y));i.set("OneAsymmetricKey",a);const o=e.define("RSAPrivateKey",require("./rsa_private_key"));i.set("RSAPrivateKey",o);const c=e.define("RSAPublicKey",require("./rsa_public_key"));i.set("RSAPublicKey",c),module.exports=i;
},{"@panva/asn1.js":"bqoz","./algorithm_identifier":"Ua80","./ec_private_key":"AjX0","./private_key_info":"r5MF","./public_key_info":"YFpQ","./private_key":"mJqs","./one_asymmetric_key":"hk17","./rsa_private_key":"PIm1","./rsa_public_key":"HT4X"}],"v3aG":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function t(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?e(Object(s),!0).forEach(function(e){r(t,e,s[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{keyObjectSupported:i}=require("./runtime_support");let s,p,o,a,n;if(i)({createPublicKey:s,createPrivateKey:p,createSecretKey:o,KeyObject:a}=require("crypto")),n=(e=>e);else{const{EOL:e}=require("os"),r=require("../errors"),i=require("./is_object"),c=require("./asn1"),y=Symbol("toInput"),u=Symbol("namedCurve");n=((e,t)=>e instanceof a?e[y](t):o(e)[y](t));const f=e=>Buffer.from(e.replace(/(?:-----(?:BEGIN|END)(?: (?:RSA|EC))? (?:PRIVATE|PUBLIC) KEY-----|\s)/g,""),"base64"),m=(t,r)=>`-----BEGIN ${r}-----${e}${(t.toString("base64").match(/.{1,64}/g)||[]).join(e)}${e}-----END ${r}-----`,l=e=>{const t="string"==typeof e?e:`OID ${e.join(".")}`;throw new r.JOSENotSupported(`${t} is not supported in your Node.js runtime version`)};a=class{export({cipher:e,passphrase:t,type:i,format:s}={}){if("secret"===this._type)return this._buffer;if("public"===this._type){if("rsa"===this.asymmetricKeyType)switch(i){case"pkcs1":return"pem"===s?this._pem:f(this._pem);case"spki":{const e=c.get("PublicKeyInfo").encode({algorithm:{algorithm:"rsaEncryption",parameters:{type:"null"}},publicKey:{unused:0,data:f(this._pem)}},"pem",{label:"PUBLIC KEY"});return"pem"===s?e:f(e)}default:throw new TypeError(`The value ${i} is invalid for option "type"`)}if("ec"===this.asymmetricKeyType){if("spki"!==i)throw new TypeError(`The value ${i} is invalid for option "type"`);return"pem"===s?this._pem:f(this._pem)}}if("private"===this._type){if(void 0!==t||void 0!==e)throw new r.JOSENotSupported("encrypted private keys are not supported in your Node.js runtime version");if("pkcs8"===i){if(this._pkcs8)return"der"===s&&"string"==typeof this._pkcs8?f(this._pkcs8):"pem"===s&&Buffer.isBuffer(this._pkcs8)?m(this._pkcs8,"PRIVATE KEY"):this._pkcs8;if("rsa"===this.asymmetricKeyType){const e=this._asn1,t=c.get("RSAPrivateKey").encode(e),r=c.get("PrivateKeyInfo").encode({version:0,privateKey:t,algorithm:{algorithm:"rsaEncryption",parameters:{type:"null"}}});return this._pkcs8=r,this.export({type:i,format:s})}if("ec"===this.asymmetricKeyType){const e=this._asn1,t=c.get("ECPrivateKey").encode({version:e.version,privateKey:e.privateKey,publicKey:e.publicKey}),r=c.get("PrivateKeyInfo").encode({version:0,privateKey:t,algorithm:{algorithm:"ecPublicKey",parameters:this._asn1.parameters}});return this._pkcs8=r,this.export({type:i,format:s})}}if("rsa"===this.asymmetricKeyType&&"pkcs1"===i)return"pem"===s?this._pem:f(this._pem);if("ec"===this.asymmetricKeyType&&"sec1"===i)return"pem"===s?this._pem:f(this._pem);throw new TypeError(`The value ${i} is invalid for option "type"`)}}get type(){return this._type}get asymmetricKeyType(){return this._asymmetricKeyType}get symmetricKeySize(){return this._symmetricKeySize}[y](e){switch(this._type){case"secret":return this._buffer;case"public":return this._pem;default:return e?("_pub"in this||(this._pub=s(this)),this._pub[y](!1)):this._pem}}},o=(e=>{if(!Buffer.isBuffer(e)||!e.length)throw new TypeError("input must be a non-empty Buffer instance");const t=new a;return t._buffer=Buffer.from(e),t._symmetricKeySize=e.length,t._type="secret",t}),s=(e=>{if(e instanceof a){if("private"!==e.type)throw new TypeError(`Invalid key object type ${e.type}, expected private.`);switch(e.asymmetricKeyType){case"ec":{const t=c.get("PublicKeyInfo").encode({algorithm:{algorithm:"ecPublicKey",parameters:e._asn1.parameters},publicKey:e._asn1.publicKey});return s({key:t,format:"der",type:"spki"})}case"rsa":{const t=c.get("RSAPublicKey").encode(e._asn1);return s({key:t,format:"der",type:"pkcs1"})}}}if(("string"==typeof e||Buffer.isBuffer(e))&&(e={key:e,format:"pem"}),!i(e))throw new TypeError("input must be a string, Buffer or an object");const{format:t,passphrase:o}=e;let n,{key:y,type:u}=e;if("string"!=typeof y&&!Buffer.isBuffer(y))throw new TypeError("key must be a string or Buffer");if("pem"!==t&&"der"!==t)throw new TypeError('format must be one of "pem" or "der"');if("pem"===t)switch((y=y.toString()).split(/\r?\n/g)[0].toString()){case"-----BEGIN PUBLIC KEY-----":u="spki",n="PUBLIC KEY";break;case"-----BEGIN RSA PUBLIC KEY-----":u="pkcs1",n="RSA PUBLIC KEY";break;case"-----BEGIN CERTIFICATE-----":throw new r.JOSENotSupported("X.509 certificates are not supported in your Node.js runtime version");case"-----BEGIN PRIVATE KEY-----":case"-----BEGIN EC PRIVATE KEY-----":case"-----BEGIN RSA PRIVATE KEY-----":return s(p(y));default:throw new TypeError("unknown/unsupported PEM type")}switch(u){case"spki":{const e=c.get("PublicKeyInfo"),r=e.decode(y,t,{label:n});let i,p;switch(r.algorithm.algorithm){case"ecPublicKey":(p=new a)._asn1=r,p._asymmetricKeyType="ec",p._type="public",p._pem=e.encode(r,"pem",{label:"PUBLIC KEY"});break;case"rsaEncryption":p=s({type:i="pkcs1",key:r.publicKey.data,format:"der"});break;default:l(r.algorithm.algorithm)}return p}case"pkcs1":{const e=c.get("RSAPublicKey"),r=e.decode(y,t,{label:n});if(r.n===BigInt(0))return s(p({key:y,format:t,type:u,passphrase:o}));const i=new a;return i._asn1=r,i._asymmetricKeyType="rsa",i._type="public",i._pem=e.encode(r,"pem",{label:"RSA PUBLIC KEY"}),i}case"pkcs8":case"sec1":return s(p({format:t,key:y,type:u,passphrase:o}));default:throw new TypeError(`The value ${u} is invalid for option "type"`)}}),p=((e,s)=>{if(("string"==typeof e||Buffer.isBuffer(e))&&(e={key:e,format:"pem"}),!i(e))throw new TypeError("input must be a string, Buffer or an object");const{format:o,passphrase:n}=e;let y,{key:f,type:m}=e;if("string"!=typeof f&&!Buffer.isBuffer(f))throw new TypeError("key must be a string or Buffer");if(void 0!==n)throw new r.JOSENotSupported("encrypted private keys are not supported in your Node.js runtime version");if("pem"!==o&&"der"!==o)throw new TypeError('format must be one of "pem" or "der"');if("pem"===o)switch((f=f.toString()).split(/\r?\n/g)[0].toString()){case"-----BEGIN PRIVATE KEY-----":m="pkcs8",y="PRIVATE KEY";break;case"-----BEGIN EC PRIVATE KEY-----":m="sec1",y="EC PRIVATE KEY";break;case"-----BEGIN RSA PRIVATE KEY-----":m="pkcs1",y="RSA PRIVATE KEY";break;default:throw new TypeError("unknown/unsupported PEM type")}switch(m){case"pkcs8":{const e=c.get("PrivateKeyInfo").decode(f,o,{label:y});let t,r;switch(e.algorithm.algorithm){case"ecPublicKey":r=p({type:t="sec1",key:e.privateKey,format:"der"},{[u]:e.algorithm.parameters.value});break;case"rsaEncryption":r=p({type:t="pkcs1",key:e.privateKey,format:"der"});break;default:l(e.algorithm.algorithm)}return r._pkcs8=f,r}case"pkcs1":{const e=c.get("RSAPrivateKey"),t=e.decode(f,o,{label:y}),r=new a;return r._asn1=t,r._asymmetricKeyType="rsa",r._type="private",r._pem=e.encode(t,"pem",{label:"RSA PRIVATE KEY"}),r}case"sec1":{const e=c.get("ECPrivateKey");let r=e.decode(f,o,{label:y});if(!("parameters"in r||s[u]))throw new Error("invalid sec1");"parameters"in r||(r=t(t({},r),{},{parameters:{type:"namedCurve",value:s[u]}}));const i=new a;return i._asn1=r,i._asymmetricKeyType="ec",i._type="private",i._pem=e.encode(r,"pem",{label:"EC PRIVATE KEY"}),i}default:throw new TypeError(`The value ${m} is invalid for option "type"`)}})}module.exports={createPublicKey:s,createPrivateKey:p,createSecretKey:o,KeyObject:a,asInput:n};
},{"./runtime_support":"JzdI","../errors":"aYsl","./is_object":"KEHe","./asn1":"xF0l"}],"H9zt":[function(require,module,exports) {
function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function r(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach(function(e){t(r,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const{randomBytes:n}=require("crypto"),o=require("./base64url"),i=require("../errors"),c=BigInt(0),f=BigInt(1),l=BigInt(2),u=e=>{const r=e.toString(16);return o.encodeBuffer(Buffer.from(r.length%2?`0${r}`:r,"hex"))},s=e=>BigInt(`0x${e.toString("hex")}`),p=e=>e.toString(2).length,a=(e,r)=>{let t=c,n=f,o=f,i=c;for(;e!==c;){const c=r/e,f=r%e,l=t-o*c,u=n-i*c;r=e,e=f,t=o,n=i,o=l,i=u}return t},d=(e,r)=>{let t=c;for(;!((e|r)&f);)e>>=f,r>>=f,t++;for(;!(e&f);)e>>=f;do{for(;!(r&f);)r>>=f;if(e>r){const t=e;e=r,r=t}r-=e}while(r);return e<<t},b=(e,r,t)=>{e=w(e,t);let n=f,o=e;for(;r>0;){const e=r%l;r/=l,e===f&&(n*=o,n%=t),o*=o,o%=t}return n},g=(e,r)=>{const t=r-e,n=p(t);let o;do{o=s(O(n))}while(o>t);return o+e},O=e=>{const r=Math.ceil(e/8),t=n(r);return t[0]=t[0]&2**(e%8)-1,t},w=(e,r)=>(e%=r)<0?e+r:e,h=e=>{let r=e;for(;r%l===c;)r/=l;return r},y=30,m=22,j=(e,r,t)=>{const n=h(e*r-f);let o,u=0;do{if(30===++u)throw new i.JWKImportFailed("failed to calculate missing primes");let e=0,r=b(g(l,t),n,t),s=c;for(;r!==f;){if(22===++e)throw new i.JWKImportFailed("failed to calculate missing primes");s=r,r=r*r%t}s!==t-f&&(o=s)}while(!o);const s=d(o-f,t),p=t/s;return s>p?{p:s,q:p}:{p:p,q:s}};module.exports=(e=>{const t=s(o.decodeToBuffer(e.e)),n=s(o.decodeToBuffer(e.d)),c=s(o.decodeToBuffer(e.n));if(n>=c)throw new i.JWKInvalid("invalid RSA private exponent");const{p:l,q:p}=j(t,n,c),d=n%(l-f),b=n%(p-f),g=w(a(w(p,l),l),l);return r(r({},e),{},{p:u(l),q:u(p),dp:u(d),dq:u(b),qi:u(g)})});
},{"./base64url":"xoPC","../errors":"aYsl"}],"jGeS":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function t(t){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?e(Object(i),!0).forEach(function(e){r(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{EOL:o}=require("os"),i=require("../errors"),{keyObjectSupported:n}=require("./runtime_support"),{createPublicKey:c}=require("./key_object"),p=require("./base64url"),d=require("./asn1"),a=require("./rsa_primes"),{OKP_CURVES:u,EC_CURVES:s}=require("../registry"),l=(e,t)=>`-----BEGIN ${t} KEY-----${o}${(e.match(/.{1,64}/g)||[]).join(o)}${o}-----END ${t} KEY-----`,y={private(e,r){const o=r.export({type:"pkcs8",format:"der"}),i=d.get("OneAsymmetricKey"),{privateKey:{privateKey:n}}=i.decode(o);return t(t({},y.public(e,c(r))),{},{d:p.encodeBuffer(n)})},public(e,t){const r=t.export({type:"spki",format:"der"}),o=d.get("PublicKeyInfo"),{publicKey:{data:i}}=o.decode(r);return{kty:"OKP",crv:e,x:p.encodeBuffer(i)}}},f={rsa:{private(e){const t=e.export({type:"pkcs8",format:"der"}),r=d.get("PrivateKeyInfo"),o=d.get("RSAPrivateKey"),{privateKey:n}=r.decode(t),{version:c,n:a,e:u,d:s,p:l,q:y,dp:f,dq:g,qi:b}=o.decode(n);if("two-prime"!==c)throw new i.JOSENotSupported("Private RSA keys with more than two primes are not supported");return{kty:"RSA",n:p.encodeBigInt(a),e:p.encodeBigInt(u),d:p.encodeBigInt(s),p:p.encodeBigInt(l),q:p.encodeBigInt(y),dp:p.encodeBigInt(f),dq:p.encodeBigInt(g),qi:p.encodeBigInt(b)}},public(e){const t=e.export({type:"spki",format:"der"}),r=d.get("PublicKeyInfo"),o=d.get("RSAPublicKey"),{publicKey:{data:i}}=r.decode(t),{n:n,e:c}=o.decode(i);return{kty:"RSA",n:p.encodeBigInt(n),e:p.encodeBigInt(c)}}},ec:{private(e){const r=e.export({type:"pkcs8",format:"der"}),o=d.get("PrivateKeyInfo"),a=d.get("ECPrivateKey"),{privateKey:u,algorithm:{parameters:{value:s}}}=o.decode(r),{privateKey:l,publicKey:y}=a.decode(u);if(void 0===y){if(n)return t(t({},f.ec.public(c(e))),{},{d:p.encodeBuffer(l)});throw new i.JOSENotSupported("Private EC keys without the public key embedded are not supported in your Node.js runtime version")}const g=y.data.slice(1,(y.data.length-1)/2+1),b=y.data.slice((y.data.length-1)/2+1);return{kty:"EC",crv:s,d:p.encodeBuffer(l),x:p.encodeBuffer(g),y:p.encodeBuffer(b)}},public(e){const t=e.export({type:"spki",format:"der"}),r=d.get("PublicKeyInfo"),{publicKey:{data:o},algorithm:{parameters:{value:i}}}=r.decode(t),n=o.slice(1,(o.length-1)/2+1),c=o.slice((o.length-1)/2+1);return{kty:"EC",crv:i,x:p.encodeBuffer(n),y:p.encodeBuffer(c)}}},ed25519:{private:e=>y.private("Ed25519",e),public:e=>y.public("Ed25519",e)},ed448:{private:e=>y.private("Ed448",e),public:e=>y.public("Ed448",e)},x25519:{private:e=>y.private("X25519",e),public:e=>y.public("X25519",e)},x448:{private:e=>y.private("X448",e),public:e=>y.public("X448",e)}};module.exports.keyObjectToJWK=(e=>"private"===e.type?f[e.asymmetricKeyType].private(e):f[e.asymmetricKeyType].public(e));const g=(e,t)=>({unused:0,data:Buffer.concat([Buffer.alloc(1,4),p.decodeToBuffer(e),p.decodeToBuffer(t)])}),b={RSA:{private(e,{calculateMissingRSAPrimes:t}){const r=d.get("RSAPrivateKey");if("oth"in e)throw new i.JOSENotSupported("Private RSA keys with more than two primes are not supported");if(e.p||e.q||e.dp||e.dq||e.qi){if(!(e.p&&e.q&&e.dp&&e.dq&&e.qi))throw new i.JWKInvalid("all other private key parameters must be present when any one of them is present")}else if(t)e=a(e);else if(!t)throw new i.JOSENotSupported("importing private RSA keys without all other private key parameters is not enabled, see documentation and its advisory on how and when its ok to enable it");return r.encode({version:0,n:BigInt(`0x${p.decodeToBuffer(e.n).toString("hex")}`),e:BigInt(`0x${p.decodeToBuffer(e.e).toString("hex")}`),d:BigInt(`0x${p.decodeToBuffer(e.d).toString("hex")}`),p:BigInt(`0x${p.decodeToBuffer(e.p).toString("hex")}`),q:BigInt(`0x${p.decodeToBuffer(e.q).toString("hex")}`),dp:BigInt(`0x${p.decodeToBuffer(e.dp).toString("hex")}`),dq:BigInt(`0x${p.decodeToBuffer(e.dq).toString("hex")}`),qi:BigInt(`0x${p.decodeToBuffer(e.qi).toString("hex")}`)},"pem",{label:"RSA PRIVATE KEY"})},public:e=>d.get("RSAPublicKey").encode({version:0,n:BigInt(`0x${p.decodeToBuffer(e.n).toString("hex")}`),e:BigInt(`0x${p.decodeToBuffer(e.e).toString("hex")}`)},"pem",{label:"RSA PUBLIC KEY"})},EC:{private:e=>d.get("ECPrivateKey").encode({version:1,privateKey:p.decodeToBuffer(e.d),parameters:{type:"namedCurve",value:e.crv},publicKey:g(e.x,e.y)},"pem",{label:"EC PRIVATE KEY"}),public:e=>d.get("PublicKeyInfo").encode({algorithm:{algorithm:"ecPublicKey",parameters:{type:"namedCurve",value:e.crv}},publicKey:g(e.x,e.y)},"pem",{label:"PUBLIC KEY"})},OKP:{private(e){const t=d.get("OneAsymmetricKey").encode({version:0,privateKey:{privateKey:p.decodeToBuffer(e.d)},algorithm:{algorithm:e.crv}},"der");return t.write("04",12,1,"hex"),l(t.toString("base64"),"PRIVATE")},public:e=>d.get("PublicKeyInfo").encode({algorithm:{algorithm:e.crv},publicKey:{unused:0,data:p.decodeToBuffer(e.x)}},"pem",{label:"PUBLIC KEY"})}};module.exports.jwkToPem=((e,{calculateMissingRSAPrimes:t=!1}={})=>{switch(e.kty){case"EC":if(!s.has(e.crv))throw new i.JOSENotSupported(`unsupported EC key curve: ${e.crv}`);break;case"OKP":if(!u.has(e.crv))throw new i.JOSENotSupported(`unsupported OKP key curve: ${e.crv}`);break;case"RSA":break;default:throw new i.JOSENotSupported(`unsupported key type: ${e.kty}`)}return e.d?b[e.kty].private(e,{calculateMissingRSAPrimes:t}):b[e.kty].public(e)});
},{"../errors":"aYsl","./runtime_support":"JzdI","./key_object":"v3aG","./base64url":"xoPC","./asn1":"xF0l","./rsa_primes":"H9zt","../registry":"Hjk2"}],"kXe3":[function(require,module,exports) {
const{createHash:e}=require("crypto"),r=require("../help/base64url"),d=(d,o)=>r.encodeBuffer(e(d).update(Buffer.from(o,"base64")).digest());module.exports.kid=(d=>r.encodeBuffer(e("sha256").update(JSON.stringify(d)).digest())),module.exports.x5t=d.bind(void 0,"sha1"),module.exports["x5t#S256"]=d.bind(void 0,"sha256");
},{"../help/base64url":"xoPC"}],"K4kr":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function t(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?e(Object(s),!0).forEach(function(e){r(t,e,s[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{strict:i}=require("assert"),{inspect:s}=require("util"),{EOL:o}=require("os"),{keyObjectSupported:n}=require("../../help/runtime_support"),{createPublicKey:a}=require("../../help/key_object"),{keyObjectToJWK:c}=require("../../help/key_utils"),{THUMBPRINT_MATERIAL:p,PUBLIC_MEMBERS:h,PRIVATE_MEMBERS:u,JWK_MEMBERS:l,KEYOBJECT:y,USES_MAPPING:d,OPS:b,USES:m}=require("../../help/consts"),f=require("../../help/is_object"),g=require("../thumbprint"),v=require("../../errors"),w=Symbol("privateApi"),{JWK:E}=require("../../registry");class k{constructor(e,{alg:r,use:s,kid:c,key_ops:h,x5c:u,x5t:l,"x5t#S256":w}={}){if(void 0!==s&&("string"!=typeof s||!m.has(s)))throw new TypeError('`use` must be either "sig" or "enc" string when provided');if(void 0!==r&&("string"!=typeof r||!r))throw new TypeError("`alg` must be a non-empty string when provided");if(void 0!==c&&("string"!=typeof c||!c))throw new TypeError("`kid` must be a non-empty string when provided");if(void 0!==h){if(!Array.isArray(h)||!h.length||h.some(e=>"string"!=typeof e))throw new TypeError("`key_ops` must be a non-empty array of strings when provided");h=Array.from(new Set(h)).filter(e=>b.has(e))}if(h&&s&&("enc"===s&&h.some(e=>d.sig.has(e))||"sig"===s&&h.some(e=>d.enc.has(e))))throw new v.JWKInvalid('inconsistent JWK "use" and "key_ops"');if(n&&void 0!==u){if(!Array.isArray(u)||!u.length||u.some(e=>"string"!=typeof e))throw new TypeError("`x5c` must be an array of one or more PKIX certificates when provided");u.forEach((t,r)=>{let s;try{s=a({key:`-----BEGIN CERTIFICATE-----${o}${(t.match(/.{1,64}/g)||[]).join(o)}${o}-----END CERTIFICATE-----`,format:"pem"})}catch(n){throw new v.JWKInvalid(`\`x5c\` member at index ${r} is not a valid base64-encoded DER PKIX certificate`)}if(0===r)try{i.deepEqual(s.export({type:"spki",format:"der"}),("public"===e.type?e:a(e)).export({type:"spki",format:"der"}))}catch(n){throw new v.JWKInvalid("The key in the first `x5c` certificate MUST match the public key represented by the JWK")}})}Object.defineProperties(this,t(t(t({[y]:{value:f(e)?void 0:e},keyObject:{get(){if(!n)throw new v.JOSENotSupported("KeyObject class is not supported in your Node.js runtime version");return this[y]}},type:{value:e.type},private:{value:"private"===e.type},public:{value:"public"===e.type},secret:{value:"secret"===e.type},alg:{value:r,enumerable:void 0!==r},use:{value:s,enumerable:void 0!==s},x5c:t({enumerable:void 0!==u},u?{get:()=>[...u]}:{value:void 0}),key_ops:t({enumerable:void 0!==h},h?{get:()=>[...h]}:{value:void 0}),kid:t({enumerable:!0},c?{value:c}:{get(){return Object.defineProperty(this,"kid",{value:this.thumbprint,configurable:!1}),this.kid},configurable:!0})},u?{x5t:t({enumerable:!0},l?{value:l}:{get(){return Object.defineProperty(this,"x5t",{value:g.x5t(this.x5c[0]),configurable:!1}),this.x5t},configurable:!0})}:void 0),u?{"x5t#S256":t({enumerable:!0},w?{value:w}:{get(){return Object.defineProperty(this,"x5t#S256",{value:g["x5t#S256"](this.x5c[0]),configurable:!1}),this["x5t#S256"]},configurable:!0})}:void 0),{},{thumbprint:{get(){return Object.defineProperty(this,"thumbprint",{value:g.kid(this[p]()),configurable:!1}),this.thumbprint},configurable:!0}}))}toPEM(e=!1,t={}){if(this.secret)throw new TypeError("symmetric keys cannot be exported as PEM");if(e&&!0===this.public)throw new TypeError("public key cannot be exported as private");const{type:r=(e?"pkcs8":"spki"),cipher:i,passphrase:s}=t;let o=this[y];if(!e&&(this.private&&(o=a(o)),i||s))throw new TypeError("cipher and passphrase can only be applied when exporting private keys");return e?o.export({format:"pem",type:r,cipher:i,passphrase:s}):o.export({format:"pem",type:r})}toJWK(e=!1){if(e&&!0===this.public)throw new TypeError("public key cannot be exported as private");const t=[...this.constructor[e?u:h]].map(e=>[e,this[e]]),r={};return Object.keys(t).forEach(e=>{const[i,s]=t[e];r[i]=s}),r.kty=this.kty,r.kid=this.kid,this.alg&&(r.alg=this.alg),this.key_ops&&this.key_ops.length&&(r.key_ops=this.key_ops),this.use&&(r.use=this.use),this.x5c&&(r.x5c=this.x5c),this.x5t&&(r.x5t=this.x5t),this["x5t#S256"]&&(r["x5t#S256"]=this["x5t#S256"]),r}[l](){const e="private"===this[y].type?this.constructor[u]:this.constructor[h];Object.defineProperties(this,[...e].reduce((t,r)=>(t[r]={get(){const t=c(this[y]);return Object.defineProperties(this,Object.entries(t).filter(([t])=>e.has(t)).reduce((e,[t,r])=>(e[t]={value:r,enumerable:this.constructor[h].has(t),configurable:!1},e),{})),this[r]},enumerable:this.constructor[h].has(r),configurable:!0},t),{}))}[s.custom](){return`${this.constructor.name} ${s(this.toJWK(!1),{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}[p](){throw new Error(`"[THUMBPRINT_MATERIAL]()" is not implemented on ${this.constructor.name}`)}algorithms(e,t,r){const{use:i=this.use,alg:s=this.alg,key_ops:o=this.key_ops}=t===w?r:{};if(s)return new Set(this.algorithms(e,w,{alg:null,use:i,key_ops:o}).has(s)?[s]:void 0);if("symbol"==typeof e)try{return this[e]()}catch(n){return new Set}if(e&&o&&!o.includes(e))return new Set;switch(e){case"decrypt":case"deriveKey":case"encrypt":case"sign":case"unwrapKey":case"verify":case"wrapKey":return new Set(Object.entries(E[this.kty][e]).map(([e,t])=>t(this)?e:void 0).filter(Boolean));case void 0:return new Set([...this.algorithms("sign"),...this.algorithms("verify"),...this.algorithms("decrypt"),...this.algorithms("encrypt"),...this.algorithms("unwrapKey"),...this.algorithms("wrapKey"),...this.algorithms("deriveKey")]);default:throw new TypeError("invalid key operation")}}static async generate(){throw new Error(`"static async generate()" is not implemented on ${this.name}`)}static generateSync(){throw new Error(`"static generateSync()" is not implemented on ${this.name}`)}static get[h](){throw new Error(`"static get [PUBLIC_MEMBERS]()" is not implemented on ${this.name}`)}static get[u](){throw new Error(`"static get [PRIVATE_MEMBERS]()" is not implemented on ${this.name}`)}}module.exports=k;
},{"../../help/runtime_support":"JzdI","../../help/key_object":"v3aG","../../help/key_utils":"jGeS","../../help/consts":"xufk","../../help/is_object":"KEHe","../thumbprint":"kXe3","../../errors":"aYsl","../../registry":"Hjk2"}],"Y7fT":[function(require,module,exports) {
const{generateKeyPairSync:e,generateKeyPair:t}=require("crypto"),{promisify:r}=require("util"),{THUMBPRINT_MATERIAL:i,JWK_MEMBERS:n,PUBLIC_MEMBERS:s,PRIVATE_MEMBERS:a,KEY_MANAGEMENT_DECRYPT:p,KEY_MANAGEMENT_ENCRYPT:u}=require("../../help/consts"),{keyObjectSupported:c}=require("../../help/runtime_support"),{createPublicKey:o,createPrivateKey:l}=require("../../help/key_object"),y=require("./base"),g=r(t),h=new Set(["e","n"]);Object.freeze(h);const b=new Set([...h,"d","p","q","dp","dq","qi"]);Object.freeze(b);class E extends y{constructor(...e){super(...e),this[n](),Object.defineProperties(this,{kty:{value:"RSA",enumerable:!0},length:{get(){return Object.defineProperty(this,"length",{value:8*Buffer.byteLength(this.n,"base64"),configurable:!1}),this.length},configurable:!0}})}static get[s](){return h}static get[a](){return b}[i](){return{e:this.e,kty:"RSA",n:this.n}}[u](){return this.algorithms("wrapKey")}[p](){return this.algorithms("unwrapKey")}static async generate(e=2048,t=!0){if(!Number.isSafeInteger(e)||e<512||e%8!=0||"electron"in process.versions&&e%128!=0)throw new TypeError("invalid bit length");let r,i;return c?(({privateKey:r,publicKey:i}=await g("rsa",{modulusLength:e})),t?r:i):(({privateKey:r,publicKey:i}=await g("rsa",{modulusLength:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}})),t?l(r):o(i))}static generateSync(t=2048,r=!0){if(!Number.isSafeInteger(t)||t<512||t%8!=0||"electron"in process.versions&&t%128!=0)throw new TypeError("invalid bit length");let i,n;return c?(({privateKey:i,publicKey:n}=e("rsa",{modulusLength:t})),r?i:n):(({privateKey:i,publicKey:n}=e("rsa",{modulusLength:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}})),r?l(i):o(n))}}module.exports=E;
},{"../../help/consts":"xufk","../../help/runtime_support":"JzdI","../../help/key_object":"v3aG","./base":"K4kr"}],"E8hL":[function(require,module,exports) {
const{generateKeyPairSync:e,generateKeyPair:r}=require("crypto"),{promisify:t}=require("util"),{THUMBPRINT_MATERIAL:i,JWK_MEMBERS:p,PUBLIC_MEMBERS:u,PRIVATE_MEMBERS:c,KEY_MANAGEMENT_DECRYPT:n,KEY_MANAGEMENT_ENCRYPT:a}=require("../../help/consts"),{EC_CURVES:s}=require("../../registry"),{keyObjectSupported:y}=require("../../help/runtime_support"),{createPublicKey:o,createPrivateKey:E}=require("../../help/key_object"),d=require("../../errors"),v=require("./base"),K=t(r),h=new Set(["crv","x","y"]);Object.freeze(h);const l=new Set([...h,"d"]);Object.freeze(l);class m extends v{constructor(...e){if(super(...e),this[p](),Object.defineProperty(this,"kty",{value:"EC",enumerable:!0}),!s.has(this.crv))throw new d.JOSENotSupported("unsupported EC key curve")}static get[u](){return h}static get[c](){return l}[i](){return{crv:this.crv,kty:"EC",x:this.x,y:this.y}}[a](){return this.algorithms("deriveKey")}[n](){return this.public?new Set:this.algorithms("deriveKey")}static async generate(e="P-256",r=!0){if(!s.has(e))throw new d.JOSENotSupported(`unsupported EC key curve: ${e}`);let t,i;return y?(({privateKey:t,publicKey:i}=await K("ec",{namedCurve:e})),r?t:i):(({privateKey:t,publicKey:i}=await K("ec",{namedCurve:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}})),r?E(t):o(i))}static generateSync(r="P-256",t=!0){if(!s.has(r))throw new d.JOSENotSupported(`unsupported EC key curve: ${r}`);let i,p;return y?(({privateKey:i,publicKey:p}=e("ec",{namedCurve:r})),t?i:p):(({privateKey:i,publicKey:p}=e("ec",{namedCurve:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}})),t?E(i):o(p))}}module.exports=m;
},{"../../help/consts":"xufk","../../registry":"Hjk2","../../help/runtime_support":"JzdI","../../help/key_object":"v3aG","../../errors":"aYsl","./base":"K4kr"}],"H4ed":[function(require,module,exports) {
const{generateKeyPairSync:e,generateKeyPair:r}=require("crypto"),{promisify:t}=require("util"),{THUMBPRINT_MATERIAL:o,JWK_MEMBERS:i,PUBLIC_MEMBERS:s,PRIVATE_MEMBERS:u,KEY_MANAGEMENT_DECRYPT:n,KEY_MANAGEMENT_ENCRYPT:p}=require("../../help/consts"),{OKP_CURVES:c}=require("../../registry"),{edDSASupported:a}=require("../../help/runtime_support"),y=require("../../errors"),E=require("./base"),d=t(r),S=new Set(["crv","x"]);Object.freeze(S);const h=new Set([...S,"d"]);Object.freeze(h);class K extends E{constructor(...e){if(super(...e),this[i](),Object.defineProperty(this,"kty",{value:"OKP",enumerable:!0}),!c.has(this.crv))throw new y.JOSENotSupported("unsupported OKP key curve")}static get[s](){return S}static get[u](){return h}[o](){return{crv:this.crv,kty:"OKP",x:this.x}}[p](){return this.algorithms("deriveKey")}[n](){return this.public?new Set:this.algorithms("deriveKey")}static async generate(e="Ed25519",r=!0){if(!a)throw new y.JOSENotSupported("OKP keys are not supported in your Node.js runtime version");if(!c.has(e))throw new y.JOSENotSupported(`unsupported OKP key curve: ${e}`);const{privateKey:t,publicKey:o}=await d(e.toLowerCase());return r?t:o}static generateSync(r="Ed25519",t=!0){if(!a)throw new y.JOSENotSupported("OKP keys are not supported in your Node.js runtime version");if(!c.has(r))throw new y.JOSENotSupported(`unsupported OKP key curve: ${r}`);const{privateKey:o,publicKey:i}=e(r.toLowerCase());return t?o:i}}module.exports=K;
},{"../../help/consts":"xufk","../../registry":"Hjk2","../../help/runtime_support":"JzdI","../../errors":"aYsl","./base":"K4kr"}],"aMM4":[function(require,module,exports) {
const{randomBytes:e}=require("crypto"),{createSecretKey:t}=require("../../help/key_object"),r=require("../../help/base64url"),{THUMBPRINT_MATERIAL:i,PUBLIC_MEMBERS:n,PRIVATE_MEMBERS:s,KEY_MANAGEMENT_DECRYPT:o,KEY_MANAGEMENT_ENCRYPT:c,KEYOBJECT:a}=require("../../help/consts"),u=require("./base"),h=new Set;Object.freeze(h);const l=new Set(["k"]);Object.freeze(l);class y extends u{constructor(...e){super(...e),Object.defineProperties(this,{kty:{value:"oct",enumerable:!0},length:{value:this[a]?8*this[a].symmetricKeySize:void 0},k:{enumerable:!1,get(){return this[a]?Object.defineProperty(this,"k",{value:r.encodeBuffer(this[a].export()),configurable:!1}):Object.defineProperty(this,"k",{value:void 0,configurable:!1}),this.k},configurable:!0}})}static get[n](){return h}static get[s](){return l}[i](){if(!this[a])throw new TypeError('reference "oct" keys without "k" cannot have their thumbprint calculated');return{k:this.k,kty:"oct"}}[c](){return new Set([...this.algorithms("wrapKey"),...this.algorithms("deriveKey")])}[o](){return this[c]()}algorithms(...e){return this[a]?u.prototype.algorithms.call(this,...e):new Set}static async generate(...e){return this.generateSync(...e)}static generateSync(r=256,i=!0){if(!i)throw new TypeError('"oct" keys cannot be generated as public');if(!Number.isSafeInteger(r)||!r||r%8!=0)throw new TypeError("invalid bit length");return t(e(r/8))}}module.exports=y;
},{"../../help/key_object":"v3aG","../../help/base64url":"xoPC","../../help/consts":"xufk","./base":"K4kr"}],"xpG4":[function(require,module,exports) {
function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);r&&(c=c.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,c)}return t}function r(r){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?e(Object(i),!0).forEach(function(e){t(r,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const{createPublicKey:c,createPrivateKey:i,createSecretKey:o,KeyObject:n}=require("../help/key_object"),s=require("../help/base64url"),a=require("../help/is_object"),{jwkToPem:u}=require("../help/key_utils"),f=require("../errors"),y=require("./key/rsa"),p=require("./key/ec"),l=require("./key/okp"),b=require("./key/oct"),w=new Set(["string","buffer","object"]),h=(e={},t={})=>r({alg:t.alg,key_ops:t.key_ops,kid:t.kid,use:t.use,x5c:t.x5c,x5t:t.x5t,"x5t#S256":t["x5t#S256"]},e),O=/^[a-zA-Z0-9-]+ AAAA(?:[0-9A-Za-z+/])+(?:==|=)?(?: .*)?$/,k=(e,r,{calculateMissingRSAPrimes:t=!1}={})=>{let k,g,j;if(!w.has(typeof e))throw new TypeError("key argument must be a string, buffer or an object");if(void 0!==r&&!a(r))throw new TypeError("parameters argument must be a plain object when provided");if(e instanceof n)switch(e.type){case"private":k=e;break;case"public":g=e;break;case"secret":j=e}else if("object"==typeof e&&e&&"kty"in e&&"oct"===e.kty){try{j=o(s.decodeToBuffer(e.k))}catch(d){"k"in e||(j={type:"secret"})}r=h(r,e)}else if("object"==typeof e&&e&&"kty"in e){let o;({calculateMissingRSAPrimes:t=!1}=r||{calculateMissingRSAPrimes:t});try{o=u(e,{calculateMissingRSAPrimes:t})}catch(d){if(d instanceof f.JOSEError)throw d}o&&e.d?k=i(o):o&&(g=c(o)),r=h({},e)}else if(e&&("object"==typeof e||"string"==typeof e)){try{k=i(e)}catch(d){if(d instanceof f.JOSEError)throw d}try{g=c(e),!e.startsWith("-----BEGIN CERTIFICATE-----")||r&&"x5c"in r||(r=h(r,{x5c:[e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,"")]}))}catch(d){if(d instanceof f.JOSEError)throw d}try{e.includes("-----BEGIN")||O.test(e.toString("ascii").replace(/[\r\n]/g,""))||(j=o(Buffer.isBuffer(e)?e:Buffer.from(e)))}catch(d){}}const m=k||g||j;if(k||g)switch(m.asymmetricKeyType){case"rsa":return new y(m,r);case"ec":return new p(m,r);case"ed25519":case"ed448":case"x25519":case"x448":return new l(m,r);default:throw new f.JOSENotSupported("only RSA, EC and OKP asymmetric keys are supported")}else if(j)return new b(m,r);throw new f.JWKImportFailed("key import failed")};module.exports=k;
},{"../help/key_object":"v3aG","../help/base64url":"xoPC","../help/is_object":"KEHe","../help/key_utils":"jGeS","../errors":"aYsl","./key/rsa":"Y7fT","./key/ec":"E8hL","./key/okp":"H4ed","./key/oct":"aMM4"}],"kNDj":[function(require,module,exports) {
const e=require("../errors"),r=require("./import"),t=require("./key/rsa"),a=require("./key/ec"),n=require("./key/okp"),u=require("./key/oct"),c=async(c,o,s,p=!0)=>{switch(c){case"RSA":return r(await t.generate(o,p),s);case"EC":return r(await a.generate(o,p),s);case"OKP":return r(await n.generate(o,p),s);case"oct":return r(await u.generate(o,p),s);default:throw new e.JOSENotSupported(`unsupported key type: ${c}`)}},o=(c,o,s,p=!0)=>{switch(c){case"RSA":return r(t.generateSync(o,p),s);case"EC":return r(a.generateSync(o,p),s);case"OKP":return r(n.generateSync(o,p),s);case"oct":return r(u.generateSync(o,p),s);default:throw new e.JOSENotSupported(`unsupported key type: ${c}`)}};module.exports.generate=c,module.exports.generateSync=o;
},{"../errors":"aYsl","./import":"xpG4","./key/rsa":"Y7fT","./key/ec":"E8hL","./key/okp":"H4ed","./key/oct":"aMM4"}],"xHDS":[function(require,module,exports) {
const{inspect:e}=require("util"),t=require("./base");class r extends t{constructor(){super({type:"unsecured"},{alg:"none"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[e.custom](){return"None {}"}algorithms(e){switch(e){case"sign":case"verify":case void 0:return new Set(["none"]);default:return new Set}}}module.exports=new r;
},{"./base":"K4kr"}],"Zkhk":[function(require,module,exports) {
const{inspect:e}=require("util"),t=require("./base");class r extends t{constructor(){super({type:"embedded"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[e.custom](){return"Embedded.JWK {}"}algorithms(){return new Set}}module.exports=new r;
},{"./base":"K4kr"}],"zcKk":[function(require,module,exports) {
const{inspect:e}=require("util"),t=require("./base");class r extends t{constructor(){super({type:"embedded"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[e.custom](){return"Embedded.X5C {}"}algorithms(){return new Set}}module.exports=new r;
},{"./base":"K4kr"}],"BoJ9":[function(require,module,exports) {
function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function r(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach(function(e){t(r,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const n=require("./key/base"),o=require("./key/none"),c=require("./key/embedded.jwk"),i=require("./key/embedded.x5c"),b=require("./import"),u=require("./generate");module.exports=r(r({},u),{},{asKey:b,isKey:e=>e instanceof n,None:o,EmbeddedJWK:c,EmbeddedX5C:i});
},{"./key/base":"K4kr","./key/none":"xHDS","./key/embedded.jwk":"Zkhk","./key/embedded.x5c":"zcKk","./import":"xpG4","./generate":"kNDj"}],"YOP0":[function(require,module,exports) {
const{inspect:e}=require("util"),t=require("../help/is_object"),{generate:r,generateSync:s}=require("../jwk/generate"),{USES_MAPPING:o}=require("../help/consts"),{isKey:i,asKey:a}=require("../jwk"),n=(e,{alg:t,use:r,ops:s})=>{let o=0;return t&&e.alg&&o++,r&&e.use&&o++,s&&e.key_ops&&o++,o};class y{constructor(...e){for(;e.some(Array.isArray);)e=e.flat?e.flat():e.reduce((e,t)=>Array.isArray(t)?[...e,...t]:(e.push(t),e),[]);if(e.some(e=>!i(e)||!e.kty))throw new TypeError("all keys must be instances of a key instantiated by JWK.asKey");this._keys=new Set(e)}all({alg:e,kid:t,thumbprint:r,use:s,kty:i,key_ops:a,x5t:y,"x5t#S256":u,crv:k}={}){if(void 0!==a&&(!Array.isArray(a)||!a.length||a.some(e=>"string"!=typeof e)))throw new TypeError("`key_ops` must be a non-empty array of strings");const c={alg:e,use:s,ops:a};return[...this._keys].filter(n=>{let c=!0;if(c&&void 0!==t&&n.kid!==t&&(c=!1),c&&void 0!==r&&n.thumbprint!==r&&(c=!1),c&&void 0!==y&&n.x5t!==y&&(c=!1),c&&void 0!==u&&n["x5t#S256"]!==u&&(c=!1),c&&void 0!==i&&n.kty!==i&&(c=!1),c&&void 0!==k&&n.crv!==k&&(c=!1),void 0===e||n.algorithms().has(e)||(c=!1),c&&void 0!==s&&void 0!==n.use&&n.use!==s&&(c=!1),c&&void 0!==a&&(void 0!==n.key_ops||void 0!==n.use)){let e;e=n.key_ops?new Set(n.key_ops):o[n.use],a.some(t=>!e.has(t))&&(c=!1)}return c}).sort((e,t)=>n(t,c)-n(e,c))}get(...e){return this.all(...e)[0]}add(e){if(!i(e)||!e.kty)throw new TypeError("key must be an instance of a key instantiated by JWK.asKey");this._keys.add(e)}remove(e){if(!i(e))throw new TypeError("key must be an instance of a key instantiated by JWK.asKey");this._keys.delete(e)}toJWKS(e=!1){return{keys:[...this._keys.values()].map(t=>t.toJWK(e&&(t.private||t.secret&&t.k)))}}async generate(...e){this._keys.add(await r(...e))}generateSync(...e){this._keys.add(s(...e))}get size(){return this._keys.size}[e.custom](){return`${this.constructor.name} ${e(this.toJWKS(!1),{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}*[Symbol.iterator](){for(const e of this._keys)yield e}}function u(e,{ignoreErrors:r=!1,calculateMissingRSAPrimes:s=!1}={}){if(!t(e)||!Array.isArray(e.keys)||e.keys.some(e=>!(t(e)&&"kty"in e)))throw new TypeError("jwks must be a JSON Web Key Set formatted object");const o=e.keys.map(e=>{try{return a(e,{calculateMissingRSAPrimes:s})}catch(t){if(!r)throw t;return}}).filter(Boolean);return new y(...o)}module.exports={KeyStore:y,asKeyStore:u};
},{"../help/is_object":"KEHe","../jwk/generate":"kNDj","../help/consts":"xufk","../jwk":"BoJ9"}],"FEWd":[function(require,module,exports) {
const e=require("../errors"),r=require("../jwk/key/base"),t=require("../jwk/import"),{KeyStore:n}=require("../jwks/keystore");module.exports=((a,i=!1)=>{if(a instanceof r)return a;if(a instanceof n){if(!i)throw new TypeError("key argument for this operation must not be a JWKS.KeyStore instance");return a}try{return t(a)}catch(o){if(o instanceof e.JOSEError&&!(o instanceof e.JWKImportFailed))throw o;let r;throw r=i?"key must be an instance of a key instantiated by JWK.asKey, a valid JWK.asKey input, or a JWKS.KeyStore instance":"key must be an instance of a key instantiated by JWK.asKey, or a valid JWK.asKey input",new TypeError(r)}});
},{"../errors":"aYsl","../jwk/key/base":"K4kr","../jwk/import":"xpG4","../jwks/keystore":"YOP0"}],"TDeS":[function(require,module,exports) {
module.exports=(e=>JSON.parse(JSON.stringify(e)));
},{}],"PewN":[function(require,module,exports) {
const{timingSafeEqual:t}=require("crypto"),e=(t,e)=>{if(t.length===e)return t;const r=Buffer.alloc(e);return t.copy(r),r},r=(r,n)=>{const o=Math.max(r.length,n.length);return t(e(r,o),e(n,o))};module.exports=r;
},{}],"VHOy":[function(require,module,exports) {
module.exports=(s=>`sha${s.substr(2,3)}`);
},{}],"lCjV":[function(require,module,exports) {
const{createHmac:e}=require("crypto"),{KEYOBJECT:r}=require("../help/consts"),t=require("../help/timing_safe_equal"),i=require("../help/node_alg"),{asInput:s}=require("../help/key_object"),o=(t,i,{[r]:o},n)=>{const u=e(i,s(o,!1));return u.update(n),u.digest()},n=(e,r,i,s,n)=>{const u=o(0,r,i,s);return t(n,u)};module.exports=((e,r)=>{["HS256","HS384","HS512"].forEach(t=>{const s=i(t);e.sign.set(t,o.bind(void 0,t,s)),e.verify.set(t,n.bind(void 0,t,s)),r.oct.sign[t]=r.oct.verify[t]=(e=>"sig"===e.use||void 0===e.use)})});
},{"../help/consts":"xufk","../help/timing_safe_equal":"PewN","../help/node_alg":"VHOy","../help/key_object":"v3aG"}],"DCr1":[function(require,module,exports) {
const e=128,r=0,o=32,t=16,n=2,f=48,i=2,s=e=>(e/8|0)+(e%8==0?0:1),c={ES256:s(256),ES256K:s(256),ES384:s(384),ES512:s(521)},w=(e,r,o)=>{let t=0;for(;r+t<o&&0===e[r+t];)++t;return e[r+t]>=128&&--t,t};module.exports.derToJose=((e,r)=>{if(!Buffer.isBuffer(e))throw new TypeError("ECDSA signature must be a Buffer");if(!c[r])throw new Error(`Unknown algorithm "${r}"`);const o=c[r],t=o+1,n=e.length;let f=0;if(48!==e[f++])throw new Error('Could not find expected "seq"');let i=e[f++];if(129===i&&(i=e[f++]),n-f<i)throw new Error(`"seq" specified length of ${i}", only ${n-f}" remaining`);if(2!==e[f++])throw new Error('Could not find expected "int" for "r"');const s=e[f++];if(n-f-2<s)throw new Error(`"r" specified length of "${s}", only "${n-f-2}" available`);if(t<s)throw new Error(`"r" specified length of "${s}", max of "${t}" is acceptable`);const w=f;if(f+=s,2!==e[f++])throw new Error('Could not find expected "int" for "s"');const l=e[f++];if(n-f!==l)throw new Error(`"s" specified length of "${l}", expected "${n-f}"`);if(t<l)throw new Error(`"s" specified length of "${l}", max of "${t}" is acceptable`);const a=f;if((f+=l)!==n)throw new Error(`Expected to consume entire buffer, but "${n-f}" bytes remain`);const h=o-s,u=o-l,p=Buffer.allocUnsafe(h+s+u+l);for(f=0;f<h;++f)p[f]=0;e.copy(p,f,w+Math.max(-h,0),w+s);for(const c=f=o;f<c+u;++f)p[f]=0;return e.copy(p,f,a+Math.max(-u,0),a+l),p}),module.exports.joseToDer=((e,r)=>{if(!Buffer.isBuffer(e))throw new TypeError("ECDSA signature must be a Buffer");if(!c[r])throw new TypeError(`Unknown algorithm "${r}"`);const o=c[r],t=e.length;if(t!==2*o)throw new Error(`"${r}" signatures must be "${2*o}" bytes, saw "${t}"`);const n=w(e,0,o),f=w(e,o,e.length),i=o-n,s=o-f,l=2+i+1+1+s,a=l<128,h=Buffer.allocUnsafe((a?2:3)+l);let u=0;return h[u++]=48,a?h[u++]=l:(h[u++]=129,h[u++]=255&l),h[u++]=2,h[u++]=i,n<0?(h[u++]=0,u+=e.copy(h,u,0,o)):u+=e.copy(h,u,n,o),h[u++]=2,h[u++]=s,f<0?(h[u++]=0,e.copy(h,u,o)):e.copy(h,u,o+f),h});
},{}],"lXiq":[function(require,module,exports) {
const{sign:e,verify:r,createSign:s,createVerify:i,getCurves:t}=require("crypto"),{derToJose:n,joseToDer:u}=require("../help/ecdsa_signatures"),{KEYOBJECT:c}=require("../help/consts"),p=require("../help/node_alg"),{asInput:o}=require("../help/key_object"),{dsaEncodingSupported:d}=require("../help/runtime_support");let a,E;d?(a=((r,s,{[c]:i},t)=>("string"==typeof t&&(t=Buffer.from(t)),e(s,t,{key:o(i,!1),dsaEncoding:"ieee-p1363"}))),E=((e,s,{[c]:i},t,n)=>{try{return r(s,t,{key:o(i,!0),dsaEncoding:"ieee-p1363"},n)}catch(u){return!1}})):(a=((e,r,{[c]:i},t)=>n(s(r).update(t).sign(o(i,!1)),e)),E=((e,r,{[c]:s},t,n)=>{try{return i(r).update(t).verify(o(s,!0),u(n,e))}catch(p){return!1}}));const g=e=>{switch(e){case"P-256":return"ES256";case"secp256k1":return"ES256K";case"P-384":return"ES384";case"P-521":return"ES512"}};module.exports=((e,r)=>{const s=[];t().includes("prime256v1")&&s.push("ES256"),t().includes("secp256k1")&&s.push("ES256K"),t().includes("secp384r1")&&s.push("ES384"),t().includes("secp521r1")&&s.push("ES512"),s.forEach(s=>{const i=p(s);e.sign.set(s,a.bind(void 0,s,i)),e.verify.set(s,E.bind(void 0,s,i)),r.EC.sign[s]=(e=>e.private&&r.EC.verify[s](e)),r.EC.verify[s]=(e=>("sig"===e.use||void 0===e.use)&&g(e.crv)===s)})});
},{"../help/ecdsa_signatures":"DCr1","../help/consts":"xufk","../help/node_alg":"VHOy","../help/key_object":"v3aG","../help/runtime_support":"JzdI"}],"Va0x":[function(require,module,exports) {
const{sign:e,verify:r}=require("crypto"),{KEYOBJECT:i}=require("../help/consts"),{edDSASupported:s}=require("../help/runtime_support"),t=({[i]:r},s)=>("string"==typeof s&&(s=Buffer.from(s)),e(void 0,s,r)),d=({[i]:e},s,t)=>r(void 0,s,e,t);module.exports=((e,r)=>{s&&(e.sign.set("EdDSA",t),e.verify.set("EdDSA",d),r.OKP.sign.EdDSA=(e=>e.private&&r.OKP.verify.EdDSA(e)),r.OKP.verify.EdDSA=(e=>("sig"===e.use||void 0===e.use)&&e.keyObject.asymmetricKeyType.startsWith("ed")))});
},{"../help/consts":"xufk","../help/runtime_support":"JzdI"}],"EY5k":[function(require,module,exports) {
const{createSign:e,createVerify:S,constants:t}=require("crypto"),{KEYOBJECT:r}=require("../help/consts"),i=require("../help/node_alg"),{asInput:n}=require("../help/key_object"),s=(S,{[r]:i},s)=>{const o=n(i,!1);return e(S).update(s).sign({key:o,padding:t.RSA_PKCS1_PSS_PADDING,saltLength:t.RSA_PSS_SALTLEN_DIGEST})},o=(e,{[r]:i},s,o)=>{const P=n(i,!0);return S(e).update(s).verify({key:P,padding:t.RSA_PKCS1_PSS_PADDING,saltLength:t.RSA_PSS_SALTLEN_DIGEST},o)},P={PS256:528,PS384:784,PS512:1040};module.exports=((e,S)=>{["PS256","PS384","PS512"].forEach(t=>{const r=i(t);e.sign.set(t,s.bind(void 0,r)),e.verify.set(t,o.bind(void 0,r)),S.RSA.sign[t]=(e=>e.private&&S.RSA.verify[t](e)),S.RSA.verify[t]=(e=>("sig"===e.use||void 0===e.use)&&e.length>=P[t])})});
},{"../help/consts":"xufk","../help/node_alg":"VHOy","../help/key_object":"v3aG"}],"vJIM":[function(require,module,exports) {
const{createSign:e,createVerify:i}=require("crypto"),{KEYOBJECT:r}=require("../help/consts"),t=require("../help/node_alg"),{asInput:s}=require("../help/key_object"),n=(i,{[r]:t},n)=>e(i).update(n).sign(s(t,!1)),o=(e,{[r]:t},n,o)=>i(e).update(n).verify(s(t,!0),o),u={RS256:0,RS384:624,RS512:752};module.exports=((e,i)=>{["RS256","RS384","RS512"].forEach(r=>{const s=t(r);e.sign.set(r,n.bind(void 0,s)),e.verify.set(r,o.bind(void 0,s)),i.RSA.sign[r]=(e=>e.private&&i.RSA.verify[r](e)),i.RSA.verify[r]=(e=>("sig"===e.use||void 0===e.use)&&e.length>=u[r])})});
},{"../help/consts":"xufk","../help/node_alg":"VHOy","../help/key_object":"v3aG"}],"sVLa":[function(require,module,exports) {
const e=()=>Buffer.from(""),n=(e,n,o)=>!o.length;module.exports=((o,s)=>{o.sign.set("none",e),o.verify.set("none",n)});
},{}],"J7gP":[function(require,module,exports) {
const t=Math.pow(2,32);module.exports=((o,e=Buffer.allocUnsafe(8))=>{const r=Math.floor(o/t),n=o%t;return e.writeUInt32BE(r,0),e.writeUInt32BE(n,4),e});
},{}],"qImM":[function(require,module,exports) {
const{createCipheriv:e,createDecipheriv:t,getCiphers:c}=require("crypto"),r=require("../help/uint64be"),i=require("../help/timing_safe_equal"),{KEYOBJECT:n}=require("../help/consts"),{JWEInvalid:a,JWEDecryptionFailed:o}=require("../errors"),l=function(e,t,c){if(16!==t.length)throw new a("invalid iv");if(3===arguments.length&&c.length!==e/8)throw new a("invalid tag")},s=(t,c,{[n]:i},a,{iv:o,aad:s=Buffer.alloc(0)})=>{const u=i.export();l(t,o);const f=t/8,h=u.slice(f),p=e(`aes-${t}-cbc`,h,o),d=Buffer.concat([p.update(a),p.final()]),g=Buffer.concat([s,o,d,r(8*s.length)]),v=u.slice(0,f);return{ciphertext:d,tag:c({[n]:v},g).slice(0,f)}},u=(e,c,{[n]:a},s,{iv:u,tag:f=Buffer.alloc(0),aad:h=Buffer.alloc(0)})=>{l(e,u,f);const p=e/8,d=a.export(),g=d.slice(p),v=d.slice(0,p),B=Buffer.concat([h,u,s,r(8*h.length)]),C=c({[n]:v},B,f).slice(0,p);if(!i(f,C))throw new o;let w;try{const c=t(`aes-${e}-cbc`,g,u);w=Buffer.concat([c.update(s),c.final()])}catch(b){}if(!w)throw new o;return w};module.exports=((e,t)=>{["A128CBC-HS256","A192CBC-HS384","A256CBC-HS512"].forEach(r=>{const i=parseInt(r.substr(1,3),10),n=e.sign.get(`HS${2*i}`);c().includes(`aes-${i}-cbc`)&&(e.encrypt.set(r,s.bind(void 0,i,n)),e.decrypt.set(r,u.bind(void 0,i,n)),t.oct.encrypt[r]=t.oct.decrypt[r]=(e=>("enc"===e.use||void 0===e.use)&&e.length/2===i))})});
},{"../help/uint64be":"J7gP","../help/timing_safe_equal":"PewN","../help/consts":"xufk","../errors":"aYsl"}],"IvJy":[function(require,module,exports) {
const{createCipheriv:e,createDecipheriv:t,getCiphers:r}=require("crypto"),{KEYOBJECT:c}=require("../help/consts"),{JWEInvalid:n,JWEDecryptionFailed:a}=require("../errors"),{asInput:i}=require("../help/key_object"),o=function(e,t,r){if(12!==t.length)throw new n("invalid iv");if(3===arguments.length&&16!==r.length)throw new n("invalid tag")},s=(t,{[c]:r},n,{iv:a,aad:s=Buffer.alloc(0)})=>{const u=i(r,!1);o(t,a);const h=e(`aes-${t}-gcm`,u,a,{authTagLength:16});return h.setAAD(s),{ciphertext:Buffer.concat([h.update(n),h.final()]),tag:h.getAuthTag()}},u=(e,{[c]:r},n,{iv:s,tag:u=Buffer.alloc(0),aad:h=Buffer.alloc(0)})=>{const l=i(r,!1);o(e,s,u);try{const r=t(`aes-${e}-gcm`,l,s,{authTagLength:16});return r.setAuthTag(u),r.setAAD(h),Buffer.concat([r.update(n),r.final()])}catch(g){throw new a}};module.exports=((e,t)=>{["A128GCM","A192GCM","A256GCM"].forEach(c=>{const n=parseInt(c.substr(1,3),10);r().includes(`aes-${n}-gcm`)&&(e.encrypt.set(c,s.bind(void 0,n)),e.decrypt.set(c,u.bind(void 0,n)),t.oct.encrypt[c]=t.oct.decrypt[c]=(e=>("enc"===e.use||void 0===e.use)&&e.length===n))})});
},{"../help/consts":"xufk","../errors":"aYsl","../help/key_object":"v3aG"}],"PYim":[function(require,module,exports) {
const{publicEncrypt:e,privateDecrypt:A,constants:r}=require("crypto"),{oaepHashSupported:t}=require("../help/runtime_support"),{KEYOBJECT:s}=require("../help/consts"),{asInput:a}=require("../help/key_object"),n=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return r.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return r.RSA_PKCS1_PADDING}},c=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}},p=(A,r,{[s]:t},n)=>{const c=a(t,!0);return{wrapped:e({key:c,oaepHash:r,padding:A},n)}},S=(e,r,{[s]:t},n)=>{const c=a(t,!1);return A({key:c,oaepHash:r,padding:e},n)},u={RSA1_5:0,"RSA-OAEP":592,"RSA-OAEP-256":784,"RSA-OAEP-384":1040,"RSA-OAEP-512":1296};module.exports=((e,A)=>{const r=["RSA-OAEP","RSA1_5"];t&&r.splice(1,0,"RSA-OAEP-256","RSA-OAEP-384","RSA-OAEP-512"),r.forEach(r=>{const t=n(r),s=c(r);e.keyManagementEncrypt.set(r,p.bind(void 0,t,s)),e.keyManagementDecrypt.set(r,S.bind(void 0,t,s)),A.RSA.wrapKey[r]=(e=>("enc"===e.use||void 0===e.use)&&e.length>=u[r]),A.RSA.unwrapKey[r]=(e=>e.private&&("enc"===e.use||void 0===e.use)&&e.length>=u[r])})});
},{"../help/runtime_support":"JzdI","../help/consts":"xufk","../help/key_object":"v3aG"}],"T0wa":[function(require,module,exports) {
const{createCipheriv:e,createDecipheriv:r,getCiphers:t}=require("crypto"),{KEYOBJECT:n}=require("../help/consts"),{asInput:a}=require("../help/key_object"),c=e=>{if(void 0!==e&&e.length%8!=0)throw new Error("invalid data length")},o=(r,{[n]:t},c)=>{const o=a(t,!1),i=e(r,o,Buffer.alloc(8,"a6","hex"));return{wrapped:Buffer.concat([i.update(c),i.final()])}},i=(e,{[n]:t},o)=>{const i=a(t,!1);c(o);const s=r(e,i,Buffer.alloc(8,"a6","hex"));return Buffer.concat([s.update(o),s.final()])};module.exports=((e,r)=>{["A128KW","A192KW","A256KW"].forEach(n=>{const a=parseInt(n.substr(1,3),10),c=`aes${a}-wrap`;t().includes(c)&&(e.keyManagementEncrypt.set(n,o.bind(void 0,c)),e.keyManagementDecrypt.set(n,i.bind(void 0,c)),r.oct.wrapKey[n]=r.oct.unwrapKey[n]=(e=>("enc"===e.use||void 0===e.use)&&e.length===a))})});
},{"../help/consts":"xufk","../help/key_object":"v3aG"}],"MktT":[function(require,module,exports) {
const e=require("../help/generate_iv"),t=require("../help/base64url");module.exports=((r,n)=>{["A128GCMKW","A192GCMKW","A256GCMKW"].forEach(a=>{const c=a.substr(0,7),s=parseInt(a.substr(1,3),10),p=r.encrypt.get(c),u=r.decrypt.get(c);p&&u&&(r.keyManagementEncrypt.set(a,(r,n)=>{const c=e(a),{ciphertext:s,tag:u}=p(r,n,{iv:c});return{wrapped:s,header:{tag:t.encodeBuffer(u),iv:t.encodeBuffer(c)}}}),r.keyManagementDecrypt.set(a,u),n.oct.wrapKey[a]=n.oct.unwrapKey[a]=(e=>("enc"===e.use||void 0===e.use)&&e.length===s))})});
},{"../help/generate_iv":"ZWaW","../help/base64url":"xoPC"}],"YHtZ":[function(require,module,exports) {
const{pbkdf2Sync:e,randomBytes:r}=require("crypto"),{KEYOBJECT:t}=require("../help/consts"),n=require("../help/base64url"),o=16,s=Buffer.alloc(1,0),a=(e,r)=>Buffer.concat([Buffer.from(e,"utf8"),s,r]),c=(o,s,a,c,{[t]:d},u)=>{const p=Math.floor(2049*Math.random()+2048),i=r(16),f=a(i),y=e(d.export(),f,p,o,s),b=c({[t]:y},u);return b.header=b.header||{},Object.assign(b.header,{p2c:p,p2s:n.encodeBuffer(i)}),b},d=(r,n,o,s,{[t]:a},c,d)=>{const{p2s:u,p2c:p}=d,i=o(u),f=e(a.export(),i,p,r,n);return s({[t]:f},c,d)};module.exports=((e,r)=>{["PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"].forEach(t=>{const n=t.substr(-6),o=e.keyManagementEncrypt.get(n),s=e.keyManagementDecrypt.get(n),u=parseInt(t.substr(13,3),10)/8,p=`sha${t.substr(8,3)}`;o&&s&&(e.keyManagementEncrypt.set(t,c.bind(void 0,u,p,a.bind(void 0,t),o)),e.keyManagementDecrypt.set(t,d.bind(void 0,u,p,a.bind(void 0,t),s)),r.oct.deriveKey[t]=(e=>"enc"===e.use||void 0===e.use))})});
},{"../help/consts":"xufk","../help/base64url":"xoPC"}],"uL1j":[function(require,module,exports) {
const{improvedDH:e}=require("../../help/runtime_support");if(e){const{diffieHellman:e}=require("crypto"),{KeyObject:r}=require("../../help/key_object"),t=require("../../jwk/import");module.exports=(({keyObject:c},o)=>(o instanceof r||({keyObject:o}=t(o)),e({privateKey:c,publicKey:o})))}else{const{createECDH:e,constants:{POINT_CONVERSION_UNCOMPRESSED:r}}=require("crypto"),t=require("../../help/base64url"),c=e=>{switch(e){case"P-256":return"prime256v1";case"P-384":return"secp384r1";case"P-521":return"secp521r1"}},o=Buffer.alloc(1,r),u=(e,r)=>Buffer.concat([o,t.decodeToBuffer(e),t.decodeToBuffer(r)]);module.exports=(({crv:r,d:o},{x:s,y:i})=>{const p=c(r),n=e(p);return n.setPrivateKey(t.decodeToBuffer(o)),n.computeSecret(u(s,i))})}
},{"../../help/runtime_support":"JzdI","../../help/key_object":"v3aG","../../jwk/import":"xpG4","../../help/base64url":"xoPC"}],"bNas":[function(require,module,exports) {
const{createHash:e}=require("crypto"),t=require("./compute_secret"),r=(t,r,c)=>{const f=Math.ceil(r/32);let o;for(let a=1;a<=f;a++){const r=Buffer.allocUnsafe(4+t.length+c.length);r.writeUInt32BE(a,0),t.copy(r,4),c.copy(r,4+t.length),o=o?Buffer.concat([o,e("sha256").update(r).digest()]):e("sha256").update(r).digest()}return o.slice(0,r)},c=(e,t=Buffer.allocUnsafe(4))=>(t.writeUInt32BE(e),t),f=e=>Buffer.concat([c(e.length),e]);module.exports=((e,o,a,l,{apu:n=Buffer.alloc(0),apv:u=Buffer.alloc(0)}={},s=t)=>{const B=Buffer.concat([f(Buffer.from(e)),f(n),f(u),c(o)]),p=s(a,l);return r(p,o/8,B)});
},{"./compute_secret":"uL1j"}],"emLW":[function(require,module,exports) {
const{improvedDH:e}=require("../../help/runtime_support"),{KEYLENGTHS:r}=require("../../registry"),{generateSync:t}=require("../../jwk/generate"),n=require("./derive"),c=(e,c,{enc:y})=>{const s=t(e.kty,e.crv);return{wrapped:n(y,r.get(y),s,e),header:{epk:{kty:e.kty,crv:e.crv,x:s.x,y:s.y}}}},y=(e,t,c)=>{const{enc:y,epk:s}=c;return n(y,r.get(y),e,s,c)};module.exports=((r,t)=>{r.keyManagementEncrypt.set("ECDH-ES",c),r.keyManagementDecrypt.set("ECDH-ES",y),t.EC.deriveKey["ECDH-ES"]=(e=>("enc"===e.use||void 0===e.use)&&"secp256k1"!==e.crv),e&&(t.OKP.deriveKey["ECDH-ES"]=(e=>("enc"===e.use||void 0===e.use)&&e.keyObject.asymmetricKeyType.startsWith("x")))});
},{"../../help/runtime_support":"JzdI","../../registry":"Hjk2","../../jwk/generate":"kNDj","./derive":"bNas"}],"zRYs":[function(require,module,exports) {
const{improvedDH:e}=require("../../help/runtime_support"),{KEYOBJECT:r}=require("../../help/consts"),{generateSync:t}=require("../../jwk/generate"),{ECDH_DERIVE_LENGTHS:n}=require("../../registry"),s=require("./derive"),i=(e,n,s,i)=>{const y=t(s.kty,s.crv),c=n(y,s,i),a=e({[r]:c},i);return a.header=a.header||{},Object.assign(a.header,{epk:{kty:s.kty,crv:s.crv,x:y.x,y:y.y}}),a},y=(e,t,n,s,i)=>{const{epk:y}=i,c=t(n,y,i);return e({[r]:c},s,i)};module.exports=((r,t)=>{["ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"].forEach(c=>{const a=c.substr(-6),d=r.keyManagementEncrypt.get(a),o=r.keyManagementDecrypt.get(a),p=parseInt(c.substr(9,3),10);n.set(c,p),d&&o&&(r.keyManagementEncrypt.set(c,i.bind(void 0,d,s.bind(void 0,c,p))),r.keyManagementDecrypt.set(c,y.bind(void 0,o,s.bind(void 0,c,p))),t.EC.deriveKey[c]=(e=>("enc"===e.use||void 0===e.use)&&"secp256k1"!==e.crv),e&&(t.OKP.deriveKey[c]=(e=>("enc"===e.use||void 0===e.use)&&e.keyObject.asymmetricKeyType.startsWith("x"))))})}),module.exports.wrapKey=i,module.exports.unwrapKey=y;
},{"../../help/runtime_support":"JzdI","../../help/consts":"xufk","../../jwk/generate":"kNDj","../../registry":"Hjk2","./derive":"bNas"}],"nj8c":[function(require,module,exports) {
const{JWKKeySupport:e,JOSENotSupported:r}=require("../errors"),{KEY_MANAGEMENT_ENCRYPT:t,KEY_MANAGEMENT_DECRYPT:n}=require("../help/consts"),{JWA:a,JWK:i}=require("../registry");require("./hmac")(a,i),require("./ecdsa")(a,i),require("./eddsa")(a,i),require("./rsassa_pss")(a,i),require("./rsassa")(a,i),require("./none")(a),require("./aes_cbc_hmac_sha2")(a,i),require("./aes_gcm")(a,i),require("./rsaes")(a,i),require("./aes_kw")(a,i),require("./aes_gcm_kw")(a,i),require("./pbes2")(a,i),require("./ecdh/dir")(a,i),require("./ecdh/kw")(a,i);const s=(i,y,c)=>{const p=`_${y}_${c}`;let u,g;if("keyManagementEncrypt"===y?(u="key management (encryption)",g=t):"keyManagementDecrypt"===y&&(u="key management (decryption)",g=n),p in i){if(i[p])return;throw new e(`the key does not support ${c} ${u||y} algorithm`)}let o=!0;if(!a[y].has(c))throw new r(`unsupported ${u||y} alg: ${c}`);if(i.algorithms(g).has(c)||(o=!1),Object.defineProperty(i,p,{value:o,enumerable:!1}),!o)return s(i,y,c)};module.exports={check:s,sign:(e,r,t)=>(s(r,"sign",e),a.sign.get(e)(r,t)),verify:(e,r,t,n)=>(s(r,"verify",e),a.verify.get(e)(r,t,n)),keyManagementEncrypt:(e,r,t,n)=>(s(r,"keyManagementEncrypt",e),a.keyManagementEncrypt.get(e)(r,t,n)),keyManagementDecrypt:(e,r,t,n)=>(s(r,"keyManagementDecrypt",e),a.keyManagementDecrypt.get(e)(r,t,n)),encrypt:(e,r,t,n)=>(s(r,"encrypt",e),a.encrypt.get(e)(r,t,n)),decrypt:(e,r,t,n)=>(s(r,"decrypt",e),a.decrypt.get(e)(r,t,n))};
},{"../errors":"aYsl","../help/consts":"xufk","../registry":"Hjk2","./hmac":"lCjV","./ecdsa":"lXiq","./eddsa":"Va0x","./rsassa_pss":"EY5k","./rsassa":"vJIM","./none":"sVLa","./aes_cbc_hmac_sha2":"qImM","./aes_gcm":"IvJy","./rsaes":"PYim","./aes_kw":"T0wa","./aes_gcm_kw":"MktT","./pbes2":"YHtZ","./ecdh/dir":"emLW","./ecdh/kw":"zRYs"}],"eWLC":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach(function(e){r(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{JOSECritNotUnderstood:n,JWSInvalid:i}=require("../errors"),o=new Set(["alg","jku","jwk","kid","x5u","x5c","x5t","x5t#S256","typ","cty","crit","enc","zip","epk","apu","apv","iv","tag","p2s","p2c"]);module.exports=function(e,r,c,a){if(r&&"crit"in r){if(!Array.isArray(r.crit)||0===r.crit.length||r.crit.some(e=>"string"!=typeof e||!e))throw new e('"crit" Header Parameter MUST be an array of non-empty strings when present');const s=new Set(a),p=t(t({},r),c);r.crit.forEach(t=>{if(o.has(t))throw new e(`The critical list contains a non-extension Header Parameter ${t}`);if(!s.has(t))throw new n(`critical "${t}" is not understood`);if("b64"===t){if(!("b64"in r))throw new i('"b64" critical parameter must be integrity protected');if("boolean"!=typeof r.b64)throw new i('"b64" critical parameter must be a boolean')}else if(!(t in p))throw new e(`critical parameter "${t}" is missing`)})}if(c&&"crit"in c)throw new e('"crit" Header Parameter MUST be integrity protected when present')};
},{"../errors":"aYsl"}],"e9J4":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function t(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?e(Object(o),!0).forEach(function(e){r(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const i=require("../help/is_object");let o=require("../help/validate_crit");const{JWEInvalid:n}=require("../errors");o=o.bind(void 0,n);const d=(e,[t])=>`${e.protected}.${t.encrypted_key}.${e.iv}.${e.ciphertext}.${e.tag}`;d.validate=((e,t,r,{0:{header:i},length:d})=>{if(1!==d||r||t||i)throw new n("JWE Compact Serialization doesn't support multiple recipients, JWE unprotected headers or AAD");o(e,t,e?e.crit:void 0)});const c=(e,[r])=>{const{header:i,encrypted_key:o}=r;return t(t(t(t(t(t({},e.protected?{protected:e.protected}:void 0),e.unprotected?{unprotected:e.unprotected}:void 0),i?{header:i}:void 0),o?{encrypted_key:o}:void 0),e.aad?{aad:e.aad}:void 0),{},{iv:e.iv,ciphertext:e.ciphertext,tag:e.tag})};c.validate=((e,r,i,{0:{header:d},length:c})=>{if(1!==c)throw new n("Flattened JWE JSON Serialization doesn't support multiple recipients");o(e,t(t({},r),d),e?e.crit:void 0)});const a=(e,r)=>{const i=t(t(t(t({},e.protected?{protected:e.protected}:void 0),e.unprotected?{unprotected:e.unprotected}:void 0),{},{recipients:r.map(({header:e,encrypted_key:r,generatedHeader:i})=>!!(e||r||i)&&t(t({},e||i?{header:t(t({},e),i)}:void 0),r?{encrypted_key:r}:void 0)).filter(Boolean)},e.aad?{aad:e.aad}:void 0),{},{iv:e.iv,ciphertext:e.ciphertext,tag:e.tag});return i.recipients.length||delete i.recipients,i};a.validate=((e,r,i,n)=>{n.forEach(({header:i})=>{o(e,t(t({},i),r),e?e.crit:void 0)})});const p=e=>i(e)&&"string"==typeof e.ciphertext&&"string"==typeof e.iv&&"string"==typeof e.tag&&(void 0===e.unprotected||i(e.unprotected))&&(void 0===e.protected||"string"==typeof e.protected)&&(void 0===e.aad||"string"==typeof e.aad),s=e=>(void 0===e.encrypted_key||"string"==typeof e.encrypted_key)&&(void 0===e.header||i(e.header)),l=e=>i(e)&&"string"==typeof e.encrypted_key&&(void 0===e.header||i(e.header)),y=e=>!(!Array.isArray(e.recipients)||!e.recipients.every(l)),u=e=>{if("string"==typeof e&&5===e.split(".").length)return"compact";if(p(e)){if(y(e))return"general";if(s(e))return"flattened"}throw new n("JWE malformed or invalid serialization")};module.exports={compact:d,flattened:c,general:a,detect:u};
},{"../help/is_object":"KEHe","../help/validate_crit":"eWLC","../errors":"aYsl"}],"zuzw":[function(require,module,exports) {
const{randomBytes:e}=require("crypto"),{createSecretKey:r}=require("../help/key_object"),{KEYLENGTHS:t}=require("../registry"),c=require("../jwk/key/oct");module.exports=(o=>{const n=t.get(o);return n?new c(r(e(n/8)),{use:"enc",alg:o}):new c({type:"secret"})});
},{"../help/key_object":"v3aG","../registry":"Hjk2","../jwk/key/oct":"aMM4"}],"bhcV":[function(require,module,exports) {
module.exports=((e={},s={})=>{const t=Object.keys(e),o=new Set(Object.keys(s));return!t.some(e=>o.has(e))});
},{}],"JjXy":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach(function(e){r(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const n=require("../help/is_disjoint"),o=require("../help/base64url");let i=require("../help/validate_crit");const{JWEInvalid:c,JOSENotSupported:a}=require("../errors");i=i.bind(void 0,c),module.exports=((e,r,s,l,p)=>{if("string"==typeof e)try{e=o.JSON.decode(e)}catch(h){throw new c("could not parse JWE protected header")}let d=[];const u=new Set;if(!n(e,r)||!s.every(({header:o})=>{"object"==typeof o&&(d.push(o.alg),u.add(o.enc));const s=t(t({},r),o);if(i(e,s,p),"zip"in s)throw new c('"zip" Header Parameter MUST be integrity protected');if(e&&"zip"in e&&"DEF"!==e.zip)throw new a('only "DEF" compression algorithm is supported');return n(o,e)&&n(o,r)}))throw new c("JWE Shared Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");if("object"==typeof e&&(d.push(e.alg),u.add(e.enc)),"object"==typeof r&&(d.push(r.alg),u.add(r.enc)),d=d.filter(Boolean),u.delete(void 0),1!==s.length&&(d.includes("dir")||d.includes("ECDH-ES")))throw new c("dir and ECDH-ES alg may only be used with a single recipient");if(l){if(d.length!==s.length)throw new c("missing Key Management algorithm");if(0===u.size)throw new c("missing Content Encryption algorithm");if(1!==u.size)throw new c("there must only be one Content Encryption algorithm")}else if(u.size>1)throw new c("there must only be one Content Encryption algorithm");return[...u][0]});
},{"../help/is_disjoint":"bhcV","../help/base64url":"xoPC","../help/validate_crit":"eWLC","../errors":"aYsl"}],"BaSL":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function t(t){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?e(Object(o),!0).forEach(function(e){r(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{deflateRawSync:i}=require("zlib"),{KEYOBJECT:o}=require("../help/consts"),n=require("../help/generate_iv"),c=require("../help/base64url"),s=require("../help/get_key"),a=require("../help/is_object"),{createSecretKey:p}=require("../help/key_object"),d=require("../help/deep_clone"),h=require("../jwk/import"),{JWEInvalid:u}=require("../errors"),{check:f,keyManagementEncrypt:l,encrypt:_}=require("../jwa"),g=require("./serializers"),y=require("./generate_cek"),w=require("./validate_headers"),b=Symbol("PROCESS_RECIPIENT");class m{constructor(e,t,r,i){if(!Buffer.isBuffer(e)&&"string"!=typeof e)throw new TypeError("cleartext argument must be a Buffer or a string");if(e=Buffer.from(e),void 0!==r&&!Buffer.isBuffer(r)&&"string"!=typeof r)throw new TypeError("aad argument must be a Buffer or a string when provided");if(r=r?Buffer.from(r):void 0,void 0!==t&&!a(t))throw new TypeError("protectedHeader argument must be a plain object when provided");if(void 0!==i&&!a(i))throw new TypeError("unprotectedHeader argument must be a plain object when provided");this._recipients=[],this._cleartext=e,this._aad=r,this._unprotected=i?d(i):void 0,this._protected=t?d(t):void 0}recipient(e,t){if(e=s(e),void 0!==t&&!a(t))throw new TypeError("header argument must be a plain object when provided");return this._recipients.push({key:e,header:t?d(t):void 0}),this}[b](e){const r=this._unprotected,i=this._protected,{length:n}=this._recipients,s=t(t(t({},i),r),e.header),{key:a}=e,d=s.enc;let _,g,y=s.alg;if("sig"===a.use)throw new TypeError('a key with "use":"sig" is not usable for encryption');if("dir"===y)f(a,"encrypt",d);else if(y)f(a,"keyManagementEncrypt",y);else{if("ECDH-ES"===(y=a.alg||[...a.algorithms("wrapKey")][0]||[...a.algorithms("deriveKey")][0])&&1!==n&&(y=[...a.algorithms("deriveKey")][1]),!y)throw new u('could not resolve a usable "alg" for a recipient');1===n?i?i.alg=y:this._protected={alg:y}:e.header?e.header.alg=y:e.header={alg:y}}"oct"===a.kty&&"dir"===y?this._cek=h(a[o],{use:"enc",alg:d}):(f(this._cek,"encrypt",d),({wrapped:_,header:g}=l(y,a,this._cek[o].export(),{enc:d,alg:y})),"ECDH-ES"===y&&(this._cek=h(p(_),{use:"enc",alg:d}))),e.encrypted_key="dir"===y||"ECDH-ES"===y?"":c.encodeBuffer(_),g&&(e.generatedHeader=g)}encrypt(e){const r=g[e];if(!r)throw new TypeError('serialization must be one of "compact", "flattened", "general"');if(!this._recipients.length)throw new u("missing recipients");r.validate(this._protected,this._unprotected,this._aad,this._recipients);let o=w(this._protected,this._unprotected,this._recipients,!1,this._protected?this._protected.crit:void 0);o||(o="A128CBC-HS256",this._protected?this._protected.enc=o:this._protected={enc:o});const s={};this._cek=y(o);for(const t of this._recipients)this[b](t);const a=n(o);if(s.iv=c.encodeBuffer(a),1===this._recipients.length&&this._recipients[0].generatedHeader){const[{generatedHeader:e}]=this._recipients;delete this._recipients[0].generatedHeader,this._protected=t(t({},this._protected),e)}let p;this._protected&&(s.protected=c.JSON.encode(this._protected)),s.unprotected=this._unprotected,this._aad?(s.aad=c.encode(this._aad),p=Buffer.concat([Buffer.from(s.protected||""),Buffer.from("."),Buffer.from(s.aad)])):p=Buffer.from(s.protected||"");let d=this._cleartext;this._protected&&"zip"in this._protected&&(d=i(d));const{ciphertext:h,tag:f}=_(o,this._cek,d,{iv:a,aad:p});return s.tag=c.encodeBuffer(f),s.ciphertext=c.encodeBuffer(h),r(s,this._recipients)}}module.exports=m;
},{"../help/consts":"xufk","../help/generate_iv":"ZWaW","../help/base64url":"xoPC","../help/get_key":"FEWd","../help/is_object":"KEHe","../help/key_object":"v3aG","../help/deep_clone":"TDeS","../jwk/import":"xpG4","../errors":"aYsl","../jwa":"nj8c","./serializers":"e9J4","./generate_cek":"zuzw","./validate_headers":"JjXy"}],"sDKB":[function(require,module,exports) {
const e=require("./keystore");module.exports=e;
},{"./keystore":"YOP0"}],"I6Ky":[function(require,module,exports) {
const e=["recipients"],t=["recipients"];function r(e,t){if(null==e)return{};var r,n,i=o(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function o(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{inflateRawSync:a}=require("zlib"),s=require("../help/base64url"),f=require("../help/get_key"),{KeyStore:p}=require("../jwks"),l=require("../errors"),{check:d,decrypt:y,keyManagementDecrypt:u}=require("../jwa"),g=require("../jwk"),{createSecretKey:h}=require("../help/key_object"),m=require("./generate_cek"),w=require("./validate_headers"),{detect:v}=require("./serializers"),b=new Set(["compact","flattened"]),O=(e={},t={},r={})=>{"string"==typeof e&&(e=s.JSON.decode(e));const o=e.p2s||t.p2s||r.p2s,n=e.apu||t.apu||r.apu,c=e.apv||t.apv||r.apv,a=e.iv||t.iv||r.iv,f=e.tag||t.tag||r.tag;return i(i(i(i(i(i(i(i({},e),t),r),"string"==typeof o?{p2s:s.decodeToBuffer(o)}:void 0),"string"==typeof n?{apu:s.decodeToBuffer(n)}:void 0),"string"==typeof c?{apv:s.decodeToBuffer(c)}:void 0),"string"==typeof a?{iv:s.decodeToBuffer(a)}:void 0),"string"==typeof f?{tag:s.decodeToBuffer(f)}:void 0)},k=(e,t)=>{if(void 0!==e&&(!Array.isArray(e)||e.some(e=>"string"!=typeof e||!e)))throw new TypeError(`"${t}" option must be an array of non-empty strings`);if(e)return new Set(e)},E=(o,n,c,j,{crit:S=[],complete:A=!1,keyManagementAlgorithms:B,contentEncryptionAlgorithms:J}={})=>{if(j=f(j,!0),B=k(B,"keyManagementAlgorithms"),J=k(J,"contentEncryptionAlgorithms"),!Array.isArray(S)||S.some(e=>"string"!=typeof e||!e))throw new TypeError('"crit" option must be an array of non-empty strings');let K,q,D,M,P,T,W,N,_,x,F,z;if(n||(n=v(c)),"general"===n&&1===c.recipients.length){n="flattened";const{recipients:t}=c;c=i(i({},r(c,e)),t[0])}if(b.has(n)){if("compact"===n?[W,M,P,q,N]=c.split("."):({protected:W,encrypted_key:M,iv:P,ciphertext:q,tag:N,unprotected:_,aad:F,header:z}=c),o||w(W,_,[{header:z}],!0,S),T=O(W,_,z),({alg:K,enc:D}=T),B&&!B.has(K))throw new l.JOSEAlgNotWhitelisted("key management algorithm not whitelisted");if(J&&!J.has(D))throw new l.JOSEAlgNotWhitelisted("content encryption algorithm not whitelisted");if(j instanceof p){const e=j;let t;switch((t="dir"===T.alg?e.all({kid:T.kid,alg:T.enc,key_ops:["decrypt"]}):e.all({kid:T.kid,alg:T.alg,key_ops:["unwrapKey"]})).length){case 0:throw new l.JWKSNoMatchingKey;case 1:j=t[0];break;default:{const e=[];for(const o of t)try{return E(!0,n,c,o,{crit:S,complete:A,contentEncryptionAlgorithms:J?[...J]:void 0,keyManagementAlgorithms:B?[...B]:void 0})}catch($){e.push($);continue}const r=new l.JOSEMultiError(e);if([...r].some(e=>e instanceof l.JWEDecryptionFailed))throw new l.JWEDecryptionFailed;throw r}}}d(j,..."dir"===K?["decrypt",D]:["keyManagementDecrypt",K]);try{if("dir"===K)x=g.asKey(j,{alg:D,use:"enc"});else if("ECDH-ES"===K){const e=u(K,j,void 0,T);x=g.asKey(h(e),{alg:D,use:"enc"})}else{const e=u(K,j,s.decodeToBuffer(M),T);x=g.asKey(h(e),{alg:D,use:"enc"})}}catch($){x=m(D)}let e;e=F?Buffer.concat([Buffer.from(W||""),Buffer.from("."),Buffer.from(F)]):Buffer.from(W||"");try{P=s.decodeToBuffer(P)}catch($){}try{N=s.decodeToBuffer(N)}catch($){}let t=y(D,x,s.decodeToBuffer(q),{iv:P,tag:N,aad:e});if(T.zip&&(t=a(t)),A){const e={cleartext:t,key:j,cek:x};return F&&(e.aad=F),z&&(e.header=z),_&&(e.unprotected=_),W&&(e.protected=s.JSON.decode(W)),e}return t}w(c.protected,c.unprotected,c.recipients.map(({header:e})=>({header:e})),!0,S);const{recipients:C}=c,H=r(c,t),I=[];for(const e of C)try{return E(!0,"flattened",i(i({},H),e),j,{crit:S,complete:A,contentEncryptionAlgorithms:J?[...J]:void 0,keyManagementAlgorithms:B?[...B]:void 0})}catch($){I.push($);continue}const R=new l.JOSEMultiError(I);if([...R].some(e=>e instanceof l.JWEDecryptionFailed))throw new l.JWEDecryptionFailed;if([...R].every(e=>e instanceof l.JWKSNoMatchingKey))throw new l.JWKSNoMatchingKey;throw R};module.exports=E.bind(void 0,!1,void 0);
},{"../help/base64url":"xoPC","../help/get_key":"FEWd","../jwks":"sDKB","../errors":"aYsl","../jwa":"nj8c","../jwk":"BoJ9","../help/key_object":"v3aG","./generate_cek":"zuzw","./validate_headers":"JjXy","./serializers":"e9J4"}],"OV0E":[function(require,module,exports) {
const e=require("./encrypt"),r=require("./decrypt"),t=(r,t,n,d,o,p)=>new e(t,d,o,p).recipient(n).encrypt(r);module.exports.Encrypt=e,module.exports.encrypt=t.bind(void 0,"compact"),module.exports.encrypt.flattened=t.bind(void 0,"flattened"),module.exports.encrypt.general=t.bind(void 0,"general"),module.exports.decrypt=r;
},{"./encrypt":"BaSL","./decrypt":"I6Ky"}],"vsbZ":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function t(t){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?e(Object(i),!0).forEach(function(e){r(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=require("../help/is_object");let i=require("../help/validate_crit");const{JWSInvalid:n}=require("../errors");i=i.bind(void 0,n);const a=(e,[t])=>`${t.protected}.${e}.${t.signature}`;a.validate=((e,{0:{unprotectedHeader:t,protectedHeader:r},length:o})=>{if(1!==o||t)throw new n("JWS Compact Serialization doesn't support multiple recipients or JWS unprotected headers");i(r,t,r?r.crit:void 0)});const c=(e,[r])=>{const{header:o,signature:i,protected:n}=r;return t(t(t({payload:e},n?{protected:n}:void 0),o?{header:o}:void 0),{},{signature:i})};c.validate=((e,{0:{unprotectedHeader:t,protectedHeader:r},length:o})=>{if(1!==o)throw new n("Flattened JWS JSON Serialization doesn't support multiple recipients");i(r,t,r?r.crit:void 0)});const d=(e,r)=>({payload:e,signatures:r.map(({header:e,signature:r,protected:o})=>t(t(t({},o?{protected:o}:void 0),e?{header:e}:void 0),{},{signature:r}))});d.validate=((e,t)=>{let r=!1;if(t.forEach(({protectedHeader:e,unprotectedHeader:t})=>{e&&!r&&"b64"in e&&(r=!0),i(e,t,e?e.crit:void 0)}),r){if(!t.map(({protectedHeader:e})=>e&&e.b64).every((e,t,[r])=>e===r))throw new n('the "b64" Header Parameter value MUST be the same for all recipients')}});const p=e=>o(e)&&("string"==typeof e.payload||Buffer.isBuffer(e.payload)),s=e=>o(e)&&"string"==typeof e.signature&&(void 0===e.header||o(e.header))&&(void 0===e.protected||"string"==typeof e.protected),l=e=>!(!Array.isArray(e.signatures)||!e.signatures.every(s)),u=e=>{if("string"==typeof e&&3===e.split(".").length)return"compact";if(p(e)){if(l(e))return"general";if(s(e))return"flattened"}throw new n("JWS malformed or invalid serialization")};module.exports={compact:a,flattened:c,general:d,detect:u};
},{"../help/is_object":"KEHe","../help/validate_crit":"eWLC","../errors":"aYsl"}],"G4nJ":[function(require,module,exports) {
const e=require("../help/base64url"),r=require("../help/is_disjoint"),t=require("../help/is_object"),o=require("../help/deep_clone"),{JWSInvalid:i}=require("../errors"),{sign:n}=require("../jwa"),s=require("../help/get_key"),a=require("./serializers"),d=Symbol("PROCESS_RECIPIENT");class c{constructor(r){if("string"==typeof r)r=e.encode(r);else if(Buffer.isBuffer(r))r=e.encodeBuffer(r),this._binary=!0;else{if(!t(r))throw new TypeError("payload argument must be a Buffer, string or an object");r=e.JSON.encode(r)}this._payload=r,this._recipients=[]}recipient(e,n,a){if(e=s(e),void 0!==n&&!t(n))throw new TypeError("protectedHeader argument must be a plain object when provided");if(void 0!==a&&!t(a))throw new TypeError("unprotectedHeader argument must be a plain object when provided");if(!r(n,a))throw new i("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");return this._recipients.push({key:e,protectedHeader:n?o(n):void 0,unprotectedHeader:a?o(a):void 0}),this}[d](r,t){const{key:o,protectedHeader:s,unprotectedHeader:a}=r;if("enc"===o.use)throw new TypeError('a key with "use":"enc" is not usable for signing');const d={protected:s||{},unprotected:a||{}};let c=d.protected.alg||d.unprotected.alg;if(c||(c=o.alg||[...o.algorithms("sign")][0],r.protectedHeader?d.protected.alg=r.protectedHeader.alg=c:d.protected=r.protectedHeader={alg:c}),!c)throw new i('could not resolve a usable "alg" for a recipient');r.header=a,r.protected=Object.keys(d.protected).length?e.JSON.encode(d.protected):"",t&&d.protected.crit&&d.protected.crit.includes("b64")&&!1===d.protected.b64&&(this._binary?this._payload=e.decodeToBuffer(this._payload):this._payload=e.decode(this._payload));const p=Buffer.concat([Buffer.from(r.protected||""),Buffer.from("."),Buffer.from(this._payload)]);r.signature=e.encodeBuffer(n(c,o,p))}sign(e){const r=a[e];if(!r)throw new TypeError('serialization must be one of "compact", "flattened", "general"');if(!this._recipients.length)throw new i("missing recipients");return r.validate(this,this._recipients),this._recipients.forEach((e,r)=>{this[d](e,0===r)}),r(this._payload,this._recipients)}}module.exports=c;
},{"../help/base64url":"xoPC","../help/is_disjoint":"bhcV","../help/is_object":"KEHe","../help/deep_clone":"TDeS","../errors":"aYsl","../jwa":"nj8c","../help/get_key":"FEWd","./serializers":"vsbZ"}],"ylWA":[function(require,module,exports) {
const e=["signatures"],r=["signatures"];function t(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function i(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach(function(r){o(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e,r){if(null==e)return{};var t,i,o=a(e,r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function a(e,r){if(null==e)return{};var t,i,o={},n=Object.keys(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||(o[t]=e[t]);return o}const{EOL:c}=require("os"),s=require("../help/base64url"),f=require("../help/is_disjoint"),l=require("../help/is_object");let u=require("../help/validate_crit");const d=require("../help/get_key"),{KeyStore:p}=require("../jwks"),y=require("../errors"),{check:h,verify:w}=require("../jwa"),g=require("../jwk"),{detect:b}=require("./serializers");u=u.bind(void 0,y.JWSInvalid);const m=new Set(["compact","flattened","preparsed"]),S=(t,o,a,O,{crit:J=[],complete:j=!1,algorithms:v}={})=>{if(O=d(O,!0),void 0!==v&&(!Array.isArray(v)||v.some(e=>"string"!=typeof e||!e)))throw new TypeError('"algorithms" option must be an array of non-empty strings');if(v&&(v=new Set(v)),!Array.isArray(J)||J.some(e=>"string"!=typeof e||!e))throw new TypeError('"crit" option must be an array of non-empty strings');let W,k,E,P,I,q;if(o||(o=b(a)),"general"===o&&1===a.signatures.length){o="flattened";const{signatures:r}=a;a=i(i({},n(a,e)),r[0])}if(m.has(o)){let e={};switch(o){case"compact":[W,E,P]=a.split(".");break;case"flattened":({protected:W,payload:E,signature:P,header:k}=a);break;case"preparsed":({decoded:q}=a),[W,E,P]=a.token.split(".")}if(k||(t=!0),q)e=q.header;else if(W)try{e=s.JSON.decode(W)}catch(N){throw new y.JWSInvalid("could not parse JWS protected header")}else t=t||!0;if(!t&&!f(e,k))throw new y.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r=i(i({},e),k);if(u(e,k,J),!(I=e.alg||k&&k.alg))throw new y.JWSInvalid("missing JWS signature algorithm");if(v&&!v.has(I))throw new y.JOSEAlgNotWhitelisted("alg not whitelisted");if(O instanceof p){const e=O.all({kid:r.kid,alg:r.alg,key_ops:["verify"]});switch(e.length){case 0:throw new y.JWKSNoMatchingKey;case 1:O=e[0];break;default:{const r=[];for(const i of e)try{return S(!0,o,a,i,{crit:J,complete:j,algorithms:v?[...v]:void 0})}catch(N){r.push(N);continue}const t=new y.JOSEMultiError(r);if([...t].some(e=>e instanceof y.JWSVerificationFailed))throw new y.JWSVerificationFailed;throw t}}}if(O===g.EmbeddedJWK){if(!l(r.jwk))throw new y.JWSInvalid('JWS Header Parameter "jwk" must be a JSON object');if("public"!==(O=g.asKey(r.jwk)).type)throw new y.JWSInvalid('JWS Header Parameter "jwk" must be a public key')}else if(O===g.EmbeddedX5C){if(!Array.isArray(r.x5c)||!r.x5c.length||r.x5c.some(e=>"string"!=typeof e||!e))throw new y.JWSInvalid('JWS Header Parameter "x5c" must be a JSON array of certificate value strings');O=g.asKey(`-----BEGIN CERTIFICATE-----${c}${(r.x5c[0].match(/.{1,64}/g)||[]).join(c)}${c}-----END CERTIFICATE-----`,{x5c:r.x5c})}h(O,"verify",I);const n=Buffer.concat([Buffer.from(W||""),Buffer.from("."),Buffer.isBuffer(E)?E:Buffer.from(E)]);if(!w(I,O,n,s.decodeToBuffer(P)))throw new y.JWSVerificationFailed;if(E=!1===r.b64?Buffer.from(E):s.decodeToBuffer(E),j){const r={payload:E,key:O};return W&&(r.protected=e),k&&(r.header=k),r}return E}const{signatures:x}=a,B=n(a,r),K=[];for(const e of x)try{return S(!1,"flattened",i(i({},B),e),O,{crit:J,complete:j,algorithms:v?[...v]:void 0})}catch(N){K.push(N);continue}const A=new y.JOSEMultiError(K);if([...A].some(e=>e instanceof y.JWSVerificationFailed))throw new y.JWSVerificationFailed;if([...A].every(e=>e instanceof y.JWKSNoMatchingKey))throw new y.JWKSNoMatchingKey;throw A};module.exports={bare:S,verify:S.bind(void 0,!1,void 0)};
},{"../help/base64url":"xoPC","../help/is_disjoint":"bhcV","../help/is_object":"KEHe","../help/validate_crit":"eWLC","../help/get_key":"FEWd","../jwks":"sDKB","../errors":"aYsl","../jwa":"nj8c","../jwk":"BoJ9","./serializers":"vsbZ"}],"A6ZO":[function(require,module,exports) {
const e=require("./sign"),{verify:i}=require("./verify"),n=(i,n,o,r,d)=>new e(n).recipient(o,r,d).sign(i);module.exports.Sign=e,module.exports.sign=n.bind(void 0,"compact"),module.exports.sign.flattened=n.bind(void 0,"flattened"),module.exports.sign.general=n.bind(void 0,"general"),module.exports.verify=i;
},{"./sign":"G4nJ","./verify":"ylWA"}],"ptYb":[function(require,module,exports) {
const e=require("../help/base64url"),r=require("../errors");module.exports=((o,{complete:t=!1}={})=>{if("string"!=typeof o||!o)throw new TypeError("JWT must be a string");const{0:n,1:s,2:d,length:a}=o.split(".");if(5===a)throw new TypeError("encrypted JWTs cannot be decoded");if(3!==a)throw new r.JWTMalformed("JWTs must have three components");try{const o={header:e.JSON.decode(n),payload:e.JSON.decode(s),signature:d};return t?o:o.payload}catch(c){throw new r.JWTMalformed("JWT is malformed")}});
},{"../help/base64url":"xoPC","../errors":"aYsl"}],"MglG":[function(require,module,exports) {
const e=60,s=3600,a=86400,r=7*a,c=31557600,n=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;module.exports=(e=>{const s=n.exec(e);if(!s)throw new TypeError(`invalid time period format ("${e}")`);const t=parseFloat(s[1]);switch(s[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(t);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*t);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*t);case"day":case"days":case"d":return Math.round(t*a);case"week":case"weeks":case"w":return Math.round(t*r);case"year":case"years":case"yr":case"yrs":case"y":return Math.round(t*c)}});
},{}],"fpOy":[function(require,module,exports) {
module.exports=(e=>Math.floor(e.getTime()/1e3));
},{}],"VfnO":[function(require,module,exports) {
const{JWTClaimInvalid:i}=require("../errors"),s=i=>"string"!=typeof i||0===i.length,r=i=>!Array.isArray(i)||0===i.length||i.some(s),n=(i,s,r,n)=>{if(void 0===s)throw new i(`${r} is missing`,n,"missing")},t=(i,r,t,e,o=!1)=>{if(o&&n(i,r,t,e),void 0!==r&&s(r))throw new i(`${t} must be a string`,e,"invalid")},e=(s,r,n=!1)=>{if(n&&void 0===s)throw new i(`"${r}" claim is missing`,r,"missing");if(void 0!==s&&"number"!=typeof s)throw new i(`"${r}" claim must be a JSON numeric value`,r,"invalid")},o=(n,t,e=!1)=>{if(e&&void 0===n)throw new i(`"${t}" claim is missing`,t,"missing");if(void 0!==n&&s(n)&&r(n))throw new i(`"${t}" claim must be a string or array of strings`,t,"invalid")};module.exports={isNotArrayOfStrings:r,isRequired:n,isNotString:s,isString:t,isTimestamp:e,isStringOrArrayOfStrings:o};
},{"../errors":"aYsl"}],"sBoZ":[function(require,module,exports) {
function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function r(r){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?e(Object(i),!0).forEach(function(e){t(r,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const o=require("../help/is_object"),i=require("../help/secs"),n=require("../help/epoch"),s=require("../help/get_key"),a=require("../jws"),p=require("./shared_validations").isString.bind(void 0,TypeError),u=e=>{if("boolean"!=typeof e.iat)throw new TypeError("options.iat must be a boolean");if("boolean"!=typeof e.kid)throw new TypeError("options.kid must be a boolean");if(p(e.subject,"options.subject"),p(e.issuer,"options.issuer"),void 0!==e.audience&&("string"!=typeof e.audience||!e.audience)&&(!Array.isArray(e.audience)||0===e.audience.length||e.audience.some(e=>!e||"string"!=typeof e)))throw new TypeError("options.audience must be a string or an array of strings");if(!o(e.header))throw new TypeError("options.header must be an object");if(p(e.algorithm,"options.algorithm"),p(e.expiresIn,"options.expiresIn"),p(e.notBefore,"options.notBefore"),p(e.jti,"options.jti"),!(void 0===e.now||e.now instanceof Date&&e.now.getTime()))throw new TypeError("options.now must be a valid Date object")};module.exports=((e,t,p={})=>{if(!o(p))throw new TypeError("options must be an object");const{algorithm:c,audience:b,expiresIn:f,header:d={},iat:l=!0,issuer:y,jti:w,kid:j=!0,notBefore:h,subject:g,now:O}=p;if(u({algorithm:c,audience:b,expiresIn:f,header:d,iat:l,issuer:y,jti:w,kid:j,notBefore:h,now:O,subject:g}),!o(e))throw new TypeError("payload must be an object");let m,k;return(f||h||l)&&(m=n(O||new Date)),e=r(r({},e),{},{sub:g||e.sub,aud:b||e.aud,iss:y||e.iss,jti:w||e.jti,iat:l?m:e.iat,exp:f?m+i(f):e.exp,nbf:h?m+i(h):e.nbf}),t=s(t),k="boolean"==typeof p.kid?j:!t.secret,a.sign(JSON.stringify(e),t,r(r({},d),{},{alg:c||d.alg,kid:k?t.kid:d.kid}))});
},{"../help/is_object":"KEHe","../help/secs":"MglG","../help/epoch":"fpOy","../help/get_key":"FEWd","../jws":"A6ZO","./shared_validations":"VfnO"}],"zJQc":[function(require,module,exports) {
const e=require("../help/is_object"),i=require("../help/epoch"),o=require("../help/secs"),t=require("../help/get_key"),{bare:a}=require("../jws/verify"),{JWTClaimInvalid:r,JWTExpired:n}=require("../errors"),{isString:s,isNotString:p,isNotArrayOfStrings:c,isTimestamp:l,isStringOrArrayOfStrings:d}=require("./shared_validations"),f=require("./decode"),u=s.bind(void 0,r),h=s.bind(void 0,TypeError),m=e=>e.toLowerCase().replace(/^application\//,""),y=({algorithms:e,audience:i,clockTolerance:o,complete:t=!1,crit:a,ignoreExp:r=!1,ignoreIat:n=!1,ignoreNbf:s=!1,issuer:l,jti:d,maxTokenAge:f,now:u=new Date,subject:m,typ:y})=>{if("boolean"!=typeof t)throw new TypeError("options.complete must be a boolean");if("boolean"!=typeof r)throw new TypeError("options.ignoreExp must be a boolean");if("boolean"!=typeof s)throw new TypeError("options.ignoreNbf must be a boolean");if("boolean"!=typeof n)throw new TypeError("options.ignoreIat must be a boolean");if(h(f,"options.maxTokenAge"),h(m,"options.subject"),h(d,"options.jti"),h(o,"options.clockTolerance"),h(y,"options.typ"),void 0!==l&&p(l)&&c(l))throw new TypeError("options.issuer must be a string or an array of strings");if(void 0!==i&&p(i)&&c(i))throw new TypeError("options.audience must be a string or an array of strings");if(void 0!==e&&c(e))throw new TypeError("options.algorithms must be an array of strings");if(!(u instanceof Date&&u.getTime()))throw new TypeError("options.now must be a valid Date object");if(n&&void 0!==f)throw new TypeError("options.ignoreIat and options.maxTokenAge cannot used together");if(void 0!==a&&c(a))throw new TypeError("options.crit must be an array of strings");return{algorithms:e,audience:i,clockTolerance:o,complete:t,crit:a,ignoreExp:r,ignoreIat:n,ignoreNbf:s,issuer:l,jti:d,maxTokenAge:f,now:u,subject:m,typ:y}},w=({header:e,payload:i},o)=>{u(e.alg,'"alg" header parameter',"alg",!0),l(i.iat,"iat",!!o.maxTokenAge),l(i.exp,"exp"),l(i.nbf,"nbf"),u(i.jti,'"jti" claim',"jti",!!o.jti),d(i.iss,"iss",!!o.issuer),u(i.sub,'"sub" claim',"sub",!!o.subject),d(i.aud,"aud",!!o.audience),u(e.typ,'"typ" header parameter',"typ",!!o.typ)},b=(e,i)=>"string"==typeof e?i.includes(e):(e=new Set(e),i.some(Set.prototype.has.bind(e)));module.exports=((s,p,c={})=>{if(!e(c))throw new TypeError("options must be an object");const{algorithms:l,audience:d,clockTolerance:u,complete:h,crit:g,ignoreExp:k,ignoreIat:T,ignoreNbf:x,issuer:j,jti:E,maxTokenAge:v,now:_,subject:q,typ:A}=c=y(c),S=f(s,{complete:!0});p=t(p,!0),h?(({key:p}=a(!0,"preparsed",{decoded:S,token:s},p,{crit:g,algorithms:l,complete:!0})),S.key=p):a(!0,"preparsed",{decoded:S,token:s},p,{crit:g,algorithms:l});const I=i(_);if(w(S,c),j&&("string"!=typeof S.payload.iss||!("string"==typeof j?[j]:j).includes(S.payload.iss)))throw new r('unexpected "iss" claim value',"iss","check_failed");if(q&&S.payload.sub!==q)throw new r('unexpected "sub" claim value',"sub","check_failed");if(E&&S.payload.jti!==E)throw new r('unexpected "jti" claim value',"jti","check_failed");if(d&&!b(S.payload.aud,"string"==typeof d?[d]:d))throw new r('unexpected "aud" claim value',"aud","check_failed");if(A&&m(S.header.typ)!==m(A))throw new r('unexpected "typ" JWT header value',"typ","check_failed");const N=u?o(u):0;if(!T&&!("exp"in S.payload)&&"iat"in S.payload&&S.payload.iat>I+N)throw new r('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed");if(!x&&"nbf"in S.payload&&S.payload.nbf>I+N)throw new r('"nbf" claim timestamp check failed',"nbf","check_failed");if(!k&&"exp"in S.payload&&S.payload.exp<=I-N)throw new n('"exp" claim timestamp check failed',"exp","check_failed");if(v){const e=I-S.payload.iat;if(e-N>o(v))throw new n('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-N)throw new r('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return h?S:S.payload});
},{"../help/is_object":"KEHe","../help/epoch":"fpOy","../help/secs":"MglG","../help/get_key":"FEWd","../jws/verify":"ylWA","../errors":"aYsl","./shared_validations":"VfnO","./decode":"ptYb"}],"VfHw":[function(require,module,exports) {
function e(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function t(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?e(Object(a),!0).forEach(function(e){i(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const{JWTClaimInvalid:n}=require("../errors"),a=require("../help/secs"),r=require("../help/epoch"),o=require("../help/is_object"),c=require("./verify"),{isString:s,isRequired:l,isTimestamp:u,isStringOrArrayOfStrings:m}=require("./shared_validations"),h=l.bind(void 0,n),p=s.bind(void 0,n),d=s.bind(void 0,TypeError),b=(e,t,i,n)=>{Object.defineProperty(e,t,{enumerable:!0,configurable:!0,value:(...a)=>(process.emitWarning(`The ${i} API implements an IETF draft. Breaking draft implementations are included as minor versions of the jose library, therefore, the ~ semver operator should be used and close attention be payed to library changelog as well as the drafts themselves.`,"DraftWarning"),Object.defineProperty(e,t,{enumerable:!0,configurable:!0,value:n}),e[t](...a))})},f=(e,t)=>{if(!o(e))throw new TypeError("options must be an object");if(!e.issuer)throw new TypeError(`"issuer" option is required to validate ${t}`);if(!e.audience)throw new TypeError(`"audience" option is required to validate ${t}`)};module.exports={IdToken:{verify:(e,i,o={})=>{f(o,"an ID Token"),"maxAuthAge"in o&&d(o.maxAuthAge,"options.maxAuthAge"),"nonce"in o&&d(o.nonce,"options.nonce");const s=r(o.now||new Date),l=c(e,i,t({},o)),b=o.complete?l.payload:l;if(Array.isArray(b.aud)&&b.aud.length>1&&h(b.azp,'"azp" claim',"azp"),h(b.iat,'"iat" claim',"iat"),h(b.sub,'"sub" claim',"sub"),h(b.exp,'"exp" claim',"exp"),u(b.auth_time,"auth_time",!!o.maxAuthAge),p(b.nonce,'"nonce" claim',"nonce",!!o.nonce),p(b.acr,'"acr" claim',"acr"),m(b.amr,"amr"),o.nonce&&b.nonce!==o.nonce)throw new n('unexpected "nonce" claim value',"nonce","check_failed");const v=o.clockTolerance?a(o.clockTolerance):0;if(o.maxAuthAge){const e=a(o.maxAuthAge);if(b.auth_time+e<s-v)throw new n('"auth_time" claim timestamp check failed (too much time has elapsed since the last End-User authentication)',"auth_time","check_failed")}if(Array.isArray(b.aud)&&b.aud.length>1&&b.azp!==o.audience)throw new n('unexpected "azp" claim value',"azp","check_failed");return l}},LogoutToken:{},AccessToken:{}},b(module.exports.LogoutToken,"verify","jose.JWT.LogoutToken.verify",(e,i,a={})=>{f(a,"a Logout Token");const r=c(e,i,t({},a)),s=a.complete?r.payload:r;if(h(s.iat,'"iat" claim',"iat"),h(s.jti,'"jti" claim',"jti"),p(s.sid,'"sid" claim',"sid"),!("sid"in s||"sub"in s))throw new n('either "sid" or "sub" (or both) claims must be present');if("nonce"in s)throw new n('"nonce" claim is prohibited',"nonce","prohibited");if(!("events"in s))throw new n('"events" claim is missing',"events","missing");if(!o(s.events))throw new n('"events" claim must be an object',"events","invalid");if(!("http://schemas.openid.net/event/backchannel-logout"in s.events))throw new n('"http://schemas.openid.net/event/backchannel-logout" member is missing in the "events" claim',"events","invalid");if(!o(s.events["http://schemas.openid.net/event/backchannel-logout"]))throw new n('"http://schemas.openid.net/event/backchannel-logout" member in the "events" claim must be an object',"events","invalid");return r}),b(module.exports.AccessToken,"verify","jose.JWT.AccessToken.verify",(e,i,o={})=>{f(o,"a JWT Access Token"),d(o.maxAuthAge,"options.maxAuthAge");const s=r(o.now||new Date),l=c(e,i,t(t({},o),{},{typ:"at+JWT"})),b=o.complete?l.payload:l;h(b.iat,'"iat" claim',"iat"),h(b.exp,'"exp" claim',"exp"),h(b.sub,'"sub" claim',"sub"),h(b.jti,'"jti" claim',"jti"),p(b.client_id,'"client_id" claim',"client_id",!0),u(b.auth_time,"auth_time",!!o.maxAuthAge),p(b.acr,'"acr" claim',"acr"),m(b.amr,"amr");const v=o.clockTolerance?a(o.clockTolerance):0;if(o.maxAuthAge){const e=a(o.maxAuthAge);if(b.auth_time+e<s-v)throw new n('"auth_time" claim timestamp check failed (too much time has elapsed since the last End-User authentication)',"auth_time","check_failed")}return l});
},{"../errors":"aYsl","../help/secs":"MglG","../help/epoch":"fpOy","../help/is_object":"KEHe","./verify":"zJQc","./shared_validations":"VfnO"}],"hlCH":[function(require,module,exports) {
function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function r(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach(function(e){t(r,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const n=require("./decode"),o=require("./sign"),c=require("./verify"),i=require("./profiles");module.exports=r({sign:o,verify:c},i),Object.defineProperty(module.exports,"decode",{enumerable:!1,configurable:!0,value:n});
},{"./decode":"ptYb","./sign":"sBoZ","./verify":"zJQc","./profiles":"VfHw"}],"rnoB":[function(require,module,exports) {
module.exports={JWE:require("./jwe"),JWK:require("./jwk"),JWKS:require("./jwks"),JWS:require("./jws"),JWT:require("./jwt"),errors:require("./errors")};
},{"./jwe":"OV0E","./jwk":"BoJ9","./jwks":"sDKB","./jws":"A6ZO","./jwt":"hlCH","./errors":"aYsl"}],"NY26":[function(require,module,exports) {
const e=require("jose");function r(r){return e.JWKS.asKeyStore({keys:r},{ignoreErrors:!0}).all({use:"sig"}).map(e=>({kid:e.kid,alg:e.alg,get publicKey(){return e.toPEM(!1)},get rsaPublicKey(){return e.toPEM(!1)},getPublicKey:()=>e.toPEM(!1)}))}module.exports={retrieveSigningKeys:r};
},{"jose":"rnoB"}],"fYDI":[function(require,module,exports) {
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function t(t){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?e(Object(n),!0).forEach(function(e){r(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=require("http"),n=require("https"),s=require("url");module.exports.default=(e=>e.fetcher?e.fetcher(e.uri):new Promise((r,a)=>{const{hostname:c,path:u,port:i,protocol:p}=s.parse(e.uri),b=t(t(t({hostname:c,path:u,port:i,method:"GET"},e.headers&&{headers:t({},e.headers)}),e.timeout&&{timeout:e.timeout}),e.agent&&{agent:e.agent}),d=("https:"===p?n:o).request(b,e=>{let t="";e.setEncoding("utf8"),e.on("data",e=>{t+=e}),e.on("end",()=>{if(e.statusCode<200||e.statusCode>=300){const t=e.body&&(e.body.message||e.body)||e.statusMessage||`Http Error ${e.statusCode}`;a({errorMsg:t})}else try{r(t&&JSON.parse(t))}catch(o){a(o)}})});d.on("timeout",()=>d.destroy()).on("error",e=>a(e)).end()}));
},{}],"VnN0":[function(require,module,exports) {
var t=Object.prototype.hasOwnProperty;function e(t){if(!(this instanceof e))throw new TypeError("Constructor PseudoMap requires 'new'");if(this.clear(),t)if(t instanceof e||"function"==typeof Map&&t instanceof Map)t.forEach(function(t,e){this.set(e,t)},this);else{if(!Array.isArray(t))throw new TypeError("invalid argument");t.forEach(function(t){this.set(t[0],t[1])},this)}}function r(t,e){return t===e||t!=t&&e!=e}function i(t,e,r){this.key=t,this.value=e,this._index=r}function n(e,i){for(var n=0,o="_"+i,a=o;t.call(e,a);a=o+n++)if(r(e[a].key,i))return e[a]}function o(e,n,o){for(var a=0,s="_"+n,u=s;t.call(e,u);u=s+a++)if(r(e[u].key,n))return void(e[u].value=o);e.size++,e[u]=new i(n,o,u)}module.exports=e,e.prototype.forEach=function(t,e){e=e||this,Object.keys(this._data).forEach(function(r){"size"!==r&&t.call(e,this._data[r].value,this._data[r].key)},this)},e.prototype.has=function(t){return!!n(this._data,t)},e.prototype.get=function(t){var e=n(this._data,t);return e&&e.value},e.prototype.set=function(t,e){o(this._data,t,e)},e.prototype.delete=function(t){var e=n(this._data,t);e&&(delete this._data[e._index],this._data.size--)},e.prototype.clear=function(){var t=Object.create(null);t.size=0,Object.defineProperty(this,"_data",{value:t,enumerable:!1,configurable:!0,writable:!1})},Object.defineProperty(e.prototype,"size",{get:function(){return this._data.size},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.values=e.prototype.keys=e.prototype.entries=function(){throw new Error("iterators are not implemented in this version")};
},{}],"e5nj":[function(require,module,exports) {
"pseudomap"===process.env.npm_package_name&&"test"===process.env.npm_lifecycle_script&&(process.env.TEST_PSEUDOMAP="true"),"function"!=typeof Map||process.env.TEST_PSEUDOMAP?module.exports=require("./pseudomap"):module.exports=Map;
},{"./pseudomap":"VnN0"}],"sfWH":[function(require,module,exports) {
function t(e){var i=this;if(i instanceof t||(i=new t),i.tail=null,i.head=null,i.length=0,e&&"function"==typeof e.forEach)e.forEach(function(t){i.push(t)});else if(arguments.length>0)for(var h=0,n=arguments.length;h<n;h++)i.push(arguments[h]);return i}function e(t,e){t.tail=new h(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function i(t,e){t.head=new h(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function h(t,e,i,n){if(!(this instanceof h))return new h(t,e,i,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}module.exports=t,t.Node=h,t.create=t,t.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,i=t.prev;e&&(e.prev=i),i&&(i.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=i),t.list.length--,t.next=null,t.prev=null,t.list=null},t.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},t.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},t.prototype.push=function(){for(var t=0,i=arguments.length;t<i;t++)e(this,arguments[t]);return this.length},t.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)i(this,arguments[t]);return this.length},t.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},t.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},t.prototype.forEach=function(t,e){e=e||this;for(var i=this.head,h=0;null!==i;h++)t.call(e,i.value,h,this),i=i.next},t.prototype.forEachReverse=function(t,e){e=e||this;for(var i=this.tail,h=this.length-1;null!==i;h--)t.call(e,i.value,h,this),i=i.prev},t.prototype.get=function(t){for(var e=0,i=this.head;null!==i&&e<t;e++)i=i.next;if(e===t&&null!==i)return i.value},t.prototype.getReverse=function(t){for(var e=0,i=this.tail;null!==i&&e<t;e++)i=i.prev;if(e===t&&null!==i)return i.value},t.prototype.map=function(e,i){i=i||this;for(var h=new t,n=this.head;null!==n;)h.push(e.call(i,n.value,this)),n=n.next;return h},t.prototype.mapReverse=function(e,i){i=i||this;for(var h=new t,n=this.tail;null!==n;)h.push(e.call(i,n.value,this)),n=n.prev;return h},t.prototype.reduce=function(t,e){var i,h=this.head;if(arguments.length>1)i=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");h=this.head.next,i=this.head.value}for(var n=0;null!==h;n++)i=t(i,h.value,n),h=h.next;return i},t.prototype.reduceReverse=function(t,e){var i,h=this.tail;if(arguments.length>1)i=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");h=this.tail.prev,i=this.tail.value}for(var n=this.length-1;null!==h;n--)i=t(i,h.value,n),h=h.prev;return i},t.prototype.toArray=function(){for(var t=new Array(this.length),e=0,i=this.head;null!==i;e++)t[e]=i.value,i=i.next;return t},t.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,i=this.tail;null!==i;e++)t[e]=i.value,i=i.prev;return t},t.prototype.slice=function(e,i){(i=i||this.length)<0&&(i+=this.length),(e=e||0)<0&&(e+=this.length);var h=new t;if(i<e||i<0)return h;e<0&&(e=0),i>this.length&&(i=this.length);for(var n=0,l=this.head;null!==l&&n<e;n++)l=l.next;for(;null!==l&&n<i;n++,l=l.next)h.push(l.value);return h},t.prototype.sliceReverse=function(e,i){(i=i||this.length)<0&&(i+=this.length),(e=e||0)<0&&(e+=this.length);var h=new t;if(i<e||i<0)return h;e<0&&(e=0),i>this.length&&(i=this.length);for(var n=this.length,l=this.tail;null!==l&&n>i;n--)l=l.prev;for(;null!==l&&n>e;n--,l=l.prev)h.push(l.value);return h},t.prototype.reverse=function(){for(var t=this.head,e=this.tail,i=t;null!==i;i=i.prev){var h=i.prev;i.prev=i.next,i.next=h}return this.head=e,this.tail=t,this};
},{}],"fOR4":[function(require,module,exports) {
module.exports=a;var t,e=require("pseudomap"),n=require("util"),i=require("yallist"),r={},s="function"==typeof Symbol;function h(e,n,i){var s;return r[n]?s=r[n]:(s=t(n),r[n]=s),2===arguments.length?e[s]:(e[s]=i,i)}function o(){return 1}function a(t){if(!(this instanceof a))return new a(t);"number"==typeof t&&(t={max:t}),t||(t={});var e=h(this,"max",t.max);(!e||"number"!=typeof e||e<=0)&&h(this,"max",1/0);var n=t.length||o;"function"!=typeof n&&(n=o),h(this,"lengthCalculator",n),h(this,"allowStale",t.stale||!1),h(this,"maxAge",t.maxAge||0),h(this,"dispose",t.dispose),this.reset()}function l(t,e,n,i){var r=n.value;c(t,r)&&(f(t,n),h(t,"allowStale")||(r=void 0)),r&&e.call(i,r.value,r.key,t)}function u(t,e,n){var i=h(t,"cache").get(e);if(i){var r=i.value;c(t,r)?(f(t,i),h(t,"allowStale")||(r=void 0)):n&&h(t,"lruList").unshiftNode(i),r&&(r=r.value)}return r}function c(t,e){if(!e||!e.maxAge&&!h(t,"maxAge"))return!1;var n=Date.now()-e.now;return e.maxAge?n>e.maxAge:h(t,"maxAge")&&n>h(t,"maxAge")}function p(t){if(h(t,"length")>h(t,"max"))for(var e=h(t,"lruList").tail;h(t,"length")>h(t,"max")&&null!==e;){var n=e.prev;f(t,e),e=n}}function f(t,e){if(e){var n=e.value;h(t,"dispose")&&h(t,"dispose").call(this,n.key,n.value),h(t,"length",h(t,"length")-n.length),h(t,"cache").delete(n.key),h(t,"lruList").removeNode(e)}}function g(t,e,n,i,r){this.key=t,this.value=e,this.length=n,this.now=i,this.maxAge=r||0}t=s?function(t){return Symbol.for(t)}:function(t){return"_"+t},Object.defineProperty(a.prototype,"max",{set:function(t){(!t||"number"!=typeof t||t<=0)&&(t=1/0),h(this,"max",t),p(this)},get:function(){return h(this,"max")},enumerable:!0}),Object.defineProperty(a.prototype,"allowStale",{set:function(t){h(this,"allowStale",!!t)},get:function(){return h(this,"allowStale")},enumerable:!0}),Object.defineProperty(a.prototype,"maxAge",{set:function(t){(!t||"number"!=typeof t||t<0)&&(t=0),h(this,"maxAge",t),p(this)},get:function(){return h(this,"maxAge")},enumerable:!0}),Object.defineProperty(a.prototype,"lengthCalculator",{set:function(t){"function"!=typeof t&&(t=o),t!==h(this,"lengthCalculator")&&(h(this,"lengthCalculator",t),h(this,"length",0),h(this,"lruList").forEach(function(t){t.length=h(this,"lengthCalculator").call(this,t.value,t.key),h(this,"length",h(this,"length")+t.length)},this)),p(this)},get:function(){return h(this,"lengthCalculator")},enumerable:!0}),Object.defineProperty(a.prototype,"length",{get:function(){return h(this,"length")},enumerable:!0}),Object.defineProperty(a.prototype,"itemCount",{get:function(){return h(this,"lruList").length},enumerable:!0}),a.prototype.rforEach=function(t,e){e=e||this;for(var n=h(this,"lruList").tail;null!==n;){var i=n.prev;l(this,t,n,e),n=i}},a.prototype.forEach=function(t,e){e=e||this;for(var n=h(this,"lruList").head;null!==n;){var i=n.next;l(this,t,n,e),n=i}},a.prototype.keys=function(){return h(this,"lruList").toArray().map(function(t){return t.key},this)},a.prototype.values=function(){return h(this,"lruList").toArray().map(function(t){return t.value},this)},a.prototype.reset=function(){h(this,"dispose")&&h(this,"lruList")&&h(this,"lruList").length&&h(this,"lruList").forEach(function(t){h(this,"dispose").call(this,t.key,t.value)},this),h(this,"cache",new e),h(this,"lruList",new i),h(this,"length",0)},a.prototype.dump=function(){return h(this,"lruList").map(function(t){if(!c(this,t))return{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}},this).toArray().filter(function(t){return t})},a.prototype.dumpLru=function(){return h(this,"lruList")},a.prototype.inspect=function(t,e){var i="LRUCache {",r=!1;h(this,"allowStale")&&(i+="\n  allowStale: true",r=!0);var s=h(this,"max");s&&s!==1/0&&(r&&(i+=","),i+="\n  max: "+n.inspect(s,e),r=!0);var a=h(this,"maxAge");a&&(r&&(i+=","),i+="\n  maxAge: "+n.inspect(a,e),r=!0);var l=h(this,"lengthCalculator");l&&l!==o&&(r&&(i+=","),i+="\n  length: "+n.inspect(h(this,"length"),e),r=!0);var u=!1;return h(this,"lruList").forEach(function(t){u?i+=",\n  ":(r&&(i+=",\n"),u=!0,i+="\n  ");var s=n.inspect(t.key).split("\n").join("\n  "),h={value:t.value};t.maxAge!==a&&(h.maxAge=t.maxAge),l!==o&&(h.length=t.length),c(this,t)&&(h.stale=!0),h=n.inspect(h,e).split("\n").join("\n  "),i+=s+" => "+h}),(u||r)&&(i+="\n"),i+="}"},a.prototype.set=function(t,e,n){var i=(n=n||h(this,"maxAge"))?Date.now():0,r=h(this,"lengthCalculator").call(this,e,t);if(h(this,"cache").has(t)){if(r>h(this,"max"))return f(this,h(this,"cache").get(t)),!1;var s=h(this,"cache").get(t).value;return h(this,"dispose")&&h(this,"dispose").call(this,t,s.value),s.now=i,s.maxAge=n,s.value=e,h(this,"length",h(this,"length")+(r-s.length)),s.length=r,this.get(t),p(this),!0}var o=new g(t,e,r,i,n);return o.length>h(this,"max")?(h(this,"dispose")&&h(this,"dispose").call(this,t,e),!1):(h(this,"length",h(this,"length")+o.length),h(this,"lruList").unshift(o),h(this,"cache").set(t,h(this,"lruList").head),p(this),!0)},a.prototype.has=function(t){return!!h(this,"cache").has(t)&&!c(this,h(this,"cache").get(t).value)},a.prototype.get=function(t){return u(this,t,!0)},a.prototype.peek=function(t){return u(this,t,!1)},a.prototype.pop=function(){var t=h(this,"lruList").tail;return t?(f(this,t),t.value):null},a.prototype.del=function(t){f(this,h(this,"cache").get(t))},a.prototype.load=function(t){this.reset();for(var e=Date.now(),n=t.length-1;n>=0;n--){var i=t[n],r=i.e||0;if(0===r)this.set(i.k,i.v);else{var s=r-e;s>0&&this.set(i.k,i.v,s)}}},a.prototype.prune=function(){var t=this;h(this,"cache").forEach(function(e,n){u(t,n,!1)})};
},{"pseudomap":"e5nj","yallist":"sfWH"}],"UfRN":[function(require,module,exports) {
var t=200,r="__lodash_hash_undefined__",e=9007199254740991,n="[object Arguments]",o="[object Array]",u="[object Boolean]",c="[object Date]",a="[object Error]",i="[object Function]",f="[object GeneratorFunction]",s="[object Map]",l="[object Number]",p="[object Object]",_="[object Promise]",h="[object RegExp]",y="[object Set]",v="[object String]",b="[object Symbol]",d="[object WeakMap]",j="[object ArrayBuffer]",g="[object DataView]",w="[object Float32Array]",O="[object Float64Array]",m="[object Int8Array]",A="[object Int16Array]",x="[object Int32Array]",S="[object Uint8Array]",$="[object Uint8ClampedArray]",E="[object Uint16Array]",I="[object Uint32Array]",P=/[\\^$.*+?()[\]{}|]/g,F=/\w*$/,k=/^\[object .+?Constructor\]$/,B=/^(?:0|[1-9]\d*)$/,U={};U[n]=U[o]=U[j]=U[g]=U[u]=U[c]=U[w]=U[O]=U[m]=U[A]=U[x]=U[s]=U[l]=U[p]=U[h]=U[y]=U[v]=U[b]=U[S]=U[$]=U[E]=U[I]=!0,U[a]=U[i]=U[d]=!1;var M="object"==typeof global&&global&&global.Object===Object&&global,D="object"==typeof self&&self&&self.Object===Object&&self,R=M||D||Function("return this")(),T="object"==typeof exports&&exports&&!exports.nodeType&&exports,z=T&&"object"==typeof module&&module&&!module.nodeType&&module,C=z&&z.exports===T;function L(t,r){return t.set(r[0],r[1]),t}function V(t,r){return t.add(r),t}function W(t,r){for(var e=-1,n=t?t.length:0;++e<n&&!1!==r(t[e],e,t););return t}function G(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t}function N(t,r,e,n){var o=-1,u=t?t.length:0;for(n&&u&&(e=t[++o]);++o<u;)e=r(e,t[o],o,t);return e}function q(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}function H(t,r){return null==t?void 0:t[r]}function J(t){var r=!1;if(null!=t&&"function"!=typeof t.toString)try{r=!!(t+"")}catch(e){}return r}function K(t){var r=-1,e=Array(t.size);return t.forEach(function(t,n){e[++r]=[n,t]}),e}function Q(t,r){return function(e){return t(r(e))}}function X(t){var r=-1,e=Array(t.size);return t.forEach(function(t){e[++r]=t}),e}var Y=Array.prototype,Z=Function.prototype,tt=Object.prototype,rt=R["__core-js_shared__"],et=function(){var t=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),nt=Z.toString,ot=tt.hasOwnProperty,ut=tt.toString,ct=RegExp("^"+nt.call(ot).replace(P,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),at=C?R.Buffer:void 0,it=R.Symbol,ft=R.Uint8Array,st=Q(Object.getPrototypeOf,Object),lt=Object.create,pt=tt.propertyIsEnumerable,_t=Y.splice,ht=Object.getOwnPropertySymbols,yt=at?at.isBuffer:void 0,vt=Q(Object.keys,Object),bt=mr(R,"DataView"),dt=mr(R,"Map"),jt=mr(R,"Promise"),gt=mr(R,"Set"),wt=mr(R,"WeakMap"),Ot=mr(Object,"create"),mt=Br(bt),At=Br(dt),xt=Br(jt),St=Br(gt),$t=Br(wt),Et=it?it.prototype:void 0,It=Et?Et.valueOf:void 0;function Pt(t){var r=-1,e=t?t.length:0;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function Ft(){this.__data__=Ot?Ot(null):{}}function kt(t){return this.has(t)&&delete this.__data__[t]}function Bt(t){var e=this.__data__;if(Ot){var n=e[t];return n===r?void 0:n}return ot.call(e,t)?e[t]:void 0}function Ut(t){var r=this.__data__;return Ot?void 0!==r[t]:ot.call(r,t)}function Mt(t,e){return this.__data__[t]=Ot&&void 0===e?r:e,this}function Dt(t){var r=-1,e=t?t.length:0;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function Rt(){this.__data__=[]}function Tt(t){var r=this.__data__,e=er(r,t);return!(e<0)&&(e==r.length-1?r.pop():_t.call(r,e,1),!0)}function zt(t){var r=this.__data__,e=er(r,t);return e<0?void 0:r[e][1]}function Ct(t){return er(this.__data__,t)>-1}function Lt(t,r){var e=this.__data__,n=er(e,t);return n<0?e.push([t,r]):e[n][1]=r,this}function Vt(t){var r=-1,e=t?t.length:0;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function Wt(){this.__data__={hash:new Pt,map:new(dt||Dt),string:new Pt}}function Gt(t){return Or(this,t).delete(t)}function Nt(t){return Or(this,t).get(t)}function qt(t){return Or(this,t).has(t)}function Ht(t,r){return Or(this,t).set(t,r),this}function Jt(t){this.__data__=new Dt(t)}function Kt(){this.__data__=new Dt}function Qt(t){return this.__data__.delete(t)}function Xt(t){return this.__data__.get(t)}function Yt(t){return this.__data__.has(t)}function Zt(r,e){var n=this.__data__;if(n instanceof Dt){var o=n.__data__;if(!dt||o.length<t-1)return o.push([r,e]),this;n=this.__data__=new Vt(o)}return n.set(r,e),this}function tr(t,r){var e=Rr(t)||Dr(t)?q(t.length,String):[],n=e.length,o=!!n;for(var u in t)!r&&!ot.call(t,u)||o&&("length"==u||Ir(u,n))||e.push(u);return e}function rr(t,r,e){var n=t[r];ot.call(t,r)&&Mr(n,e)&&(void 0!==e||r in t)||(t[r]=e)}function er(t,r){for(var e=t.length;e--;)if(Mr(t[e][0],r))return e;return-1}function nr(t,r){return t&&jr(r,Nr(r),t)}function or(t,r,e,o,u,c,a){var s;if(o&&(s=c?o(t,u,c,a):o(t)),void 0!==s)return s;if(!Wr(t))return t;var l=Rr(t);if(l){if(s=Sr(t),!r)return dr(t,s)}else{var _=xr(t),h=_==i||_==f;if(Cr(t))return sr(t,r);if(_==p||_==n||h&&!c){if(J(t))return c?t:{};if(s=$r(h?{}:t),!r)return gr(t,nr(s,t))}else{if(!U[_])return c?t:{};s=Er(t,_,or,r)}}a||(a=new Jt);var y=a.get(t);if(y)return y;if(a.set(t,s),!l)var v=e?wr(t):Nr(t);return W(v||t,function(n,u){v&&(n=t[u=n]),rr(s,u,or(n,r,e,o,u,t,a))}),s}function ur(t){return Wr(t)?lt(t):{}}function cr(t,r,e){var n=r(t);return Rr(t)?n:G(n,e(t))}function ar(t){return ut.call(t)}function ir(t){return!(!Wr(t)||Fr(t))&&(Lr(t)||J(t)?ct:k).test(Br(t))}function fr(t){if(!kr(t))return vt(t);var r=[];for(var e in Object(t))ot.call(t,e)&&"constructor"!=e&&r.push(e);return r}function sr(t,r){if(r)return t.slice();var e=new t.constructor(t.length);return t.copy(e),e}function lr(t){var r=new t.constructor(t.byteLength);return new ft(r).set(new ft(t)),r}function pr(t,r){var e=r?lr(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function _r(t,r,e){return N(r?e(K(t),!0):K(t),L,new t.constructor)}function hr(t){var r=new t.constructor(t.source,F.exec(t));return r.lastIndex=t.lastIndex,r}function yr(t,r,e){return N(r?e(X(t),!0):X(t),V,new t.constructor)}function vr(t){return It?Object(It.call(t)):{}}function br(t,r){var e=r?lr(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function dr(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}function jr(t,r,e,n){e||(e={});for(var o=-1,u=r.length;++o<u;){var c=r[o],a=n?n(e[c],t[c],c,e,t):void 0;rr(e,c,void 0===a?t[c]:a)}return e}function gr(t,r){return jr(t,Ar(t),r)}function wr(t){return cr(t,Nr,Ar)}function Or(t,r){var e=t.__data__;return Pr(r)?e["string"==typeof r?"string":"hash"]:e.map}function mr(t,r){var e=H(t,r);return ir(e)?e:void 0}Pt.prototype.clear=Ft,Pt.prototype.delete=kt,Pt.prototype.get=Bt,Pt.prototype.has=Ut,Pt.prototype.set=Mt,Dt.prototype.clear=Rt,Dt.prototype.delete=Tt,Dt.prototype.get=zt,Dt.prototype.has=Ct,Dt.prototype.set=Lt,Vt.prototype.clear=Wt,Vt.prototype.delete=Gt,Vt.prototype.get=Nt,Vt.prototype.has=qt,Vt.prototype.set=Ht,Jt.prototype.clear=Kt,Jt.prototype.delete=Qt,Jt.prototype.get=Xt,Jt.prototype.has=Yt,Jt.prototype.set=Zt;var Ar=ht?Q(ht,Object):qr,xr=ar;function Sr(t){var r=t.length,e=t.constructor(r);return r&&"string"==typeof t[0]&&ot.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function $r(t){return"function"!=typeof t.constructor||kr(t)?{}:ur(st(t))}function Er(t,r,e,n){var o=t.constructor;switch(r){case j:return lr(t);case u:case c:return new o(+t);case g:return pr(t,n);case w:case O:case m:case A:case x:case S:case $:case E:case I:return br(t,n);case s:return _r(t,n,e);case l:case v:return new o(t);case h:return hr(t);case y:return yr(t,n,e);case b:return vr(t)}}function Ir(t,r){return!!(r=null==r?e:r)&&("number"==typeof t||B.test(t))&&t>-1&&t%1==0&&t<r}function Pr(t){var r=typeof t;return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t}function Fr(t){return!!et&&et in t}function kr(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||tt)}function Br(t){if(null!=t){try{return nt.call(t)}catch(r){}try{return t+""}catch(r){}}return""}function Ur(t){return or(t,!0,!0)}function Mr(t,r){return t===r||t!=t&&r!=r}function Dr(t){return zr(t)&&ot.call(t,"callee")&&(!pt.call(t,"callee")||ut.call(t)==n)}(bt&&xr(new bt(new ArrayBuffer(1)))!=g||dt&&xr(new dt)!=s||jt&&xr(jt.resolve())!=_||gt&&xr(new gt)!=y||wt&&xr(new wt)!=d)&&(xr=function(t){var r=ut.call(t),e=r==p?t.constructor:void 0,n=e?Br(e):void 0;if(n)switch(n){case mt:return g;case At:return s;case xt:return _;case St:return y;case $t:return d}return r});var Rr=Array.isArray;function Tr(t){return null!=t&&Vr(t.length)&&!Lr(t)}function zr(t){return Gr(t)&&Tr(t)}var Cr=yt||Hr;function Lr(t){var r=Wr(t)?ut.call(t):"";return r==i||r==f}function Vr(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e}function Wr(t){var r=typeof t;return!!t&&("object"==r||"function"==r)}function Gr(t){return!!t&&"object"==typeof t}function Nr(t){return Tr(t)?tr(t):fr(t)}function qr(){return[]}function Hr(){return!1}module.exports=Ur;
},{}],"kR6l":[function(require,module,exports) {
"use strict";function e(t){return t&&(Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){!t.hasOwnProperty(r)||null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||t[r].constructor===Buffer||Object.isFrozen(t[r])||e(t[r])})),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deepFreeze=e;
},{}],"r9ht":[function(require,module,exports) {
"use strict";var e=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),a=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(u){i={error:u}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a},r=this&&this.__spread||function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(e(arguments[t]));return r},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var n=t(require("lru-cache")),i=require("events"),o=t(require("lodash.clonedeep")),a=require("./freeze");function u(e){var t=new n.default(e),u=e.load,l=e.hash,s=e.bypass,f=e.itemMaxAge,c=e.freeze,d=e.clone,p=new i.EventEmitter,v=Object.assign({del:function(){var e=l.apply(void 0,r(arguments));t.del(e)},reset:function(){return t.reset()},keys:t.keys.bind(t),on:p.on.bind(p),once:p.once.bind(p)},e);if(e.disable)return Object.assign(u,v);function y(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.emit.apply(p,r([e],t))}function h(e){return e&&e.then&&"function"==typeof e.then}function b(e){var r=e;return d&&(r=h(r)?r.then(o.default):o.default(r)),c&&(h(r)?r=r.then(a.deepFreeze):a.deepFreeze(r)),r}return Object.assign(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(s&&s.apply(void 0,r(e)))return y.apply(void 0,r(["miss"],e)),u.apply(void 0,r(e));var i=l.apply(void 0,r(e)),o=t.get(i);if(o)return y.apply(void 0,r(["hit"],e)),b(o);y.apply(void 0,r(["miss"],e));var a=u.apply(void 0,r(e));return f?t.set(i,a,f.apply(void 0,r(e.concat([a])))):t.set(i,a),b(a)},v)}exports.syncMemoizer=u;
},{"lru-cache":"fOR4","lodash.clonedeep":"UfRN","./freeze":"kR6l"}],"BijV":[function(require,module,exports) {
"use strict";var e=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),a=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a},r=this&&this.__spread||function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(e(arguments[t]));return r},t=this&&this.__values||function(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i=n(require("lru-cache")),o=require("events"),a=n(require("lodash.clonedeep")),l=require("./freeze"),u=require("./sync");function s(e){var n=new i.default(e),u=e.load,s=e.hash,c=e.bypass,p=e.itemMaxAge,d=e.freeze,f=e.clone,v=e.queueMaxAge||1e3,y=new Map,h=new o.EventEmitter,m=Object.assign({del:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=s.apply(void 0,r(e));n.del(i)},reset:function(){return n.reset()},keys:n.keys.bind(n),on:h.on.bind(h),once:h.once.bind(h)},e);if(e.disable)return Object.assign(u,m);function g(e,n){var i,o;try{for(var l=t(e),u=l.next();!u.done;u=l.next()){var s=u.value;f?setImmediate.apply(void 0,r([s],n.map(a.default))):setImmediate.apply(void 0,r([s],n))}}catch(c){i={error:c}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}}function b(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.emit.apply(h,r([e],t))}return Object.assign(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,o=e.slice(0,-1),a=e.slice(-1).pop();if(c&&c.apply(void 0,r(o)))return b.apply(void 0,r(["miss"],o)),u.apply(void 0,r(e));i=0!==o.length||s?s.apply(void 0,r(o)):"_";var f=n.get(i);if(f)return b.apply(void 0,r(["hit"],o)),g([a],[null].concat(f));var h=y.get(i);if(h&&h.expiresAt>Date.now())return h.queue.push(a),void b.apply(void 0,r(["queue"],o));b.apply(void 0,r(["miss"],o));var m=Date.now(),_=[a];y.set(i,{queue:_,expiresAt:m+v}),u.apply(void 0,r(o,[function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e[0]||function(e,t,i){d&&i.forEach(l.deepFreeze),p?n.set(e,i,p.apply(void 0,r(t.concat(i)))):n.set(e,i)}(i,o,e.slice(1)),y.delete(i),b.apply(void 0,r(["loaded",Date.now()-m],o)),g(_,e)}]))},m)}exports.asyncMemoizer=s,s.sync=u.syncMemoizer;
},{"lru-cache":"fOR4","lodash.clonedeep":"UfRN","./freeze":"kR6l","./sync":"r9ht"}],"kZyD":[function(require,module,exports) {
"use strict";var e=require("./async");module.exports=e.asyncMemoizer;
},{"./async":"BijV"}],"tWZo":[function(require,module,exports) {
const e=require("debug")("jwks"),i=require("lru-memoizer"),{promisify:r,callbackify:a}=require("util");function n(n,{cacheMaxEntries:g=5,cacheMaxAge:u=6e5}){return e(`Configured caching of signing keys. Max: ${g} / Age: ${u}`),r(i({hash:e=>e,load:a(n.getSigningKey.bind(n)),maxAge:u,max:g}))}module.exports.default=n;
},{"debug":"NLT6","lru-memoizer":"kZyD"}],"itUN":[function(require,module,exports) {
var t=function(t,e,n,i){if(this.bucketSize=t,this.tokensPerInterval=e,"string"==typeof n)switch(n){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+n)}else this.interval=n;this.parentBucket=i,this.content=0,this.lastDrip=+new Date};t.prototype={bucketSize:1,tokensPerInterval:1,interval:1e3,parentBucket:null,content:0,lastDrip:0,removeTokens:function(t,e){var n=this;return this.bucketSize?t>this.bucketSize?(process.nextTick(e.bind(null,"Requested tokens "+t+" exceeds bucket size "+this.bucketSize,null)),!1):(this.drip(),t>this.content?i():this.parentBucket?this.parentBucket.removeTokens(t,function(s,r){return s?e(s,null):t>n.content?i():(n.content-=t,void e(null,Math.min(r,n.content)))}):(this.content-=t,process.nextTick(e.bind(null,null,this.content)),!0)):(process.nextTick(e.bind(null,null,t,Number.POSITIVE_INFINITY)),!0);function i(){var i=Math.ceil((t-n.content)*(n.interval/n.tokensPerInterval));return setTimeout(function(){n.removeTokens(t,e)},i),!1}},tryRemoveTokens:function(t){return!this.bucketSize||!(t>this.bucketSize)&&(this.drip(),!(t>this.content)&&(!(this.parentBucket&&!this.parentBucket.tryRemoveTokens(t))&&(this.content-=t,!0)))},drip:function(){if(this.tokensPerInterval){var t=+new Date,e=Math.max(t-this.lastDrip,0);this.lastDrip=t;var n=e*(this.tokensPerInterval/this.interval);this.content=Math.min(this.content+n,this.bucketSize)}else this.content=this.bucketSize}},module.exports=t;
},{}],"kQBt":[function(require,module,exports) {
var e=function(){if("undefined"!=typeof process&&process.hrtime){var e=process.hrtime(),r=e[0],t=e[1];return 1e3*r+Math.floor(t/1e6)}return(new Date).getTime()};module.exports=e;
},{}],"wKeT":[function(require,module,exports) {
var t=require("./tokenBucket"),e=require("./clock"),n=function(n,r,i){this.tokenBucket=new t(n,n,r,null),this.tokenBucket.content=n,this.curIntervalStart=e(),this.tokensThisInterval=0,this.fireImmediately=i};n.prototype={tokenBucket:null,curIntervalStart:0,tokensThisInterval:0,fireImmediately:!1,removeTokens:function(t,n){if(t>this.tokenBucket.bucketSize)return process.nextTick(n.bind(null,"Requested tokens "+t+" exceeds maximum tokens per interval "+this.tokenBucket.bucketSize,null)),!1;var r=this,i=e();if((i<this.curIntervalStart||i-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=i,this.tokensThisInterval=0),t>this.tokenBucket.tokensPerInterval-this.tokensThisInterval){if(this.fireImmediately)process.nextTick(n.bind(null,null,-1));else{var s=Math.ceil(this.curIntervalStart+this.tokenBucket.interval-i);setTimeout(function(){r.tokenBucket.removeTokens(t,k)},s)}return!1}return this.tokenBucket.removeTokens(t,k);function k(e,i){if(e)return n(e,null);r.tokensThisInterval+=t,n(null,i)}},tryRemoveTokens:function(t){if(t>this.tokenBucket.bucketSize)return!1;var n=e();if((n<this.curIntervalStart||n-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=n,this.tokensThisInterval=0),t>this.tokenBucket.tokensPerInterval-this.tokensThisInterval)return!1;var r=this.tokenBucket.tryRemoveTokens(t);return r&&(this.tokensThisInterval+=t),r},getTokensRemaining:function(){return this.tokenBucket.drip(),this.tokenBucket.content}},module.exports=n;
},{"./tokenBucket":"itUN","./clock":"kQBt"}],"JvP5":[function(require,module,exports) {
exports.RateLimiter=require("./lib/rateLimiter"),exports.TokenBucket=require("./lib/tokenBucket");
},{"./lib/rateLimiter":"wKeT","./lib/tokenBucket":"itUN"}],"tdmD":[function(require,module,exports) {
function r(r){Error.call(this,r),Error.captureStackTrace(this,this.constructor),this.name="JwksRateLimitError",this.message=r}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,module.exports=r;
},{}],"rnzR":[function(require,module,exports) {
const e=require("debug")("jwks"),{RateLimiter:t}=require("limiter"),n=require("../errors/JwksRateLimitError");function i(i,{jwksRequestsPerMinute:r=10}){const o=i.getSigningKey.bind(i),s=new t(r,"minute",!0);return e(`Configured rate limiting to JWKS endpoint at ${r}/minute`),async t=>await new Promise((i,r)=>{s.removeTokens(1,async(s,a)=>{if(s&&r(s),e("Requests to the JWKS endpoint available for the next minute:",a),a<0)e("Too many requests to the JWKS endpoint"),r(new n("Too many requests to the JWKS endpoint"));else try{const e=await o(t);i(e)}catch(u){r(u)}})})}module.exports.default=i;
},{"debug":"NLT6","limiter":"JvP5","../errors/JwksRateLimitError":"tdmD"}],"mv6Z":[function(require,module,exports) {
const e=require("../utils").retrieveSigningKeys;function t(t,{getKeysInterceptor:n}){const i=t.getSigningKey.bind(t);return async t=>{const r=await n();let s;if(r&&r.length&&(s=e(r)),s&&s.length){const e=s.find(e=>!t||e.kid===t);if(e)return e}return i(t)}}module.exports.default=t;
},{"../utils":"NY26"}],"p31L":[function(require,module,exports) {
const{callbackify:e}=require("util"),r=r=>{const t=r.getSigningKey.bind(r);return(r,n)=>{if(n){return e(t)(r,n)}return t(r)}};module.exports.default=r;
},{}],"KIdj":[function(require,module,exports) {
module.exports={request:require("./request").default,cacheSigningKey:require("./cache").default,rateLimitSigningKey:require("./rateLimit").default,getKeysInterceptor:require("./interceptor").default,callbackSupport:require("./callbackSupport").default};
},{"./request":"fYDI","./cache":"tWZo","./rateLimit":"rnzR","./interceptor":"mv6Z","./callbackSupport":"p31L"}],"E5fK":[function(require,module,exports) {
function r(r){Error.call(this,r),Error.captureStackTrace(this,this.constructor),this.name="JwksError",this.message=r}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,module.exports=r;
},{}],"Remr":[function(require,module,exports) {
function r(r){Error.call(this,r),Error.captureStackTrace(this,this.constructor),this.name="SigningKeyNotFoundError",this.message=r}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,module.exports=r;
},{}],"EDdC":[function(require,module,exports) {
function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function t(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?e(Object(r),!0).forEach(function(e){n(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const i=require("debug")("jwks"),{retrieveSigningKeys:r}=require("./utils"),{request:s,cacheSigningKey:o,rateLimitSigningKey:c,getKeysInterceptor:g,callbackSupport:a}=require("./wrappers"),h=require("./errors/JwksError"),y=require("./errors/SigningKeyNotFoundError");class u{constructor(e){this.options=t({rateLimit:!1,cache:!0,timeout:3e4},e),this.options.getKeysInterceptor&&(this.getSigningKey=g(this,e)),this.options.rateLimit&&(this.getSigningKey=c(this,e)),this.options.cache&&(this.getSigningKey=o(this,e)),this.getSigningKey=a(this,e)}async getKeys(){i(`Fetching keys from '${this.options.jwksUri}'`);try{const t=await s({uri:this.options.jwksUri,headers:this.options.requestHeaders,agent:this.options.requestAgent,timeout:this.options.timeout,fetcher:this.options.fetcher});return i("Keys:",t.keys),t.keys}catch(e){const{errorMsg:t}=e;throw i("Failure:",t||e),t?new h(t):e}}async getSigningKeys(){const e=await this.getKeys();if(!e||!e.length)throw new h("The JWKS endpoint did not contain any keys");const t=r(e);if(!t.length)throw new h("The JWKS endpoint did not contain any signing keys");return i("Signing Keys:",t),t}async getSigningKey(e){i(`Fetching signing key for '${e}'`);const t=await this.getSigningKeys(),n=null!=e;if(!n&&t.length>1)throw i("No KID specified and JWKS endpoint returned more than 1 key"),new y("No KID specified and JWKS endpoint returned more than 1 key");const r=t.find(t=>!n||t.kid===e);if(r)return r;throw i(`Unable to find a signing key that matches '${e}'`),new y(`Unable to find a signing key that matches '${e}'`)}}module.exports={JwksClient:u};
},{"debug":"NLT6","./utils":"NY26","./wrappers":"KIdj","./errors/JwksError":"E5fK","./errors/SigningKeyNotFoundError":"Remr"}],"tdvW":[function(require,module,exports) {
function r(r){Error.call(this,r),Error.captureStackTrace(this,this.constructor),this.name="ArgumentError",this.message=r}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,module.exports=r;
},{}],"PQwR":[function(require,module,exports) {
module.exports={ArgumentError:require("./ArgumentError"),JwksError:require("./JwksError"),JwksRateLimitError:require("./JwksRateLimitError"),SigningKeyNotFoundError:require("./SigningKeyNotFoundError")};
},{"./ArgumentError":"tdvW","./JwksError":"E5fK","./JwksRateLimitError":"tdmD","./SigningKeyNotFoundError":"Remr"}],"v741":[function(require,module,exports) {
const S=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES256K","ES384","ES512","EdDSA"];module.exports=S;
},{}],"nxuC":[function(require,module,exports) {
const{ArgumentError:e}=require("../errors"),{JwksClient:n}=require("../JwksClient"),r=require("./config"),i=(e,n)=>e&&"SigningKeyNotFoundError"===e.name?n(e,null,null):e?n(e,null,null):void 0;module.exports.hapiJwt2KeyAsync=(e=>{const n=module.exports.hapiJwt2Key(e);return function(e){return new Promise((r,i)=>{n(e,(e,n)=>{!n||e?i(e):r({key:n})})})}}),module.exports.hapiJwt2Key=function(l){if(null==l)throw new e("An options object must be provided when initializing hapiJwt2Key");const t=new n(l),o=l.handleSigningKeyError||i;return function(e,n){return e&&e.header?r.includes(e.header.alg)?void t.getSigningKey(e.header.kid).then(e=>n(null,e.publicKey||e.rsaPublicKey,e)).catch(e=>o(e,e=>n(e,null,null))):n(new Error("Unsupported algorithm "+e.header.alg+" supplied."),null,null):n(new Error("Cannot find a signing certificate if there is no header"),null,null)}};
},{"../errors":"PQwR","../JwksClient":"EDdC","./config":"v741"}],"Ri7v":[function(require,module,exports) {
const{ArgumentError:e}=require("../errors"),{JwksClient:n}=require("../JwksClient"),r=require("./config"),i=(e,n)=>e&&"SigningKeyNotFoundError"===e.name?n(null):e?n(e):void 0;module.exports.expressJwtSecret=function(t){if(null==t)throw new e("An options object must be provided when initializing expressJwtSecret");const l=new n(t),u=t.handleSigningKeyError||i;return function(e,n,i,t){if(!n||!r.includes(n.alg))return t(null,null);l.getSigningKey(n.kid).then(e=>{t(null,e.publicKey||e.rsaPublicKey)}).catch(e=>{u(e,e=>t(e,null))})}};
},{"../errors":"PQwR","../JwksClient":"EDdC","./config":"v741"}],"Hz6P":[function(require,module,exports) {
const{ArgumentError:e}=require("../errors"),{JwksClient:r}=require("../JwksClient"),n=require("./config");module.exports.koaJwtSecret=function(i={}){if(!i.jwksUri)throw new e("No JWKS provided. Please provide a jwksUri");const o=new r(i);return function({alg:e,kid:r}={}){return new Promise((t,s)=>{if(!n.includes(e))return s(new Error("Missing / invalid token algorithm"));o.getSigningKey(r).then(e=>{t(e.publicKey||e.rsaPublicKey)}).catch(e=>i.handleSigningKeyError?i.handleSigningKeyError(e).then(s):s(e))})}};
},{"../errors":"PQwR","../JwksClient":"EDdC","./config":"v741"}],"qw3O":[function(require,module,exports) {
const e=require("jose").JWT,{ArgumentError:r}=require("../errors"),{JwksClient:n}=require("../JwksClient"),i=require("./config"),t=(e,r)=>e&&"SigningKeyNotFoundError"===e.name?r(null):e?r(e):void 0;module.exports.passportJwtSecret=function(o){if(null==o)throw new r("An options object must be provided when initializing passportJwtSecret");if(!o.jwksUri)throw new r("No JWKS provided. Please provide a jwksUri");const l=new n(o),u=o.handleSigningKeyError||t;return function(r,n,t){let o;try{o=e.decode(n,{complete:!0})}catch(s){o=null}if(!o||!i.includes(o.header.alg))return t(null,null);l.getSigningKey(o.header.kid).then(e=>{t(null,e.publicKey||e.rsaPublicKey)}).catch(e=>{u(e,e=>t(e,null))})}};
},{"jose":"rnoB","../errors":"PQwR","../JwksClient":"EDdC","./config":"v741"}],"zjQk":[function(require,module,exports) {
const{JwksClient:e}=require("./JwksClient"),r=require("./errors"),{hapiJwt2Key:t,hapiJwt2KeyAsync:o}=require("./integrations/hapi"),{expressJwtSecret:s}=require("./integrations/express"),{koaJwtSecret:i}=require("./integrations/koa"),{passportJwtSecret:p}=require("./integrations/passport");module.exports=(r=>new e(r)),module.exports.JwksClient=e,module.exports.ArgumentError=r.ArgumentError,module.exports.JwksError=r.JwksError,module.exports.JwksRateLimitError=r.JwksRateLimitError,module.exports.SigningKeyNotFoundError=r.SigningKeyNotFoundError,module.exports.expressJwtSecret=s,module.exports.hapiJwt2Key=t,module.exports.hapiJwt2KeyAsync=o,module.exports.koaJwtSecret=i,module.exports.passportJwtSecret=p;
},{"./JwksClient":"EDdC","./errors":"PQwR","./integrations/hapi":"nxuC","./integrations/express":"Ri7v","./integrations/koa":"Hz6P","./integrations/passport":"qw3O"}],"AxoZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeToken=u,exports.handler=l;var e=require("util"),o=require("jsonwebtoken"),t=n(require("jwks-rsa"));function n(e){return e&&e.__esModule?e:{default:e}}const r=(0,t.default)({cache:!0,rateLimit:!0,jwksUri:process.env.JWKS_URI}),i=(0,e.promisify)(r.getSigningKey),c=(0,e.promisify)(o.verify);function s(e){let o;if(console.log("Get token"),o="REQUEST"==e.type?e.headers.Authorization:e.authorizationToken){const e="Bearer ";o.includes(e)&&(o=o.substring(e.length))}return console.log(`Auth token ${o}`),o}function u(e){console.log("Decode token");const t=(0,o.decode)(e,{complete:!0});if(!t||!t.header||!t.header.kid)throw new Error("Invalid token");return t}function a(e){return{Version:"2012-10-17",Statement:[{Action:"execute-api:Invoke",Effect:"Allow",Resource:e}]}}async function l(e){console.log(e);try{const t=s(e),n=u(t),r=(await i(n.header.kid)).getPublicKey(),{sub:l,scope:d}=await c(t,r,{audience:process.env.AUDIENCE,issuer:process.env.TOKEN_ISSUER});return{principalId:l,policyDocument:a(e.methodArn),context:{scope:d}}}catch(o){return console.log(o),`Unauthorized ${o}`}}
},{"jsonwebtoken":"JDSz","jwks-rsa":"zjQk"}]},{},["AxoZ"], null)